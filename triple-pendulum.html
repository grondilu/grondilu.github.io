<!DOCTYPE html>
<html lang=en>
  <head>
    <meta charset="utf-8">
    <title>An algebraic lagrangian for the triple pendulum</title>
    <script type="text/javascript" async
     src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML">
    </script>
  </head>

  <body>
    <!--
    <p><img src="https://i.imgflip.com/5yqsyy.jpg"/></p>
    -->
    <canvas id="triple-pendulum" width=400 height=400>
        Your browser can't display canvas.
    </canvas>

    <p>This solution does not rely on trigonometry.  Instead, the stereographic projection is used:
    $$ (x,y) = \left(\frac{1-q^2}{1+q^2},\frac{2q}{1+q^2}\right) $$
    </p>

    <p>The differential equations were obtained with Mathematica.  They are considerably large.</p>

    <script>
'use strict;'

function rk4(dt, x, D) {
  let indices = [...x.keys()],
    map = f => indices.map(f),
    dtx = $ => map( i => $[i]*dt ),
    a = dtx(D(...x)),
    b = dtx(D(...map(i => x[i] + a[i]/2))),
    c = dtx(D(...map(i => x[i] + b[i]/2))),
    d = dtx(D(...map(i => x[i] + c[i])));
  return map(i => (a[i] + 2*b[i] + 2*c[i] + d[i])/6);
}

function List(...x) { return [...x] }
function Power(x,y) { return x**y }

function M(a1,b1,a2,b2,a3,b3) {
  return (q1,q2,q3) => List(List((-2*b1*q1)/(1 + Power(q1,2)) + (a1*(1 - Power(q1,2)))/(1 + Power(q1,2)),(2*a1*q1)/(1 + Power(q1,2)) + (b1*(1 - Power(q1,2)))/(1 + Power(q1,2))),List((-2*b1*q1)/(1 + Power(q1,2)) + (a1*(1 - Power(q1,2)))/(1 + Power(q1,2)) - (2*b2*q2)/(1 + Power(q2,2)) + (a2*(1 - Power(q2,2)))/(1 + Power(q2,2)),(2*a1*q1)/(1 + Power(q1,2)) + (b1*(1 - Power(q1,2)))/(1 + Power(q1,2)) + (2*a2*q2)/(1 + Power(q2,2)) + (b2*(1 - Power(q2,2)))/(1 + Power(q2,2))),List((-2*b1*q1)/(1 + Power(q1,2)) + (a1*(1 - Power(q1,2)))/(1 + Power(q1,2)) - (2*b2*q2)/(1 + Power(q2,2)) + (a2*(1 - Power(q2,2)))/(1 + Power(q2,2)) - (2*b3*q3)/(1 + Power(q3,2)) + (a3*(1 - Power(q3,2)))/(1 + Power(q3,2)),(2*a1*q1)/(1 + Power(q1,2)) + (b1*(1 - Power(q1,2)))/(1 + Power(q1,2)) + (2*a2*q2)/(1 + Power(q2,2)) + (b2*(1 - Power(q2,2)))/(1 + Power(q2,2)) + (2*a3*q3)/(1 + Power(q3,2)) + (b3*(1 - Power(q3,2)))/(1 + Power(q3,2))));
}
function V(a1,b1,a2,b2,a3,b3) {
  return (q1,q2,q3,qdot1,qdot2,qdot3) => List(List(b1*((4*Power(q1,2))/Power(1 + Power(q1,2),2) - 2/(1 + Power(q1,2)))*qdot1 + a1*((-2*q1*(1 - Power(q1,2)))/Power(1 + Power(q1,2),2) - (2*q1)/(1 + Power(q1,2)))*qdot1,a1*((-4*Power(q1,2))/Power(1 + Power(q1,2),2) + 2/(1 + Power(q1,2)))*qdot1 + b1*((-2*q1*(1 - Power(q1,2)))/Power(1 + Power(q1,2),2) - (2*q1)/(1 + Power(q1,2)))*qdot1),List(b1*((4*Power(q1,2))/Power(1 + Power(q1,2),2) - 2/(1 + Power(q1,2)))*qdot1 + a1*((-2*q1*(1 - Power(q1,2)))/Power(1 + Power(q1,2),2) - (2*q1)/(1 + Power(q1,2)))*qdot1 + b2*((4*Power(q2,2))/Power(1 + Power(q2,2),2) - 2/(1 + Power(q2,2)))*qdot2 + a2*((-2*q2*(1 - Power(q2,2)))/Power(1 + Power(q2,2),2) - (2*q2)/(1 + Power(q2,2)))*qdot2,a1*((-4*Power(q1,2))/Power(1 + Power(q1,2),2) + 2/(1 + Power(q1,2)))*qdot1 + b1*((-2*q1*(1 - Power(q1,2)))/Power(1 + Power(q1,2),2) - (2*q1)/(1 + Power(q1,2)))*qdot1 + a2*((-4*Power(q2,2))/Power(1 + Power(q2,2),2) + 2/(1 + Power(q2,2)))*qdot2 + b2*((-2*q2*(1 - Power(q2,2)))/Power(1 + Power(q2,2),2) - (2*q2)/(1 + Power(q2,2)))*qdot2),List(b1*((4*Power(q1,2))/Power(1 + Power(q1,2),2) - 2/(1 + Power(q1,2)))*qdot1 + a1*((-2*q1*(1 - Power(q1,2)))/Power(1 + Power(q1,2),2) - (2*q1)/(1 + Power(q1,2)))*qdot1 + b2*((4*Power(q2,2))/Power(1 + Power(q2,2),2) - 2/(1 + Power(q2,2)))*qdot2 + a2*((-2*q2*(1 - Power(q2,2)))/Power(1 + Power(q2,2),2) - (2*q2)/(1 + Power(q2,2)))*qdot2 + b3*((4*Power(q3,2))/Power(1 + Power(q3,2),2) - 2/(1 + Power(q3,2)))*qdot3 + a3*((-2*q3*(1 - Power(q3,2)))/Power(1 + Power(q3,2),2) - (2*q3)/(1 + Power(q3,2)))*qdot3,a1*((-4*Power(q1,2))/Power(1 + Power(q1,2),2) + 2/(1 + Power(q1,2)))*qdot1 + b1*((-2*q1*(1 - Power(q1,2)))/Power(1 + Power(q1,2),2) - (2*q1)/(1 + Power(q1,2)))*qdot1 + a2*((-4*Power(q2,2))/Power(1 + Power(q2,2),2) + 2/(1 + Power(q2,2)))*qdot2 + b2*((-2*q2*(1 - Power(q2,2)))/Power(1 + Power(q2,2),2) - (2*q2)/(1 + Power(q2,2)))*qdot2 + a3*((-4*Power(q3,2))/Power(1 + Power(q3,2),2) + 2/(1 + Power(q3,2)))*qdot3 + b3*((-2*q3*(1 - Power(q3,2)))/Power(1 + Power(q3,2),2) - (2*q3)/(1 + Power(q3,2)))*qdot3))
}
function ddot(a1,b1,a2,b2,a3,b3) {
  return (q1,q2,q3,qdot1,qdot2,qdot3) => List(qdot1,qdot2,qdot3,-((-(((-2*(1 + Power(q2,2)) - 6*Power(q1,2)*(1 + Power(q2,2)) - 6*Power(q1,4)*(1 + Power(q2,2)) - 2*Power(q1,6)*(1 + Power(q2,2)) - 6*(1 + Power(q2,2))*Power(q3,2) - 18*Power(q1,2)*(1 + Power(q2,2))*Power(q3,2) - 18*Power(q1,4)*(1 + Power(q2,2))*Power(q3,2) - 6*Power(q1,6)*(1 + Power(q2,2))*Power(q3,2) - 6*(1 + Power(q2,2))*Power(q3,4) - 18*Power(q1,2)*(1 + Power(q2,2))*Power(q3,4) - 18*Power(q1,4)*(1 + Power(q2,2))*Power(q3,4) - 6*Power(q1,6)*(1 + Power(q2,2))*Power(q3,4) - 2*(1 + Power(q2,2))*Power(q3,6) - 6*Power(q1,2)*(1 + Power(q2,2))*Power(q3,6) - 6*Power(q1,4)*(1 + Power(q2,2))*Power(q3,6) - 2*Power(q1,6)*(1 + Power(q2,2))*Power(q3,6))*(-2*(1 + Power(q3,2)) - 6*Power(q1,2)*(1 + Power(q3,2)) - 6*Power(q1,4)*(1 + Power(q3,2)) - 2*Power(q1,6)*(1 + Power(q3,2)) - 6*Power(q2,2)*(1 + Power(q3,2)) - 18*Power(q1,2)*Power(q2,2)*(1 + Power(q3,2)) - 18*Power(q1,4)*Power(q2,2)*(1 + Power(q3,2)) - 6*Power(q1,6)*Power(q2,2)*(1 + Power(q3,2)) - 6*Power(q2,4)*(1 + Power(q3,2)) - 18*Power(q1,2)*Power(q2,4)*(1 + Power(q3,2)) - 18*Power(q1,4)*Power(q2,4)*(1 + Power(q3,2)) - 6*Power(q1,6)*Power(q2,4)*(1 + Power(q3,2)) - 2*Power(q2,6)*(1 + Power(q3,2)) - 6*Power(q1,2)*Power(q2,6)*(1 + Power(q3,2)) - 6*Power(q1,4)*Power(q2,6)*(1 + Power(q3,2)) - 2*Power(q1,6)*Power(q2,6)*(1 + Power(q3,2))) - (-2*a2*a3*Power(1 + Power(q1,2),3)*(1 + Power(q3,2)) - 2*b2*b3*Power(1 + Power(q1,2),3)*(1 + Power(q3,2)) - 8*a2*a3*Power(1 + Power(q1,2),3)*q2*q3*(1 + Power(q3,2)) - 8*b2*b3*Power(1 + Power(q1,2),3)*q2*q3*(1 + Power(q3,2)) - 8*a2*a3*Power(1 + Power(q1,2),3)*Power(q2,3)*q3*(1 + Power(q3,2)) - 8*b2*b3*Power(1 + Power(q1,2),3)*Power(q2,3)*q3*(1 + Power(q3,2)) + 2*a2*a3*Power(1 + Power(q1,2),3)*Power(q3,2)*(1 + Power(q3,2)) + 2*b2*b3*Power(1 + Power(q1,2),3)*Power(q3,2)*(1 + Power(q3,2)) - 2*a2*a3*Power(1 + Power(q1,2),3)*Power(q2,4)*(-1 + Power(q3,2))*(1 + Power(q3,2)) - 2*b2*b3*Power(1 + Power(q1,2),3)*Power(q2,4)*(-1 + Power(q3,2))*(1 + Power(q3,2)) + 4*a3*b2*Power(1 + Power(q1,2),3)*(1 + Power(q2,2))*(1 + Power(q3,2))*(-q3 + Power(q2,2)*q3 - q2*(-1 + Power(q3,2))) - 4*a2*b3*Power(1 + Power(q1,2),3)*(1 + Power(q2,2))*(1 + Power(q3,2))*(-q3 + Power(q2,2)*q3 - q2*(-1 + Power(q3,2))))*(-(a2*a3*Power(1 + Power(q1,2),3)*(1 + Power(q2,2))) - b2*b3*Power(1 + Power(q1,2),3)*(1 + Power(q2,2)) + a2*a3*Power(1 + Power(q1,2),3)*Power(q2,2)*(1 + Power(q2,2)) + b2*b3*Power(1 + Power(q1,2),3)*Power(q2,2)*(1 + Power(q2,2)) + a2*a3*Power(1 + Power(q1,2),3)*(1 + Power(q2,2))*Power(q3,4) + b2*b3*Power(1 + Power(q1,2),3)*(1 + Power(q2,2))*Power(q3,4) - a2*a3*Power(1 + Power(q1,2),3)*Power(q2,2)*(1 + Power(q2,2))*Power(q3,4) - b2*b3*Power(1 + Power(q1,2),3)*Power(q2,2)*(1 + Power(q2,2))*Power(q3,4) - 4*a2*a3*Power(1 + Power(q1,2),3)*q2*(1 + Power(q2,2))*q3*(1 + Power(q3,2)) - 4*b2*b3*Power(1 + Power(q1,2),3)*q2*(1 + Power(q2,2))*q3*(1 + Power(q3,2)) - 2*a3*b2*Power(1 + Power(q1,2),3)*(1 + Power(q2,2))*(1 + Power(q3,2))*(q3 - Power(q2,2)*q3 + q2*(-1 + Power(q3,2))) + 2*a2*b3*Power(1 + Power(q1,2),3)*(1 + Power(q2,2))*(1 + Power(q3,2))*(q3 - Power(q2,2)*q3 + q2*(-1 + Power(q3,2)))))*(-((-2*a1*a3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3) - 2*b1*b3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3) + 2*a1*a3*Power(q1,2)*(1 + Power(q1,2))*Power(1 + Power(q2,2),3) + 2*b1*b3*Power(q1,2)*(1 + Power(q1,2))*Power(1 + Power(q2,2),3) + 2*a1*a3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*Power(q3,4) + 2*b1*b3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*Power(q3,4) - 2*a1*a3*Power(q1,2)*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*Power(q3,4) - 2*b1*b3*Power(q1,2)*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*Power(q3,4) - 8*a1*a3*q1*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*q3*(1 + Power(q3,2)) - 8*b1*b3*q1*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*q3*(1 + Power(q3,2)) - 4*a3*b1*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*(1 + Power(q3,2))*(q3 - Power(q1,2)*q3 + q1*(-1 + Power(q3,2))) + 4*a1*b3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*(1 + Power(q3,2))*(q3 - Power(q1,2)*q3 + q1*(-1 + Power(q3,2))))*(2*b3*Power(1 + Power(q1,2),3)*Power(1 + Power(q2,2),3)*q3*(1 + Power(q3,2)) + a3*Power(1 + Power(q1,2),3)*Power(1 + Power(q2,2),3)*(-1 + Power(q3,4)) - 8*a1*a3*Power(1 + Power(q2,2),3)*q3*(1 + Power(q3,2))*Power(qdot1,2) - 8*b1*b3*Power(1 + Power(q2,2),3)*q3*(1 + Power(q3,2))*Power(qdot1,2) + 24*a1*a3*Power(q1,2)*Power(1 + Power(q2,2),3)*q3*(1 + Power(q3,2))*Power(qdot1,2) + 24*b1*b3*Power(q1,2)*Power(1 + Power(q2,2),3)*q3*(1 + Power(q3,2))*Power(qdot1,2) - 12*a1*a3*q1*Power(1 + Power(q2,2),3)*(-1 + Power(q3,2))*(1 + Power(q3,2))*Power(qdot1,2) - 12*b1*b3*q1*Power(1 + Power(q2,2),3)*(-1 + Power(q3,2))*(1 + Power(q3,2))*Power(qdot1,2) + 4*a1*a3*Power(q1,3)*Power(1 + Power(q2,2),3)*(-1 + Power(q3,2))*(1 + Power(q3,2))*Power(qdot1,2) + 4*b1*b3*Power(q1,3)*Power(1 + Power(q2,2),3)*(-1 + Power(q3,2))*(1 + Power(q3,2))*Power(qdot1,2) - 4*a3*b1*Power(1 + Power(q2,2),3)*(1 + Power(q3,2))*(-1 - 6*q1*q3 + 2*Power(q1,3)*q3 + Power(q3,2) - 3*Power(q1,2)*(-1 + Power(q3,2)))*Power(qdot1,2) + 4*a1*b3*Power(1 + Power(q2,2),3)*(1 + Power(q3,2))*(-1 - 6*q1*q3 + 2*Power(q1,3)*q3 + Power(q3,2) - 3*Power(q1,2)*(-1 + Power(q3,2)))*Power(qdot1,2) - 8*a2*a3*Power(1 + Power(q1,2),3)*q3*(1 + Power(q3,2))*Power(qdot2,2) - 8*b2*b3*Power(1 + Power(q1,2),3)*q3*(1 + Power(q3,2))*Power(qdot2,2) + 24*a2*a3*Power(1 + Power(q1,2),3)*Power(q2,2)*q3*(1 + Power(q3,2))*Power(qdot2,2) + 24*b2*b3*Power(1 + Power(q1,2),3)*Power(q2,2)*q3*(1 + Power(q3,2))*Power(qdot2,2) - 12*a2*a3*Power(1 + Power(q1,2),3)*q2*(-1 + Power(q3,2))*(1 + Power(q3,2))*Power(qdot2,2) - 12*b2*b3*Power(1 + Power(q1,2),3)*q2*(-1 + Power(q3,2))*(1 + Power(q3,2))*Power(qdot2,2) + 4*a2*a3*Power(1 + Power(q1,2),3)*Power(q2,3)*(-1 + Power(q3,2))*(1 + Power(q3,2))*Power(qdot2,2) + 4*b2*b3*Power(1 + Power(q1,2),3)*Power(q2,3)*(-1 + Power(q3,2))*(1 + Power(q3,2))*Power(qdot2,2) - 4*a3*b2*Power(1 + Power(q1,2),3)*(1 + Power(q3,2))*(-1 - 6*q2*q3 + 2*Power(q2,3)*q3 + Power(q3,2) - 3*Power(q2,2)*(-1 + Power(q3,2)))*Power(qdot2,2) + 4*a2*b3*Power(1 + Power(q1,2),3)*(1 + Power(q3,2))*(-1 - 6*q2*q3 + 2*Power(q2,3)*q3 + Power(q3,2) - 3*Power(q2,2)*(-1 + Power(q3,2)))*Power(qdot2,2) + 4*q3*Power(qdot3,2) + 12*Power(q1,2)*q3*Power(qdot3,2) + 12*Power(q1,4)*q3*Power(qdot3,2) + 4*Power(q1,6)*q3*Power(qdot3,2) + 12*Power(q2,2)*q3*Power(qdot3,2) + 36*Power(q1,2)*Power(q2,2)*q3*Power(qdot3,2) + 36*Power(q1,4)*Power(q2,2)*q3*Power(qdot3,2) + 12*Power(q1,6)*Power(q2,2)*q3*Power(qdot3,2) + 12*Power(q2,4)*q3*Power(qdot3,2) + 36*Power(q1,2)*Power(q2,4)*q3*Power(qdot3,2) + 36*Power(q1,4)*Power(q2,4)*q3*Power(qdot3,2) + 12*Power(q1,6)*Power(q2,4)*q3*Power(qdot3,2) + 4*Power(q2,6)*q3*Power(qdot3,2) + 12*Power(q1,2)*Power(q2,6)*q3*Power(qdot3,2) + 12*Power(q1,4)*Power(q2,6)*q3*Power(qdot3,2) + 4*Power(q1,6)*Power(q2,6)*q3*Power(qdot3,2))) + (-2*(1 + Power(q3,2)) - 6*Power(q1,2)*(1 + Power(q3,2)) - 6*Power(q1,4)*(1 + Power(q3,2)) - 2*Power(q1,6)*(1 + Power(q3,2)) - 6*Power(q2,2)*(1 + Power(q3,2)) - 18*Power(q1,2)*Power(q2,2)*(1 + Power(q3,2)) - 18*Power(q1,4)*Power(q2,2)*(1 + Power(q3,2)) - 6*Power(q1,6)*Power(q2,2)*(1 + Power(q3,2)) - 6*Power(q2,4)*(1 + Power(q3,2)) - 18*Power(q1,2)*Power(q2,4)*(1 + Power(q3,2)) - 18*Power(q1,4)*Power(q2,4)*(1 + Power(q3,2)) - 6*Power(q1,6)*Power(q2,4)*(1 + Power(q3,2)) - 2*Power(q2,6)*(1 + Power(q3,2)) - 6*Power(q1,2)*Power(q2,6)*(1 + Power(q3,2)) - 6*Power(q1,4)*Power(q2,6)*(1 + Power(q3,2)) - 2*Power(q1,6)*Power(q2,6)*(1 + Power(q3,2)))*(6*b1*q1*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*Power(1 + Power(q3,2),3) + 3*a1*(-1 + Power(q1,4))*Power(1 + Power(q2,2),3)*Power(1 + Power(q3,2),3) + 12*q1*Power(qdot1,2) + 36*q1*Power(q2,2)*Power(qdot1,2) + 36*q1*Power(q2,4)*Power(qdot1,2) + 12*q1*Power(q2,6)*Power(qdot1,2) + 36*q1*Power(q3,2)*Power(qdot1,2) + 108*q1*Power(q2,2)*Power(q3,2)*Power(qdot1,2) + 108*q1*Power(q2,4)*Power(q3,2)*Power(qdot1,2) + 36*q1*Power(q2,6)*Power(q3,2)*Power(qdot1,2) + 36*q1*Power(q3,4)*Power(qdot1,2) + 108*q1*Power(q2,2)*Power(q3,4)*Power(qdot1,2) + 108*q1*Power(q2,4)*Power(q3,4)*Power(qdot1,2) + 36*q1*Power(q2,6)*Power(q3,4)*Power(qdot1,2) + 12*q1*Power(q3,6)*Power(qdot1,2) + 36*q1*Power(q2,2)*Power(q3,6)*Power(qdot1,2) + 36*q1*Power(q2,4)*Power(q3,6)*Power(qdot1,2) + 12*q1*Power(q2,6)*Power(q3,6)*Power(qdot1,2) + 24*a1*a2*(1 + Power(q1,2))*q2*Power(1 + Power(q3,2),3)*Power(qdot2,2) + 24*b1*b2*(1 + Power(q1,2))*q2*Power(1 + Power(q3,2),3)*Power(qdot2,2) - 24*a1*a2*Power(q1,2)*(1 + Power(q1,2))*q2*Power(1 + Power(q3,2),3)*Power(qdot2,2) - 24*b1*b2*Power(q1,2)*(1 + Power(q1,2))*q2*Power(1 + Power(q3,2),3)*Power(qdot2,2) - 8*a1*a2*(1 + Power(q1,2))*Power(q2,3)*Power(1 + Power(q3,2),3)*Power(qdot2,2) - 8*b1*b2*(1 + Power(q1,2))*Power(q2,3)*Power(1 + Power(q3,2),3)*Power(qdot2,2) + 8*a1*a2*Power(q1,2)*(1 + Power(q1,2))*Power(q2,3)*Power(1 + Power(q3,2),3)*Power(qdot2,2) + 8*b1*b2*Power(q1,2)*(1 + Power(q1,2))*Power(q2,3)*Power(1 + Power(q3,2),3)*Power(qdot2,2) + 16*a1*a2*q1*(1 + Power(q1,2))*(-1 + 3*Power(q2,2))*Power(1 + Power(q3,2),3)*Power(qdot2,2) + 16*b1*b2*q1*(1 + Power(q1,2))*(-1 + 3*Power(q2,2))*Power(1 + Power(q3,2),3)*Power(qdot2,2) - 8*a2*b1*(1 + Power(q1,2))*(1 - 3*Power(q2,2) - 2*q1*q2*(-3 + Power(q2,2)) + Power(q1,2)*(-1 + 3*Power(q2,2)))*Power(1 + Power(q3,2),3)*Power(qdot2,2) + 8*a1*b2*(1 + Power(q1,2))*(1 - 3*Power(q2,2) - 2*q1*q2*(-3 + Power(q2,2)) + Power(q1,2)*(-1 + 3*Power(q2,2)))*Power(1 + Power(q3,2),3)*Power(qdot2,2) + 12*a1*a3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*q3*Power(qdot3,2) + 12*b1*b3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*q3*Power(qdot3,2) - 12*a1*a3*Power(q1,2)*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*q3*Power(qdot3,2) - 12*b1*b3*Power(q1,2)*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*q3*Power(qdot3,2) - 4*a1*a3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*Power(q3,3)*Power(qdot3,2) - 4*b1*b3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*Power(q3,3)*Power(qdot3,2) + 4*a1*a3*Power(q1,2)*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*Power(q3,3)*Power(qdot3,2) + 4*b1*b3*Power(q1,2)*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*Power(q3,3)*Power(qdot3,2) + 8*a1*a3*q1*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*(-1 + 3*Power(q3,2))*Power(qdot3,2) + 8*b1*b3*q1*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*(-1 + 3*Power(q3,2))*Power(qdot3,2) - 4*a3*b1*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*(1 - 3*Power(q3,2) - 2*q1*q3*(-3 + Power(q3,2)) + Power(q1,2)*(-1 + 3*Power(q3,2)))*Power(qdot3,2) + 4*a1*b3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*(1 - 3*Power(q3,2) - 2*q1*q3*(-3 + Power(q3,2)) + Power(q1,2)*(-1 + 3*Power(q3,2)))*Power(qdot3,2)))) + ((-2*(1 + Power(q3,2)) - 6*Power(q1,2)*(1 + Power(q3,2)) - 6*Power(q1,4)*(1 + Power(q3,2)) - 2*Power(q1,6)*(1 + Power(q3,2)) - 6*Power(q2,2)*(1 + Power(q3,2)) - 18*Power(q1,2)*Power(q2,2)*(1 + Power(q3,2)) - 18*Power(q1,4)*Power(q2,2)*(1 + Power(q3,2)) - 6*Power(q1,6)*Power(q2,2)*(1 + Power(q3,2)) - 6*Power(q2,4)*(1 + Power(q3,2)) - 18*Power(q1,2)*Power(q2,4)*(1 + Power(q3,2)) - 18*Power(q1,4)*Power(q2,4)*(1 + Power(q3,2)) - 6*Power(q1,6)*Power(q2,4)*(1 + Power(q3,2)) - 2*Power(q2,6)*(1 + Power(q3,2)) - 6*Power(q1,2)*Power(q2,6)*(1 + Power(q3,2)) - 6*Power(q1,4)*Power(q2,6)*(1 + Power(q3,2)) - 2*Power(q1,6)*Power(q2,6)*(1 + Power(q3,2)))*(-4*a1*a2*(1 + Power(q1,2))*Power(1 + Power(q3,2),3) - 4*b1*b2*(1 + Power(q1,2))*Power(1 + Power(q3,2),3) + 4*a1*a2*Power(q1,2)*(1 + Power(q1,2))*Power(1 + Power(q3,2),3) + 4*b1*b2*Power(q1,2)*(1 + Power(q1,2))*Power(1 + Power(q3,2),3) + 4*a1*a2*(1 + Power(q1,2))*Power(q2,4)*Power(1 + Power(q3,2),3) + 4*b1*b2*(1 + Power(q1,2))*Power(q2,4)*Power(1 + Power(q3,2),3) - 4*a1*a2*Power(q1,2)*(1 + Power(q1,2))*Power(q2,4)*Power(1 + Power(q3,2),3) - 4*b1*b2*Power(q1,2)*(1 + Power(q1,2))*Power(q2,4)*Power(1 + Power(q3,2),3) - 16*a1*a2*q1*(1 + Power(q1,2))*q2*(1 + Power(q2,2))*Power(1 + Power(q3,2),3) - 16*b1*b2*q1*(1 + Power(q1,2))*q2*(1 + Power(q2,2))*Power(1 + Power(q3,2),3) - 8*a2*b1*(1 + Power(q1,2))*(1 + Power(q2,2))*(q2 - Power(q1,2)*q2 + q1*(-1 + Power(q2,2)))*Power(1 + Power(q3,2),3) + 8*a1*b2*(1 + Power(q1,2))*(1 + Power(q2,2))*(q2 - Power(q1,2)*q2 + q1*(-1 + Power(q2,2)))*Power(1 + Power(q3,2),3)) - (-2*a1*a3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3) - 2*b1*b3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3) + 2*a1*a3*Power(q1,2)*(1 + Power(q1,2))*Power(1 + Power(q2,2),3) + 2*b1*b3*Power(q1,2)*(1 + Power(q1,2))*Power(1 + Power(q2,2),3) + 2*a1*a3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*Power(q3,4) + 2*b1*b3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*Power(q3,4) - 2*a1*a3*Power(q1,2)*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*Power(q3,4) - 2*b1*b3*Power(q1,2)*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*Power(q3,4) - 8*a1*a3*q1*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*q3*(1 + Power(q3,2)) - 8*b1*b3*q1*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*q3*(1 + Power(q3,2)) - 4*a3*b1*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*(1 + Power(q3,2))*(q3 - Power(q1,2)*q3 + q1*(-1 + Power(q3,2))) + 4*a1*b3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*(1 + Power(q3,2))*(q3 - Power(q1,2)*q3 + q1*(-1 + Power(q3,2))))*(-2*a2*a3*Power(1 + Power(q1,2),3)*(1 + Power(q3,2)) - 2*b2*b3*Power(1 + Power(q1,2),3)*(1 + Power(q3,2)) - 8*a2*a3*Power(1 + Power(q1,2),3)*q2*q3*(1 + Power(q3,2)) - 8*b2*b3*Power(1 + Power(q1,2),3)*q2*q3*(1 + Power(q3,2)) - 8*a2*a3*Power(1 + Power(q1,2),3)*Power(q2,3)*q3*(1 + Power(q3,2)) - 8*b2*b3*Power(1 + Power(q1,2),3)*Power(q2,3)*q3*(1 + Power(q3,2)) + 2*a2*a3*Power(1 + Power(q1,2),3)*Power(q3,2)*(1 + Power(q3,2)) + 2*b2*b3*Power(1 + Power(q1,2),3)*Power(q3,2)*(1 + Power(q3,2)) - 2*a2*a3*Power(1 + Power(q1,2),3)*Power(q2,4)*(-1 + Power(q3,2))*(1 + Power(q3,2)) - 2*b2*b3*Power(1 + Power(q1,2),3)*Power(q2,4)*(-1 + Power(q3,2))*(1 + Power(q3,2)) + 4*a3*b2*Power(1 + Power(q1,2),3)*(1 + Power(q2,2))*(1 + Power(q3,2))*(-q3 + Power(q2,2)*q3 - q2*(-1 + Power(q3,2))) - 4*a2*b3*Power(1 + Power(q1,2),3)*(1 + Power(q2,2))*(1 + Power(q3,2))*(-q3 + Power(q2,2)*q3 - q2*(-1 + Power(q3,2)))))*(-((-(a2*a3*Power(1 + Power(q1,2),3)*(1 + Power(q2,2))) - b2*b3*Power(1 + Power(q1,2),3)*(1 + Power(q2,2)) + a2*a3*Power(1 + Power(q1,2),3)*Power(q2,2)*(1 + Power(q2,2)) + b2*b3*Power(1 + Power(q1,2),3)*Power(q2,2)*(1 + Power(q2,2)) + a2*a3*Power(1 + Power(q1,2),3)*(1 + Power(q2,2))*Power(q3,4) + b2*b3*Power(1 + Power(q1,2),3)*(1 + Power(q2,2))*Power(q3,4) - a2*a3*Power(1 + Power(q1,2),3)*Power(q2,2)*(1 + Power(q2,2))*Power(q3,4) - b2*b3*Power(1 + Power(q1,2),3)*Power(q2,2)*(1 + Power(q2,2))*Power(q3,4) - 4*a2*a3*Power(1 + Power(q1,2),3)*q2*(1 + Power(q2,2))*q3*(1 + Power(q3,2)) - 4*b2*b3*Power(1 + Power(q1,2),3)*q2*(1 + Power(q2,2))*q3*(1 + Power(q3,2)) - 2*a3*b2*Power(1 + Power(q1,2),3)*(1 + Power(q2,2))*(1 + Power(q3,2))*(q3 - Power(q2,2)*q3 + q2*(-1 + Power(q3,2))) + 2*a2*b3*Power(1 + Power(q1,2),3)*(1 + Power(q2,2))*(1 + Power(q3,2))*(q3 - Power(q2,2)*q3 + q2*(-1 + Power(q3,2))))*(2*b3*Power(1 + Power(q1,2),3)*Power(1 + Power(q2,2),3)*q3*(1 + Power(q3,2)) + a3*Power(1 + Power(q1,2),3)*Power(1 + Power(q2,2),3)*(-1 + Power(q3,4)) - 8*a1*a3*Power(1 + Power(q2,2),3)*q3*(1 + Power(q3,2))*Power(qdot1,2) - 8*b1*b3*Power(1 + Power(q2,2),3)*q3*(1 + Power(q3,2))*Power(qdot1,2) + 24*a1*a3*Power(q1,2)*Power(1 + Power(q2,2),3)*q3*(1 + Power(q3,2))*Power(qdot1,2) + 24*b1*b3*Power(q1,2)*Power(1 + Power(q2,2),3)*q3*(1 + Power(q3,2))*Power(qdot1,2) - 12*a1*a3*q1*Power(1 + Power(q2,2),3)*(-1 + Power(q3,2))*(1 + Power(q3,2))*Power(qdot1,2) - 12*b1*b3*q1*Power(1 + Power(q2,2),3)*(-1 + Power(q3,2))*(1 + Power(q3,2))*Power(qdot1,2) + 4*a1*a3*Power(q1,3)*Power(1 + Power(q2,2),3)*(-1 + Power(q3,2))*(1 + Power(q3,2))*Power(qdot1,2) + 4*b1*b3*Power(q1,3)*Power(1 + Power(q2,2),3)*(-1 + Power(q3,2))*(1 + Power(q3,2))*Power(qdot1,2) - 4*a3*b1*Power(1 + Power(q2,2),3)*(1 + Power(q3,2))*(-1 - 6*q1*q3 + 2*Power(q1,3)*q3 + Power(q3,2) - 3*Power(q1,2)*(-1 + Power(q3,2)))*Power(qdot1,2) + 4*a1*b3*Power(1 + Power(q2,2),3)*(1 + Power(q3,2))*(-1 - 6*q1*q3 + 2*Power(q1,3)*q3 + Power(q3,2) - 3*Power(q1,2)*(-1 + Power(q3,2)))*Power(qdot1,2) - 8*a2*a3*Power(1 + Power(q1,2),3)*q3*(1 + Power(q3,2))*Power(qdot2,2) - 8*b2*b3*Power(1 + Power(q1,2),3)*q3*(1 + Power(q3,2))*Power(qdot2,2) + 24*a2*a3*Power(1 + Power(q1,2),3)*Power(q2,2)*q3*(1 + Power(q3,2))*Power(qdot2,2) + 24*b2*b3*Power(1 + Power(q1,2),3)*Power(q2,2)*q3*(1 + Power(q3,2))*Power(qdot2,2) - 12*a2*a3*Power(1 + Power(q1,2),3)*q2*(-1 + Power(q3,2))*(1 + Power(q3,2))*Power(qdot2,2) - 12*b2*b3*Power(1 + Power(q1,2),3)*q2*(-1 + Power(q3,2))*(1 + Power(q3,2))*Power(qdot2,2) + 4*a2*a3*Power(1 + Power(q1,2),3)*Power(q2,3)*(-1 + Power(q3,2))*(1 + Power(q3,2))*Power(qdot2,2) + 4*b2*b3*Power(1 + Power(q1,2),3)*Power(q2,3)*(-1 + Power(q3,2))*(1 + Power(q3,2))*Power(qdot2,2) - 4*a3*b2*Power(1 + Power(q1,2),3)*(1 + Power(q3,2))*(-1 - 6*q2*q3 + 2*Power(q2,3)*q3 + Power(q3,2) - 3*Power(q2,2)*(-1 + Power(q3,2)))*Power(qdot2,2) + 4*a2*b3*Power(1 + Power(q1,2),3)*(1 + Power(q3,2))*(-1 - 6*q2*q3 + 2*Power(q2,3)*q3 + Power(q3,2) - 3*Power(q2,2)*(-1 + Power(q3,2)))*Power(qdot2,2) + 4*q3*Power(qdot3,2) + 12*Power(q1,2)*q3*Power(qdot3,2) + 12*Power(q1,4)*q3*Power(qdot3,2) + 4*Power(q1,6)*q3*Power(qdot3,2) + 12*Power(q2,2)*q3*Power(qdot3,2) + 36*Power(q1,2)*Power(q2,2)*q3*Power(qdot3,2) + 36*Power(q1,4)*Power(q2,2)*q3*Power(qdot3,2) + 12*Power(q1,6)*Power(q2,2)*q3*Power(qdot3,2) + 12*Power(q2,4)*q3*Power(qdot3,2) + 36*Power(q1,2)*Power(q2,4)*q3*Power(qdot3,2) + 36*Power(q1,4)*Power(q2,4)*q3*Power(qdot3,2) + 12*Power(q1,6)*Power(q2,4)*q3*Power(qdot3,2) + 4*Power(q2,6)*q3*Power(qdot3,2) + 12*Power(q1,2)*Power(q2,6)*q3*Power(qdot3,2) + 12*Power(q1,4)*Power(q2,6)*q3*Power(qdot3,2) + 4*Power(q1,6)*Power(q2,6)*q3*Power(qdot3,2))) + (-2*(1 + Power(q3,2)) - 6*Power(q1,2)*(1 + Power(q3,2)) - 6*Power(q1,4)*(1 + Power(q3,2)) - 2*Power(q1,6)*(1 + Power(q3,2)) - 6*Power(q2,2)*(1 + Power(q3,2)) - 18*Power(q1,2)*Power(q2,2)*(1 + Power(q3,2)) - 18*Power(q1,4)*Power(q2,2)*(1 + Power(q3,2)) - 6*Power(q1,6)*Power(q2,2)*(1 + Power(q3,2)) - 6*Power(q2,4)*(1 + Power(q3,2)) - 18*Power(q1,2)*Power(q2,4)*(1 + Power(q3,2)) - 18*Power(q1,4)*Power(q2,4)*(1 + Power(q3,2)) - 6*Power(q1,6)*Power(q2,4)*(1 + Power(q3,2)) - 2*Power(q2,6)*(1 + Power(q3,2)) - 6*Power(q1,2)*Power(q2,6)*(1 + Power(q3,2)) - 6*Power(q1,4)*Power(q2,6)*(1 + Power(q3,2)) - 2*Power(q1,6)*Power(q2,6)*(1 + Power(q3,2)))*(2*b2*Power(1 + Power(q1,2),3)*q2*(1 + Power(q2,2))*Power(1 + Power(q3,2),3) + a2*Power(1 + Power(q1,2),3)*(-1 + Power(q2,4))*Power(1 + Power(q3,2),3) - 8*a1*a2*q2*(1 + Power(q2,2))*Power(1 + Power(q3,2),3)*Power(qdot1,2) - 8*b1*b2*q2*(1 + Power(q2,2))*Power(1 + Power(q3,2),3)*Power(qdot1,2) + 24*a1*a2*Power(q1,2)*q2*(1 + Power(q2,2))*Power(1 + Power(q3,2),3)*Power(qdot1,2) + 24*b1*b2*Power(q1,2)*q2*(1 + Power(q2,2))*Power(1 + Power(q3,2),3)*Power(qdot1,2) - 12*a1*a2*q1*(-1 + Power(q2,2))*(1 + Power(q2,2))*Power(1 + Power(q3,2),3)*Power(qdot1,2) - 12*b1*b2*q1*(-1 + Power(q2,2))*(1 + Power(q2,2))*Power(1 + Power(q3,2),3)*Power(qdot1,2) + 4*a1*a2*Power(q1,3)*(-1 + Power(q2,2))*(1 + Power(q2,2))*Power(1 + Power(q3,2),3)*Power(qdot1,2) + 4*b1*b2*Power(q1,3)*(-1 + Power(q2,2))*(1 + Power(q2,2))*Power(1 + Power(q3,2),3)*Power(qdot1,2) - 4*a2*b1*(1 + Power(q2,2))*(-1 - 6*q1*q2 + 2*Power(q1,3)*q2 + Power(q2,2) - 3*Power(q1,2)*(-1 + Power(q2,2)))*Power(1 + Power(q3,2),3)*Power(qdot1,2) + 4*a1*b2*(1 + Power(q2,2))*(-1 - 6*q1*q2 + 2*Power(q1,3)*q2 + Power(q2,2) - 3*Power(q1,2)*(-1 + Power(q2,2)))*Power(1 + Power(q3,2),3)*Power(qdot1,2) + 4*q2*Power(qdot2,2) + 12*Power(q1,2)*q2*Power(qdot2,2) + 12*Power(q1,4)*q2*Power(qdot2,2) + 4*Power(q1,6)*q2*Power(qdot2,2) + 12*q2*Power(q3,2)*Power(qdot2,2) + 36*Power(q1,2)*q2*Power(q3,2)*Power(qdot2,2) + 36*Power(q1,4)*q2*Power(q3,2)*Power(qdot2,2) + 12*Power(q1,6)*q2*Power(q3,2)*Power(qdot2,2) + 12*q2*Power(q3,4)*Power(qdot2,2) + 36*Power(q1,2)*q2*Power(q3,4)*Power(qdot2,2) + 36*Power(q1,4)*q2*Power(q3,4)*Power(qdot2,2) + 12*Power(q1,6)*q2*Power(q3,4)*Power(qdot2,2) + 4*q2*Power(q3,6)*Power(qdot2,2) + 12*Power(q1,2)*q2*Power(q3,6)*Power(qdot2,2) + 12*Power(q1,4)*q2*Power(q3,6)*Power(qdot2,2) + 4*Power(q1,6)*q2*Power(q3,6)*Power(qdot2,2) + 6*a2*a3*Power(1 + Power(q1,2),3)*(1 + Power(q2,2))*q3*Power(qdot3,2) + 6*b2*b3*Power(1 + Power(q1,2),3)*(1 + Power(q2,2))*q3*Power(qdot3,2) - 6*a2*a3*Power(1 + Power(q1,2),3)*Power(q2,2)*(1 + Power(q2,2))*q3*Power(qdot3,2) - 6*b2*b3*Power(1 + Power(q1,2),3)*Power(q2,2)*(1 + Power(q2,2))*q3*Power(qdot3,2) - 2*a2*a3*Power(1 + Power(q1,2),3)*(1 + Power(q2,2))*Power(q3,3)*Power(qdot3,2) - 2*b2*b3*Power(1 + Power(q1,2),3)*(1 + Power(q2,2))*Power(q3,3)*Power(qdot3,2) + 2*a2*a3*Power(1 + Power(q1,2),3)*Power(q2,2)*(1 + Power(q2,2))*Power(q3,3)*Power(qdot3,2) + 2*b2*b3*Power(1 + Power(q1,2),3)*Power(q2,2)*(1 + Power(q2,2))*Power(q3,3)*Power(qdot3,2) + 4*a2*a3*Power(1 + Power(q1,2),3)*q2*(1 + Power(q2,2))*(-1 + 3*Power(q3,2))*Power(qdot3,2) + 4*b2*b3*Power(1 + Power(q1,2),3)*q2*(1 + Power(q2,2))*(-1 + 3*Power(q3,2))*Power(qdot3,2) - 2*a3*b2*Power(1 + Power(q1,2),3)*(1 + Power(q2,2))*(1 - 3*Power(q3,2) - 2*q2*q3*(-3 + Power(q3,2)) + Power(q2,2)*(-1 + 3*Power(q3,2)))*Power(qdot3,2) + 2*a2*b3*Power(1 + Power(q1,2),3)*(1 + Power(q2,2))*(1 - 3*Power(q3,2) - 2*q2*q3*(-3 + Power(q3,2)) + Power(q2,2)*(-1 + 3*Power(q3,2)))*Power(qdot3,2))))/(((-2*(1 + Power(q3,2)) - 6*Power(q1,2)*(1 + Power(q3,2)) - 6*Power(q1,4)*(1 + Power(q3,2)) - 2*Power(q1,6)*(1 + Power(q3,2)) - 6*Power(q2,2)*(1 + Power(q3,2)) - 18*Power(q1,2)*Power(q2,2)*(1 + Power(q3,2)) - 18*Power(q1,4)*Power(q2,2)*(1 + Power(q3,2)) - 6*Power(q1,6)*Power(q2,2)*(1 + Power(q3,2)) - 6*Power(q2,4)*(1 + Power(q3,2)) - 18*Power(q1,2)*Power(q2,4)*(1 + Power(q3,2)) - 18*Power(q1,4)*Power(q2,4)*(1 + Power(q3,2)) - 6*Power(q1,6)*Power(q2,4)*(1 + Power(q3,2)) - 2*Power(q2,6)*(1 + Power(q3,2)) - 6*Power(q1,2)*Power(q2,6)*(1 + Power(q3,2)) - 6*Power(q1,4)*Power(q2,6)*(1 + Power(q3,2)) - 2*Power(q1,6)*Power(q2,6)*(1 + Power(q3,2)))*(-4*a1*a2*(1 + Power(q1,2))*Power(1 + Power(q3,2),3) - 4*b1*b2*(1 + Power(q1,2))*Power(1 + Power(q3,2),3) + 4*a1*a2*Power(q1,2)*(1 + Power(q1,2))*Power(1 + Power(q3,2),3) + 4*b1*b2*Power(q1,2)*(1 + Power(q1,2))*Power(1 + Power(q3,2),3) + 4*a1*a2*(1 + Power(q1,2))*Power(q2,4)*Power(1 + Power(q3,2),3) + 4*b1*b2*(1 + Power(q1,2))*Power(q2,4)*Power(1 + Power(q3,2),3) - 4*a1*a2*Power(q1,2)*(1 + Power(q1,2))*Power(q2,4)*Power(1 + Power(q3,2),3) - 4*b1*b2*Power(q1,2)*(1 + Power(q1,2))*Power(q2,4)*Power(1 + Power(q3,2),3) - 16*a1*a2*q1*(1 + Power(q1,2))*q2*(1 + Power(q2,2))*Power(1 + Power(q3,2),3) - 16*b1*b2*q1*(1 + Power(q1,2))*q2*(1 + Power(q2,2))*Power(1 + Power(q3,2),3) - 8*a2*b1*(1 + Power(q1,2))*(1 + Power(q2,2))*(q2 - Power(q1,2)*q2 + q1*(-1 + Power(q2,2)))*Power(1 + Power(q3,2),3) + 8*a1*b2*(1 + Power(q1,2))*(1 + Power(q2,2))*(q2 - Power(q1,2)*q2 + q1*(-1 + Power(q2,2)))*Power(1 + Power(q3,2),3)) - (-2*a1*a3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3) - 2*b1*b3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3) + 2*a1*a3*Power(q1,2)*(1 + Power(q1,2))*Power(1 + Power(q2,2),3) + 2*b1*b3*Power(q1,2)*(1 + Power(q1,2))*Power(1 + Power(q2,2),3) + 2*a1*a3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*Power(q3,4) + 2*b1*b3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*Power(q3,4) - 2*a1*a3*Power(q1,2)*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*Power(q3,4) - 2*b1*b3*Power(q1,2)*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*Power(q3,4) - 8*a1*a3*q1*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*q3*(1 + Power(q3,2)) - 8*b1*b3*q1*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*q3*(1 + Power(q3,2)) - 4*a3*b1*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*(1 + Power(q3,2))*(q3 - Power(q1,2)*q3 + q1*(-1 + Power(q3,2))) + 4*a1*b3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*(1 + Power(q3,2))*(q3 - Power(q1,2)*q3 + q1*(-1 + Power(q3,2))))*(-2*a2*a3*Power(1 + Power(q1,2),3)*(1 + Power(q3,2)) - 2*b2*b3*Power(1 + Power(q1,2),3)*(1 + Power(q3,2)) - 8*a2*a3*Power(1 + Power(q1,2),3)*q2*q3*(1 + Power(q3,2)) - 8*b2*b3*Power(1 + Power(q1,2),3)*q2*q3*(1 + Power(q3,2)) - 8*a2*a3*Power(1 + Power(q1,2),3)*Power(q2,3)*q3*(1 + Power(q3,2)) - 8*b2*b3*Power(1 + Power(q1,2),3)*Power(q2,3)*q3*(1 + Power(q3,2)) + 2*a2*a3*Power(1 + Power(q1,2),3)*Power(q3,2)*(1 + Power(q3,2)) + 2*b2*b3*Power(1 + Power(q1,2),3)*Power(q3,2)*(1 + Power(q3,2)) - 2*a2*a3*Power(1 + Power(q1,2),3)*Power(q2,4)*(-1 + Power(q3,2))*(1 + Power(q3,2)) - 2*b2*b3*Power(1 + Power(q1,2),3)*Power(q2,4)*(-1 + Power(q3,2))*(1 + Power(q3,2)) + 4*a3*b2*Power(1 + Power(q1,2),3)*(1 + Power(q2,2))*(1 + Power(q3,2))*(-q3 + Power(q2,2)*q3 - q2*(-1 + Power(q3,2))) - 4*a2*b3*Power(1 + Power(q1,2),3)*(1 + Power(q2,2))*(1 + Power(q3,2))*(-q3 + Power(q2,2)*q3 - q2*(-1 + Power(q3,2)))))*((-2*(1 + Power(q3,2)) - 6*Power(q1,2)*(1 + Power(q3,2)) - 6*Power(q1,4)*(1 + Power(q3,2)) - 2*Power(q1,6)*(1 + Power(q3,2)) - 6*Power(q2,2)*(1 + Power(q3,2)) - 18*Power(q1,2)*Power(q2,2)*(1 + Power(q3,2)) - 18*Power(q1,4)*Power(q2,2)*(1 + Power(q3,2)) - 6*Power(q1,6)*Power(q2,2)*(1 + Power(q3,2)) - 6*Power(q2,4)*(1 + Power(q3,2)) - 18*Power(q1,2)*Power(q2,4)*(1 + Power(q3,2)) - 18*Power(q1,4)*Power(q2,4)*(1 + Power(q3,2)) - 6*Power(q1,6)*Power(q2,4)*(1 + Power(q3,2)) - 2*Power(q2,6)*(1 + Power(q3,2)) - 6*Power(q1,2)*Power(q2,6)*(1 + Power(q3,2)) - 6*Power(q1,4)*Power(q2,6)*(1 + Power(q3,2)) - 2*Power(q1,6)*Power(q2,6)*(1 + Power(q3,2)))*(-2*a1*a2*(1 + Power(q2,2))*Power(1 + Power(q3,2),3) - 2*b1*b2*(1 + Power(q2,2))*Power(1 + Power(q3,2),3) - 8*a1*a2*q1*q2*(1 + Power(q2,2))*Power(1 + Power(q3,2),3) - 8*b1*b2*q1*q2*(1 + Power(q2,2))*Power(1 + Power(q3,2),3) - 8*a1*a2*Power(q1,3)*q2*(1 + Power(q2,2))*Power(1 + Power(q3,2),3) - 8*b1*b2*Power(q1,3)*q2*(1 + Power(q2,2))*Power(1 + Power(q3,2),3) + 2*a1*a2*Power(q2,2)*(1 + Power(q2,2))*Power(1 + Power(q3,2),3) + 2*b1*b2*Power(q2,2)*(1 + Power(q2,2))*Power(1 + Power(q3,2),3) - 2*a1*a2*Power(q1,4)*(-1 + Power(q2,2))*(1 + Power(q2,2))*Power(1 + Power(q3,2),3) - 2*b1*b2*Power(q1,4)*(-1 + Power(q2,2))*(1 + Power(q2,2))*Power(1 + Power(q3,2),3) + 4*a2*b1*(1 + Power(q1,2))*(1 + Power(q2,2))*(-q2 + Power(q1,2)*q2 - q1*(-1 + Power(q2,2)))*Power(1 + Power(q3,2),3) - 4*a1*b2*(1 + Power(q1,2))*(1 + Power(q2,2))*(-q2 + Power(q1,2)*q2 - q1*(-1 + Power(q2,2)))*Power(1 + Power(q3,2),3)) - (-2*a1*a3*Power(1 + Power(q2,2),3)*(1 + Power(q3,2)) - 2*b1*b3*Power(1 + Power(q2,2),3)*(1 + Power(q3,2)) - 8*a1*a3*q1*Power(1 + Power(q2,2),3)*q3*(1 + Power(q3,2)) - 8*b1*b3*q1*Power(1 + Power(q2,2),3)*q3*(1 + Power(q3,2)) - 8*a1*a3*Power(q1,3)*Power(1 + Power(q2,2),3)*q3*(1 + Power(q3,2)) - 8*b1*b3*Power(q1,3)*Power(1 + Power(q2,2),3)*q3*(1 + Power(q3,2)) + 2*a1*a3*Power(1 + Power(q2,2),3)*Power(q3,2)*(1 + Power(q3,2)) + 2*b1*b3*Power(1 + Power(q2,2),3)*Power(q3,2)*(1 + Power(q3,2)) - 2*a1*a3*Power(q1,4)*Power(1 + Power(q2,2),3)*(-1 + Power(q3,2))*(1 + Power(q3,2)) - 2*b1*b3*Power(q1,4)*Power(1 + Power(q2,2),3)*(-1 + Power(q3,2))*(1 + Power(q3,2)) + 4*a3*b1*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*(1 + Power(q3,2))*(-q3 + Power(q1,2)*q3 - q1*(-1 + Power(q3,2))) - 4*a1*b3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*(1 + Power(q3,2))*(-q3 + Power(q1,2)*q3 - q1*(-1 + Power(q3,2))))*(-(a2*a3*Power(1 + Power(q1,2),3)*(1 + Power(q2,2))) - b2*b3*Power(1 + Power(q1,2),3)*(1 + Power(q2,2)) + a2*a3*Power(1 + Power(q1,2),3)*Power(q2,2)*(1 + Power(q2,2)) + b2*b3*Power(1 + Power(q1,2),3)*Power(q2,2)*(1 + Power(q2,2)) + a2*a3*Power(1 + Power(q1,2),3)*(1 + Power(q2,2))*Power(q3,4) + b2*b3*Power(1 + Power(q1,2),3)*(1 + Power(q2,2))*Power(q3,4) - a2*a3*Power(1 + Power(q1,2),3)*Power(q2,2)*(1 + Power(q2,2))*Power(q3,4) - b2*b3*Power(1 + Power(q1,2),3)*Power(q2,2)*(1 + Power(q2,2))*Power(q3,4) - 4*a2*a3*Power(1 + Power(q1,2),3)*q2*(1 + Power(q2,2))*q3*(1 + Power(q3,2)) - 4*b2*b3*Power(1 + Power(q1,2),3)*q2*(1 + Power(q2,2))*q3*(1 + Power(q3,2)) - 2*a3*b2*Power(1 + Power(q1,2),3)*(1 + Power(q2,2))*(1 + Power(q3,2))*(q3 - Power(q2,2)*q3 + q2*(-1 + Power(q3,2))) + 2*a2*b3*Power(1 + Power(q1,2),3)*(1 + Power(q2,2))*(1 + Power(q3,2))*(q3 - Power(q2,2)*q3 + q2*(-1 + Power(q3,2))))) - ((-6*(1 + Power(q1,2)) - 18*(1 + Power(q1,2))*Power(q2,2) - 18*(1 + Power(q1,2))*Power(q2,4) - 6*(1 + Power(q1,2))*Power(q2,6) - 18*(1 + Power(q1,2))*Power(q3,2) - 54*(1 + Power(q1,2))*Power(q2,2)*Power(q3,2) - 54*(1 + Power(q1,2))*Power(q2,4)*Power(q3,2) - 18*(1 + Power(q1,2))*Power(q2,6)*Power(q3,2) - 18*(1 + Power(q1,2))*Power(q3,4) - 54*(1 + Power(q1,2))*Power(q2,2)*Power(q3,4) - 54*(1 + Power(q1,2))*Power(q2,4)*Power(q3,4) - 18*(1 + Power(q1,2))*Power(q2,6)*Power(q3,4) - 6*(1 + Power(q1,2))*Power(q3,6) - 18*(1 + Power(q1,2))*Power(q2,2)*Power(q3,6) - 18*(1 + Power(q1,2))*Power(q2,4)*Power(q3,6) - 6*(1 + Power(q1,2))*Power(q2,6)*Power(q3,6))*(-2*(1 + Power(q3,2)) - 6*Power(q1,2)*(1 + Power(q3,2)) - 6*Power(q1,4)*(1 + Power(q3,2)) - 2*Power(q1,6)*(1 + Power(q3,2)) - 6*Power(q2,2)*(1 + Power(q3,2)) - 18*Power(q1,2)*Power(q2,2)*(1 + Power(q3,2)) - 18*Power(q1,4)*Power(q2,2)*(1 + Power(q3,2)) - 6*Power(q1,6)*Power(q2,2)*(1 + Power(q3,2)) - 6*Power(q2,4)*(1 + Power(q3,2)) - 18*Power(q1,2)*Power(q2,4)*(1 + Power(q3,2)) - 18*Power(q1,4)*Power(q2,4)*(1 + Power(q3,2)) - 6*Power(q1,6)*Power(q2,4)*(1 + Power(q3,2)) - 2*Power(q2,6)*(1 + Power(q3,2)) - 6*Power(q1,2)*Power(q2,6)*(1 + Power(q3,2)) - 6*Power(q1,4)*Power(q2,6)*(1 + Power(q3,2)) - 2*Power(q1,6)*Power(q2,6)*(1 + Power(q3,2))) - (-2*a1*a3*Power(1 + Power(q2,2),3)*(1 + Power(q3,2)) - 2*b1*b3*Power(1 + Power(q2,2),3)*(1 + Power(q3,2)) - 8*a1*a3*q1*Power(1 + Power(q2,2),3)*q3*(1 + Power(q3,2)) - 8*b1*b3*q1*Power(1 + Power(q2,2),3)*q3*(1 + Power(q3,2)) - 8*a1*a3*Power(q1,3)*Power(1 + Power(q2,2),3)*q3*(1 + Power(q3,2)) - 8*b1*b3*Power(q1,3)*Power(1 + Power(q2,2),3)*q3*(1 + Power(q3,2)) + 2*a1*a3*Power(1 + Power(q2,2),3)*Power(q3,2)*(1 + Power(q3,2)) + 2*b1*b3*Power(1 + Power(q2,2),3)*Power(q3,2)*(1 + Power(q3,2)) - 2*a1*a3*Power(q1,4)*Power(1 + Power(q2,2),3)*(-1 + Power(q3,2))*(1 + Power(q3,2)) - 2*b1*b3*Power(q1,4)*Power(1 + Power(q2,2),3)*(-1 + Power(q3,2))*(1 + Power(q3,2)) + 4*a3*b1*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*(1 + Power(q3,2))*(-q3 + Power(q1,2)*q3 - q1*(-1 + Power(q3,2))) - 4*a1*b3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*(1 + Power(q3,2))*(-q3 + Power(q1,2)*q3 - q1*(-1 + Power(q3,2))))*(-2*a1*a3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3) - 2*b1*b3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3) + 2*a1*a3*Power(q1,2)*(1 + Power(q1,2))*Power(1 + Power(q2,2),3) + 2*b1*b3*Power(q1,2)*(1 + Power(q1,2))*Power(1 + Power(q2,2),3) + 2*a1*a3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*Power(q3,4) + 2*b1*b3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*Power(q3,4) - 2*a1*a3*Power(q1,2)*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*Power(q3,4) - 2*b1*b3*Power(q1,2)*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*Power(q3,4) - 8*a1*a3*q1*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*q3*(1 + Power(q3,2)) - 8*b1*b3*q1*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*q3*(1 + Power(q3,2)) - 4*a3*b1*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*(1 + Power(q3,2))*(q3 - Power(q1,2)*q3 + q1*(-1 + Power(q3,2))) + 4*a1*b3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*(1 + Power(q3,2))*(q3 - Power(q1,2)*q3 + q1*(-1 + Power(q3,2)))))*((-2*(1 + Power(q2,2)) - 6*Power(q1,2)*(1 + Power(q2,2)) - 6*Power(q1,4)*(1 + Power(q2,2)) - 2*Power(q1,6)*(1 + Power(q2,2)) - 6*(1 + Power(q2,2))*Power(q3,2) - 18*Power(q1,2)*(1 + Power(q2,2))*Power(q3,2) - 18*Power(q1,4)*(1 + Power(q2,2))*Power(q3,2) - 6*Power(q1,6)*(1 + Power(q2,2))*Power(q3,2) - 6*(1 + Power(q2,2))*Power(q3,4) - 18*Power(q1,2)*(1 + Power(q2,2))*Power(q3,4) - 18*Power(q1,4)*(1 + Power(q2,2))*Power(q3,4) - 6*Power(q1,6)*(1 + Power(q2,2))*Power(q3,4) - 2*(1 + Power(q2,2))*Power(q3,6) - 6*Power(q1,2)*(1 + Power(q2,2))*Power(q3,6) - 6*Power(q1,4)*(1 + Power(q2,2))*Power(q3,6) - 2*Power(q1,6)*(1 + Power(q2,2))*Power(q3,6))*(-2*(1 + Power(q3,2)) - 6*Power(q1,2)*(1 + Power(q3,2)) - 6*Power(q1,4)*(1 + Power(q3,2)) - 2*Power(q1,6)*(1 + Power(q3,2)) - 6*Power(q2,2)*(1 + Power(q3,2)) - 18*Power(q1,2)*Power(q2,2)*(1 + Power(q3,2)) - 18*Power(q1,4)*Power(q2,2)*(1 + Power(q3,2)) - 6*Power(q1,6)*Power(q2,2)*(1 + Power(q3,2)) - 6*Power(q2,4)*(1 + Power(q3,2)) - 18*Power(q1,2)*Power(q2,4)*(1 + Power(q3,2)) - 18*Power(q1,4)*Power(q2,4)*(1 + Power(q3,2)) - 6*Power(q1,6)*Power(q2,4)*(1 + Power(q3,2)) - 2*Power(q2,6)*(1 + Power(q3,2)) - 6*Power(q1,2)*Power(q2,6)*(1 + Power(q3,2)) - 6*Power(q1,4)*Power(q2,6)*(1 + Power(q3,2)) - 2*Power(q1,6)*Power(q2,6)*(1 + Power(q3,2))) - (-2*a2*a3*Power(1 + Power(q1,2),3)*(1 + Power(q3,2)) - 2*b2*b3*Power(1 + Power(q1,2),3)*(1 + Power(q3,2)) - 8*a2*a3*Power(1 + Power(q1,2),3)*q2*q3*(1 + Power(q3,2)) - 8*b2*b3*Power(1 + Power(q1,2),3)*q2*q3*(1 + Power(q3,2)) - 8*a2*a3*Power(1 + Power(q1,2),3)*Power(q2,3)*q3*(1 + Power(q3,2)) - 8*b2*b3*Power(1 + Power(q1,2),3)*Power(q2,3)*q3*(1 + Power(q3,2)) + 2*a2*a3*Power(1 + Power(q1,2),3)*Power(q3,2)*(1 + Power(q3,2)) + 2*b2*b3*Power(1 + Power(q1,2),3)*Power(q3,2)*(1 + Power(q3,2)) - 2*a2*a3*Power(1 + Power(q1,2),3)*Power(q2,4)*(-1 + Power(q3,2))*(1 + Power(q3,2)) - 2*b2*b3*Power(1 + Power(q1,2),3)*Power(q2,4)*(-1 + Power(q3,2))*(1 + Power(q3,2)) + 4*a3*b2*Power(1 + Power(q1,2),3)*(1 + Power(q2,2))*(1 + Power(q3,2))*(-q3 + Power(q2,2)*q3 - q2*(-1 + Power(q3,2))) - 4*a2*b3*Power(1 + Power(q1,2),3)*(1 + Power(q2,2))*(1 + Power(q3,2))*(-q3 + Power(q2,2)*q3 - q2*(-1 + Power(q3,2))))*(-(a2*a3*Power(1 + Power(q1,2),3)*(1 + Power(q2,2))) - b2*b3*Power(1 + Power(q1,2),3)*(1 + Power(q2,2)) + a2*a3*Power(1 + Power(q1,2),3)*Power(q2,2)*(1 + Power(q2,2)) + b2*b3*Power(1 + Power(q1,2),3)*Power(q2,2)*(1 + Power(q2,2)) + a2*a3*Power(1 + Power(q1,2),3)*(1 + Power(q2,2))*Power(q3,4) + b2*b3*Power(1 + Power(q1,2),3)*(1 + Power(q2,2))*Power(q3,4) - a2*a3*Power(1 + Power(q1,2),3)*Power(q2,2)*(1 + Power(q2,2))*Power(q3,4) - b2*b3*Power(1 + Power(q1,2),3)*Power(q2,2)*(1 + Power(q2,2))*Power(q3,4) - 4*a2*a3*Power(1 + Power(q1,2),3)*q2*(1 + Power(q2,2))*q3*(1 + Power(q3,2)) - 4*b2*b3*Power(1 + Power(q1,2),3)*q2*(1 + Power(q2,2))*q3*(1 + Power(q3,2)) - 2*a3*b2*Power(1 + Power(q1,2),3)*(1 + Power(q2,2))*(1 + Power(q3,2))*(q3 - Power(q2,2)*q3 + q2*(-1 + Power(q3,2))) + 2*a2*b3*Power(1 + Power(q1,2),3)*(1 + Power(q2,2))*(1 + Power(q3,2))*(q3 - Power(q2,2)*q3 + q2*(-1 + Power(q3,2))))))),-((-((-2*a1*a3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3) - 2*b1*b3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3) + 2*a1*a3*Power(q1,2)*(1 + Power(q1,2))*Power(1 + Power(q2,2),3) + 2*b1*b3*Power(q1,2)*(1 + Power(q1,2))*Power(1 + Power(q2,2),3) + 2*a1*a3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*Power(q3,4) + 2*b1*b3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*Power(q3,4) - 2*a1*a3*Power(q1,2)*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*Power(q3,4) - 2*b1*b3*Power(q1,2)*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*Power(q3,4) - 8*a1*a3*q1*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*q3*(1 + Power(q3,2)) - 8*b1*b3*q1*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*q3*(1 + Power(q3,2)) - 4*a3*b1*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*(1 + Power(q3,2))*(q3 - Power(q1,2)*q3 + q1*(-1 + Power(q3,2))) + 4*a1*b3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*(1 + Power(q3,2))*(q3 - Power(q1,2)*q3 + q1*(-1 + Power(q3,2))))*(2*b3*Power(1 + Power(q1,2),3)*Power(1 + Power(q2,2),3)*q3*(1 + Power(q3,2)) + a3*Power(1 + Power(q1,2),3)*Power(1 + Power(q2,2),3)*(-1 + Power(q3,4)) - 8*a1*a3*Power(1 + Power(q2,2),3)*q3*(1 + Power(q3,2))*Power(qdot1,2) - 8*b1*b3*Power(1 + Power(q2,2),3)*q3*(1 + Power(q3,2))*Power(qdot1,2) + 24*a1*a3*Power(q1,2)*Power(1 + Power(q2,2),3)*q3*(1 + Power(q3,2))*Power(qdot1,2) + 24*b1*b3*Power(q1,2)*Power(1 + Power(q2,2),3)*q3*(1 + Power(q3,2))*Power(qdot1,2) - 12*a1*a3*q1*Power(1 + Power(q2,2),3)*(-1 + Power(q3,2))*(1 + Power(q3,2))*Power(qdot1,2) - 12*b1*b3*q1*Power(1 + Power(q2,2),3)*(-1 + Power(q3,2))*(1 + Power(q3,2))*Power(qdot1,2) + 4*a1*a3*Power(q1,3)*Power(1 + Power(q2,2),3)*(-1 + Power(q3,2))*(1 + Power(q3,2))*Power(qdot1,2) + 4*b1*b3*Power(q1,3)*Power(1 + Power(q2,2),3)*(-1 + Power(q3,2))*(1 + Power(q3,2))*Power(qdot1,2) - 4*a3*b1*Power(1 + Power(q2,2),3)*(1 + Power(q3,2))*(-1 - 6*q1*q3 + 2*Power(q1,3)*q3 + Power(q3,2) - 3*Power(q1,2)*(-1 + Power(q3,2)))*Power(qdot1,2) + 4*a1*b3*Power(1 + Power(q2,2),3)*(1 + Power(q3,2))*(-1 - 6*q1*q3 + 2*Power(q1,3)*q3 + Power(q3,2) - 3*Power(q1,2)*(-1 + Power(q3,2)))*Power(qdot1,2) - 8*a2*a3*Power(1 + Power(q1,2),3)*q3*(1 + Power(q3,2))*Power(qdot2,2) - 8*b2*b3*Power(1 + Power(q1,2),3)*q3*(1 + Power(q3,2))*Power(qdot2,2) + 24*a2*a3*Power(1 + Power(q1,2),3)*Power(q2,2)*q3*(1 + Power(q3,2))*Power(qdot2,2) + 24*b2*b3*Power(1 + Power(q1,2),3)*Power(q2,2)*q3*(1 + Power(q3,2))*Power(qdot2,2) - 12*a2*a3*Power(1 + Power(q1,2),3)*q2*(-1 + Power(q3,2))*(1 + Power(q3,2))*Power(qdot2,2) - 12*b2*b3*Power(1 + Power(q1,2),3)*q2*(-1 + Power(q3,2))*(1 + Power(q3,2))*Power(qdot2,2) + 4*a2*a3*Power(1 + Power(q1,2),3)*Power(q2,3)*(-1 + Power(q3,2))*(1 + Power(q3,2))*Power(qdot2,2) + 4*b2*b3*Power(1 + Power(q1,2),3)*Power(q2,3)*(-1 + Power(q3,2))*(1 + Power(q3,2))*Power(qdot2,2) - 4*a3*b2*Power(1 + Power(q1,2),3)*(1 + Power(q3,2))*(-1 - 6*q2*q3 + 2*Power(q2,3)*q3 + Power(q3,2) - 3*Power(q2,2)*(-1 + Power(q3,2)))*Power(qdot2,2) + 4*a2*b3*Power(1 + Power(q1,2),3)*(1 + Power(q3,2))*(-1 - 6*q2*q3 + 2*Power(q2,3)*q3 + Power(q3,2) - 3*Power(q2,2)*(-1 + Power(q3,2)))*Power(qdot2,2) + 4*q3*Power(qdot3,2) + 12*Power(q1,2)*q3*Power(qdot3,2) + 12*Power(q1,4)*q3*Power(qdot3,2) + 4*Power(q1,6)*q3*Power(qdot3,2) + 12*Power(q2,2)*q3*Power(qdot3,2) + 36*Power(q1,2)*Power(q2,2)*q3*Power(qdot3,2) + 36*Power(q1,4)*Power(q2,2)*q3*Power(qdot3,2) + 12*Power(q1,6)*Power(q2,2)*q3*Power(qdot3,2) + 12*Power(q2,4)*q3*Power(qdot3,2) + 36*Power(q1,2)*Power(q2,4)*q3*Power(qdot3,2) + 36*Power(q1,4)*Power(q2,4)*q3*Power(qdot3,2) + 12*Power(q1,6)*Power(q2,4)*q3*Power(qdot3,2) + 4*Power(q2,6)*q3*Power(qdot3,2) + 12*Power(q1,2)*Power(q2,6)*q3*Power(qdot3,2) + 12*Power(q1,4)*Power(q2,6)*q3*Power(qdot3,2) + 4*Power(q1,6)*Power(q2,6)*q3*Power(qdot3,2))) + (-2*(1 + Power(q3,2)) - 6*Power(q1,2)*(1 + Power(q3,2)) - 6*Power(q1,4)*(1 + Power(q3,2)) - 2*Power(q1,6)*(1 + Power(q3,2)) - 6*Power(q2,2)*(1 + Power(q3,2)) - 18*Power(q1,2)*Power(q2,2)*(1 + Power(q3,2)) - 18*Power(q1,4)*Power(q2,2)*(1 + Power(q3,2)) - 6*Power(q1,6)*Power(q2,2)*(1 + Power(q3,2)) - 6*Power(q2,4)*(1 + Power(q3,2)) - 18*Power(q1,2)*Power(q2,4)*(1 + Power(q3,2)) - 18*Power(q1,4)*Power(q2,4)*(1 + Power(q3,2)) - 6*Power(q1,6)*Power(q2,4)*(1 + Power(q3,2)) - 2*Power(q2,6)*(1 + Power(q3,2)) - 6*Power(q1,2)*Power(q2,6)*(1 + Power(q3,2)) - 6*Power(q1,4)*Power(q2,6)*(1 + Power(q3,2)) - 2*Power(q1,6)*Power(q2,6)*(1 + Power(q3,2)))*(6*b1*q1*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*Power(1 + Power(q3,2),3) + 3*a1*(-1 + Power(q1,4))*Power(1 + Power(q2,2),3)*Power(1 + Power(q3,2),3) + 12*q1*Power(qdot1,2) + 36*q1*Power(q2,2)*Power(qdot1,2) + 36*q1*Power(q2,4)*Power(qdot1,2) + 12*q1*Power(q2,6)*Power(qdot1,2) + 36*q1*Power(q3,2)*Power(qdot1,2) + 108*q1*Power(q2,2)*Power(q3,2)*Power(qdot1,2) + 108*q1*Power(q2,4)*Power(q3,2)*Power(qdot1,2) + 36*q1*Power(q2,6)*Power(q3,2)*Power(qdot1,2) + 36*q1*Power(q3,4)*Power(qdot1,2) + 108*q1*Power(q2,2)*Power(q3,4)*Power(qdot1,2) + 108*q1*Power(q2,4)*Power(q3,4)*Power(qdot1,2) + 36*q1*Power(q2,6)*Power(q3,4)*Power(qdot1,2) + 12*q1*Power(q3,6)*Power(qdot1,2) + 36*q1*Power(q2,2)*Power(q3,6)*Power(qdot1,2) + 36*q1*Power(q2,4)*Power(q3,6)*Power(qdot1,2) + 12*q1*Power(q2,6)*Power(q3,6)*Power(qdot1,2) + 24*a1*a2*(1 + Power(q1,2))*q2*Power(1 + Power(q3,2),3)*Power(qdot2,2) + 24*b1*b2*(1 + Power(q1,2))*q2*Power(1 + Power(q3,2),3)*Power(qdot2,2) - 24*a1*a2*Power(q1,2)*(1 + Power(q1,2))*q2*Power(1 + Power(q3,2),3)*Power(qdot2,2) - 24*b1*b2*Power(q1,2)*(1 + Power(q1,2))*q2*Power(1 + Power(q3,2),3)*Power(qdot2,2) - 8*a1*a2*(1 + Power(q1,2))*Power(q2,3)*Power(1 + Power(q3,2),3)*Power(qdot2,2) - 8*b1*b2*(1 + Power(q1,2))*Power(q2,3)*Power(1 + Power(q3,2),3)*Power(qdot2,2) + 8*a1*a2*Power(q1,2)*(1 + Power(q1,2))*Power(q2,3)*Power(1 + Power(q3,2),3)*Power(qdot2,2) + 8*b1*b2*Power(q1,2)*(1 + Power(q1,2))*Power(q2,3)*Power(1 + Power(q3,2),3)*Power(qdot2,2) + 16*a1*a2*q1*(1 + Power(q1,2))*(-1 + 3*Power(q2,2))*Power(1 + Power(q3,2),3)*Power(qdot2,2) + 16*b1*b2*q1*(1 + Power(q1,2))*(-1 + 3*Power(q2,2))*Power(1 + Power(q3,2),3)*Power(qdot2,2) - 8*a2*b1*(1 + Power(q1,2))*(1 - 3*Power(q2,2) - 2*q1*q2*(-3 + Power(q2,2)) + Power(q1,2)*(-1 + 3*Power(q2,2)))*Power(1 + Power(q3,2),3)*Power(qdot2,2) + 8*a1*b2*(1 + Power(q1,2))*(1 - 3*Power(q2,2) - 2*q1*q2*(-3 + Power(q2,2)) + Power(q1,2)*(-1 + 3*Power(q2,2)))*Power(1 + Power(q3,2),3)*Power(qdot2,2) + 12*a1*a3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*q3*Power(qdot3,2) + 12*b1*b3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*q3*Power(qdot3,2) - 12*a1*a3*Power(q1,2)*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*q3*Power(qdot3,2) - 12*b1*b3*Power(q1,2)*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*q3*Power(qdot3,2) - 4*a1*a3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*Power(q3,3)*Power(qdot3,2) - 4*b1*b3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*Power(q3,3)*Power(qdot3,2) + 4*a1*a3*Power(q1,2)*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*Power(q3,3)*Power(qdot3,2) + 4*b1*b3*Power(q1,2)*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*Power(q3,3)*Power(qdot3,2) + 8*a1*a3*q1*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*(-1 + 3*Power(q3,2))*Power(qdot3,2) + 8*b1*b3*q1*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*(-1 + 3*Power(q3,2))*Power(qdot3,2) - 4*a3*b1*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*(1 - 3*Power(q3,2) - 2*q1*q3*(-3 + Power(q3,2)) + Power(q1,2)*(-1 + 3*Power(q3,2)))*Power(qdot3,2) + 4*a1*b3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*(1 - 3*Power(q3,2) - 2*q1*q3*(-3 + Power(q3,2)) + Power(q1,2)*(-1 + 3*Power(q3,2)))*Power(qdot3,2)))/((-2*(1 + Power(q3,2)) - 6*Power(q1,2)*(1 + Power(q3,2)) - 6*Power(q1,4)*(1 + Power(q3,2)) - 2*Power(q1,6)*(1 + Power(q3,2)) - 6*Power(q2,2)*(1 + Power(q3,2)) - 18*Power(q1,2)*Power(q2,2)*(1 + Power(q3,2)) - 18*Power(q1,4)*Power(q2,2)*(1 + Power(q3,2)) - 6*Power(q1,6)*Power(q2,2)*(1 + Power(q3,2)) - 6*Power(q2,4)*(1 + Power(q3,2)) - 18*Power(q1,2)*Power(q2,4)*(1 + Power(q3,2)) - 18*Power(q1,4)*Power(q2,4)*(1 + Power(q3,2)) - 6*Power(q1,6)*Power(q2,4)*(1 + Power(q3,2)) - 2*Power(q2,6)*(1 + Power(q3,2)) - 6*Power(q1,2)*Power(q2,6)*(1 + Power(q3,2)) - 6*Power(q1,4)*Power(q2,6)*(1 + Power(q3,2)) - 2*Power(q1,6)*Power(q2,6)*(1 + Power(q3,2)))*(-4*a1*a2*(1 + Power(q1,2))*Power(1 + Power(q3,2),3) - 4*b1*b2*(1 + Power(q1,2))*Power(1 + Power(q3,2),3) + 4*a1*a2*Power(q1,2)*(1 + Power(q1,2))*Power(1 + Power(q3,2),3) + 4*b1*b2*Power(q1,2)*(1 + Power(q1,2))*Power(1 + Power(q3,2),3) + 4*a1*a2*(1 + Power(q1,2))*Power(q2,4)*Power(1 + Power(q3,2),3) + 4*b1*b2*(1 + Power(q1,2))*Power(q2,4)*Power(1 + Power(q3,2),3) - 4*a1*a2*Power(q1,2)*(1 + Power(q1,2))*Power(q2,4)*Power(1 + Power(q3,2),3) - 4*b1*b2*Power(q1,2)*(1 + Power(q1,2))*Power(q2,4)*Power(1 + Power(q3,2),3) - 16*a1*a2*q1*(1 + Power(q1,2))*q2*(1 + Power(q2,2))*Power(1 + Power(q3,2),3) - 16*b1*b2*q1*(1 + Power(q1,2))*q2*(1 + Power(q2,2))*Power(1 + Power(q3,2),3) - 8*a2*b1*(1 + Power(q1,2))*(1 + Power(q2,2))*(q2 - Power(q1,2)*q2 + q1*(-1 + Power(q2,2)))*Power(1 + Power(q3,2),3) + 8*a1*b2*(1 + Power(q1,2))*(1 + Power(q2,2))*(q2 - Power(q1,2)*q2 + q1*(-1 + Power(q2,2)))*Power(1 + Power(q3,2),3)) - (-2*a1*a3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3) - 2*b1*b3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3) + 2*a1*a3*Power(q1,2)*(1 + Power(q1,2))*Power(1 + Power(q2,2),3) + 2*b1*b3*Power(q1,2)*(1 + Power(q1,2))*Power(1 + Power(q2,2),3) + 2*a1*a3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*Power(q3,4) + 2*b1*b3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*Power(q3,4) - 2*a1*a3*Power(q1,2)*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*Power(q3,4) - 2*b1*b3*Power(q1,2)*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*Power(q3,4) - 8*a1*a3*q1*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*q3*(1 + Power(q3,2)) - 8*b1*b3*q1*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*q3*(1 + Power(q3,2)) - 4*a3*b1*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*(1 + Power(q3,2))*(q3 - Power(q1,2)*q3 + q1*(-1 + Power(q3,2))) + 4*a1*b3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*(1 + Power(q3,2))*(q3 - Power(q1,2)*q3 + q1*(-1 + Power(q3,2))))*(-2*a2*a3*Power(1 + Power(q1,2),3)*(1 + Power(q3,2)) - 2*b2*b3*Power(1 + Power(q1,2),3)*(1 + Power(q3,2)) - 8*a2*a3*Power(1 + Power(q1,2),3)*q2*q3*(1 + Power(q3,2)) - 8*b2*b3*Power(1 + Power(q1,2),3)*q2*q3*(1 + Power(q3,2)) - 8*a2*a3*Power(1 + Power(q1,2),3)*Power(q2,3)*q3*(1 + Power(q3,2)) - 8*b2*b3*Power(1 + Power(q1,2),3)*Power(q2,3)*q3*(1 + Power(q3,2)) + 2*a2*a3*Power(1 + Power(q1,2),3)*Power(q3,2)*(1 + Power(q3,2)) + 2*b2*b3*Power(1 + Power(q1,2),3)*Power(q3,2)*(1 + Power(q3,2)) - 2*a2*a3*Power(1 + Power(q1,2),3)*Power(q2,4)*(-1 + Power(q3,2))*(1 + Power(q3,2)) - 2*b2*b3*Power(1 + Power(q1,2),3)*Power(q2,4)*(-1 + Power(q3,2))*(1 + Power(q3,2)) + 4*a3*b2*Power(1 + Power(q1,2),3)*(1 + Power(q2,2))*(1 + Power(q3,2))*(-q3 + Power(q2,2)*q3 - q2*(-1 + Power(q3,2))) - 4*a2*b3*Power(1 + Power(q1,2),3)*(1 + Power(q2,2))*(1 + Power(q3,2))*(-q3 + Power(q2,2)*q3 - q2*(-1 + Power(q3,2)))))) + (((-6*(1 + Power(q1,2)) - 18*(1 + Power(q1,2))*Power(q2,2) - 18*(1 + Power(q1,2))*Power(q2,4) - 6*(1 + Power(q1,2))*Power(q2,6) - 18*(1 + Power(q1,2))*Power(q3,2) - 54*(1 + Power(q1,2))*Power(q2,2)*Power(q3,2) - 54*(1 + Power(q1,2))*Power(q2,4)*Power(q3,2) - 18*(1 + Power(q1,2))*Power(q2,6)*Power(q3,2) - 18*(1 + Power(q1,2))*Power(q3,4) - 54*(1 + Power(q1,2))*Power(q2,2)*Power(q3,4) - 54*(1 + Power(q1,2))*Power(q2,4)*Power(q3,4) - 18*(1 + Power(q1,2))*Power(q2,6)*Power(q3,4) - 6*(1 + Power(q1,2))*Power(q3,6) - 18*(1 + Power(q1,2))*Power(q2,2)*Power(q3,6) - 18*(1 + Power(q1,2))*Power(q2,4)*Power(q3,6) - 6*(1 + Power(q1,2))*Power(q2,6)*Power(q3,6))*(-2*(1 + Power(q3,2)) - 6*Power(q1,2)*(1 + Power(q3,2)) - 6*Power(q1,4)*(1 + Power(q3,2)) - 2*Power(q1,6)*(1 + Power(q3,2)) - 6*Power(q2,2)*(1 + Power(q3,2)) - 18*Power(q1,2)*Power(q2,2)*(1 + Power(q3,2)) - 18*Power(q1,4)*Power(q2,2)*(1 + Power(q3,2)) - 6*Power(q1,6)*Power(q2,2)*(1 + Power(q3,2)) - 6*Power(q2,4)*(1 + Power(q3,2)) - 18*Power(q1,2)*Power(q2,4)*(1 + Power(q3,2)) - 18*Power(q1,4)*Power(q2,4)*(1 + Power(q3,2)) - 6*Power(q1,6)*Power(q2,4)*(1 + Power(q3,2)) - 2*Power(q2,6)*(1 + Power(q3,2)) - 6*Power(q1,2)*Power(q2,6)*(1 + Power(q3,2)) - 6*Power(q1,4)*Power(q2,6)*(1 + Power(q3,2)) - 2*Power(q1,6)*Power(q2,6)*(1 + Power(q3,2))) - (-2*a1*a3*Power(1 + Power(q2,2),3)*(1 + Power(q3,2)) - 2*b1*b3*Power(1 + Power(q2,2),3)*(1 + Power(q3,2)) - 8*a1*a3*q1*Power(1 + Power(q2,2),3)*q3*(1 + Power(q3,2)) - 8*b1*b3*q1*Power(1 + Power(q2,2),3)*q3*(1 + Power(q3,2)) - 8*a1*a3*Power(q1,3)*Power(1 + Power(q2,2),3)*q3*(1 + Power(q3,2)) - 8*b1*b3*Power(q1,3)*Power(1 + Power(q2,2),3)*q3*(1 + Power(q3,2)) + 2*a1*a3*Power(1 + Power(q2,2),3)*Power(q3,2)*(1 + Power(q3,2)) + 2*b1*b3*Power(1 + Power(q2,2),3)*Power(q3,2)*(1 + Power(q3,2)) - 2*a1*a3*Power(q1,4)*Power(1 + Power(q2,2),3)*(-1 + Power(q3,2))*(1 + Power(q3,2)) - 2*b1*b3*Power(q1,4)*Power(1 + Power(q2,2),3)*(-1 + Power(q3,2))*(1 + Power(q3,2)) + 4*a3*b1*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*(1 + Power(q3,2))*(-q3 + Power(q1,2)*q3 - q1*(-1 + Power(q3,2))) - 4*a1*b3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*(1 + Power(q3,2))*(-q3 + Power(q1,2)*q3 - q1*(-1 + Power(q3,2))))*(-2*a1*a3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3) - 2*b1*b3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3) + 2*a1*a3*Power(q1,2)*(1 + Power(q1,2))*Power(1 + Power(q2,2),3) + 2*b1*b3*Power(q1,2)*(1 + Power(q1,2))*Power(1 + Power(q2,2),3) + 2*a1*a3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*Power(q3,4) + 2*b1*b3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*Power(q3,4) - 2*a1*a3*Power(q1,2)*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*Power(q3,4) - 2*b1*b3*Power(q1,2)*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*Power(q3,4) - 8*a1*a3*q1*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*q3*(1 + Power(q3,2)) - 8*b1*b3*q1*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*q3*(1 + Power(q3,2)) - 4*a3*b1*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*(1 + Power(q3,2))*(q3 - Power(q1,2)*q3 + q1*(-1 + Power(q3,2))) + 4*a1*b3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*(1 + Power(q3,2))*(q3 - Power(q1,2)*q3 + q1*(-1 + Power(q3,2)))))*(-(((-2*(1 + Power(q2,2)) - 6*Power(q1,2)*(1 + Power(q2,2)) - 6*Power(q1,4)*(1 + Power(q2,2)) - 2*Power(q1,6)*(1 + Power(q2,2)) - 6*(1 + Power(q2,2))*Power(q3,2) - 18*Power(q1,2)*(1 + Power(q2,2))*Power(q3,2) - 18*Power(q1,4)*(1 + Power(q2,2))*Power(q3,2) - 6*Power(q1,6)*(1 + Power(q2,2))*Power(q3,2) - 6*(1 + Power(q2,2))*Power(q3,4) - 18*Power(q1,2)*(1 + Power(q2,2))*Power(q3,4) - 18*Power(q1,4)*(1 + Power(q2,2))*Power(q3,4) - 6*Power(q1,6)*(1 + Power(q2,2))*Power(q3,4) - 2*(1 + Power(q2,2))*Power(q3,6) - 6*Power(q1,2)*(1 + Power(q2,2))*Power(q3,6) - 6*Power(q1,4)*(1 + Power(q2,2))*Power(q3,6) - 2*Power(q1,6)*(1 + Power(q2,2))*Power(q3,6))*(-2*(1 + Power(q3,2)) - 6*Power(q1,2)*(1 + Power(q3,2)) - 6*Power(q1,4)*(1 + Power(q3,2)) - 2*Power(q1,6)*(1 + Power(q3,2)) - 6*Power(q2,2)*(1 + Power(q3,2)) - 18*Power(q1,2)*Power(q2,2)*(1 + Power(q3,2)) - 18*Power(q1,4)*Power(q2,2)*(1 + Power(q3,2)) - 6*Power(q1,6)*Power(q2,2)*(1 + Power(q3,2)) - 6*Power(q2,4)*(1 + Power(q3,2)) - 18*Power(q1,2)*Power(q2,4)*(1 + Power(q3,2)) - 18*Power(q1,4)*Power(q2,4)*(1 + Power(q3,2)) - 6*Power(q1,6)*Power(q2,4)*(1 + Power(q3,2)) - 2*Power(q2,6)*(1 + Power(q3,2)) - 6*Power(q1,2)*Power(q2,6)*(1 + Power(q3,2)) - 6*Power(q1,4)*Power(q2,6)*(1 + Power(q3,2)) - 2*Power(q1,6)*Power(q2,6)*(1 + Power(q3,2))) - (-2*a2*a3*Power(1 + Power(q1,2),3)*(1 + Power(q3,2)) - 2*b2*b3*Power(1 + Power(q1,2),3)*(1 + Power(q3,2)) - 8*a2*a3*Power(1 + Power(q1,2),3)*q2*q3*(1 + Power(q3,2)) - 8*b2*b3*Power(1 + Power(q1,2),3)*q2*q3*(1 + Power(q3,2)) - 8*a2*a3*Power(1 + Power(q1,2),3)*Power(q2,3)*q3*(1 + Power(q3,2)) - 8*b2*b3*Power(1 + Power(q1,2),3)*Power(q2,3)*q3*(1 + Power(q3,2)) + 2*a2*a3*Power(1 + Power(q1,2),3)*Power(q3,2)*(1 + Power(q3,2)) + 2*b2*b3*Power(1 + Power(q1,2),3)*Power(q3,2)*(1 + Power(q3,2)) - 2*a2*a3*Power(1 + Power(q1,2),3)*Power(q2,4)*(-1 + Power(q3,2))*(1 + Power(q3,2)) - 2*b2*b3*Power(1 + Power(q1,2),3)*Power(q2,4)*(-1 + Power(q3,2))*(1 + Power(q3,2)) + 4*a3*b2*Power(1 + Power(q1,2),3)*(1 + Power(q2,2))*(1 + Power(q3,2))*(-q3 + Power(q2,2)*q3 - q2*(-1 + Power(q3,2))) - 4*a2*b3*Power(1 + Power(q1,2),3)*(1 + Power(q2,2))*(1 + Power(q3,2))*(-q3 + Power(q2,2)*q3 - q2*(-1 + Power(q3,2))))*(-(a2*a3*Power(1 + Power(q1,2),3)*(1 + Power(q2,2))) - b2*b3*Power(1 + Power(q1,2),3)*(1 + Power(q2,2)) + a2*a3*Power(1 + Power(q1,2),3)*Power(q2,2)*(1 + Power(q2,2)) + b2*b3*Power(1 + Power(q1,2),3)*Power(q2,2)*(1 + Power(q2,2)) + a2*a3*Power(1 + Power(q1,2),3)*(1 + Power(q2,2))*Power(q3,4) + b2*b3*Power(1 + Power(q1,2),3)*(1 + Power(q2,2))*Power(q3,4) - a2*a3*Power(1 + Power(q1,2),3)*Power(q2,2)*(1 + Power(q2,2))*Power(q3,4) - b2*b3*Power(1 + Power(q1,2),3)*Power(q2,2)*(1 + Power(q2,2))*Power(q3,4) - 4*a2*a3*Power(1 + Power(q1,2),3)*q2*(1 + Power(q2,2))*q3*(1 + Power(q3,2)) - 4*b2*b3*Power(1 + Power(q1,2),3)*q2*(1 + Power(q2,2))*q3*(1 + Power(q3,2)) - 2*a3*b2*Power(1 + Power(q1,2),3)*(1 + Power(q2,2))*(1 + Power(q3,2))*(q3 - Power(q2,2)*q3 + q2*(-1 + Power(q3,2))) + 2*a2*b3*Power(1 + Power(q1,2),3)*(1 + Power(q2,2))*(1 + Power(q3,2))*(q3 - Power(q2,2)*q3 + q2*(-1 + Power(q3,2)))))*(-((-2*a1*a3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3) - 2*b1*b3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3) + 2*a1*a3*Power(q1,2)*(1 + Power(q1,2))*Power(1 + Power(q2,2),3) + 2*b1*b3*Power(q1,2)*(1 + Power(q1,2))*Power(1 + Power(q2,2),3) + 2*a1*a3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*Power(q3,4) + 2*b1*b3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*Power(q3,4) - 2*a1*a3*Power(q1,2)*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*Power(q3,4) - 2*b1*b3*Power(q1,2)*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*Power(q3,4) - 8*a1*a3*q1*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*q3*(1 + Power(q3,2)) - 8*b1*b3*q1*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*q3*(1 + Power(q3,2)) - 4*a3*b1*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*(1 + Power(q3,2))*(q3 - Power(q1,2)*q3 + q1*(-1 + Power(q3,2))) + 4*a1*b3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*(1 + Power(q3,2))*(q3 - Power(q1,2)*q3 + q1*(-1 + Power(q3,2))))*(2*b3*Power(1 + Power(q1,2),3)*Power(1 + Power(q2,2),3)*q3*(1 + Power(q3,2)) + a3*Power(1 + Power(q1,2),3)*Power(1 + Power(q2,2),3)*(-1 + Power(q3,4)) - 8*a1*a3*Power(1 + Power(q2,2),3)*q3*(1 + Power(q3,2))*Power(qdot1,2) - 8*b1*b3*Power(1 + Power(q2,2),3)*q3*(1 + Power(q3,2))*Power(qdot1,2) + 24*a1*a3*Power(q1,2)*Power(1 + Power(q2,2),3)*q3*(1 + Power(q3,2))*Power(qdot1,2) + 24*b1*b3*Power(q1,2)*Power(1 + Power(q2,2),3)*q3*(1 + Power(q3,2))*Power(qdot1,2) - 12*a1*a3*q1*Power(1 + Power(q2,2),3)*(-1 + Power(q3,2))*(1 + Power(q3,2))*Power(qdot1,2) - 12*b1*b3*q1*Power(1 + Power(q2,2),3)*(-1 + Power(q3,2))*(1 + Power(q3,2))*Power(qdot1,2) + 4*a1*a3*Power(q1,3)*Power(1 + Power(q2,2),3)*(-1 + Power(q3,2))*(1 + Power(q3,2))*Power(qdot1,2) + 4*b1*b3*Power(q1,3)*Power(1 + Power(q2,2),3)*(-1 + Power(q3,2))*(1 + Power(q3,2))*Power(qdot1,2) - 4*a3*b1*Power(1 + Power(q2,2),3)*(1 + Power(q3,2))*(-1 - 6*q1*q3 + 2*Power(q1,3)*q3 + Power(q3,2) - 3*Power(q1,2)*(-1 + Power(q3,2)))*Power(qdot1,2) + 4*a1*b3*Power(1 + Power(q2,2),3)*(1 + Power(q3,2))*(-1 - 6*q1*q3 + 2*Power(q1,3)*q3 + Power(q3,2) - 3*Power(q1,2)*(-1 + Power(q3,2)))*Power(qdot1,2) - 8*a2*a3*Power(1 + Power(q1,2),3)*q3*(1 + Power(q3,2))*Power(qdot2,2) - 8*b2*b3*Power(1 + Power(q1,2),3)*q3*(1 + Power(q3,2))*Power(qdot2,2) + 24*a2*a3*Power(1 + Power(q1,2),3)*Power(q2,2)*q3*(1 + Power(q3,2))*Power(qdot2,2) + 24*b2*b3*Power(1 + Power(q1,2),3)*Power(q2,2)*q3*(1 + Power(q3,2))*Power(qdot2,2) - 12*a2*a3*Power(1 + Power(q1,2),3)*q2*(-1 + Power(q3,2))*(1 + Power(q3,2))*Power(qdot2,2) - 12*b2*b3*Power(1 + Power(q1,2),3)*q2*(-1 + Power(q3,2))*(1 + Power(q3,2))*Power(qdot2,2) + 4*a2*a3*Power(1 + Power(q1,2),3)*Power(q2,3)*(-1 + Power(q3,2))*(1 + Power(q3,2))*Power(qdot2,2) + 4*b2*b3*Power(1 + Power(q1,2),3)*Power(q2,3)*(-1 + Power(q3,2))*(1 + Power(q3,2))*Power(qdot2,2) - 4*a3*b2*Power(1 + Power(q1,2),3)*(1 + Power(q3,2))*(-1 - 6*q2*q3 + 2*Power(q2,3)*q3 + Power(q3,2) - 3*Power(q2,2)*(-1 + Power(q3,2)))*Power(qdot2,2) + 4*a2*b3*Power(1 + Power(q1,2),3)*(1 + Power(q3,2))*(-1 - 6*q2*q3 + 2*Power(q2,3)*q3 + Power(q3,2) - 3*Power(q2,2)*(-1 + Power(q3,2)))*Power(qdot2,2) + 4*q3*Power(qdot3,2) + 12*Power(q1,2)*q3*Power(qdot3,2) + 12*Power(q1,4)*q3*Power(qdot3,2) + 4*Power(q1,6)*q3*Power(qdot3,2) + 12*Power(q2,2)*q3*Power(qdot3,2) + 36*Power(q1,2)*Power(q2,2)*q3*Power(qdot3,2) + 36*Power(q1,4)*Power(q2,2)*q3*Power(qdot3,2) + 12*Power(q1,6)*Power(q2,2)*q3*Power(qdot3,2) + 12*Power(q2,4)*q3*Power(qdot3,2) + 36*Power(q1,2)*Power(q2,4)*q3*Power(qdot3,2) + 36*Power(q1,4)*Power(q2,4)*q3*Power(qdot3,2) + 12*Power(q1,6)*Power(q2,4)*q3*Power(qdot3,2) + 4*Power(q2,6)*q3*Power(qdot3,2) + 12*Power(q1,2)*Power(q2,6)*q3*Power(qdot3,2) + 12*Power(q1,4)*Power(q2,6)*q3*Power(qdot3,2) + 4*Power(q1,6)*Power(q2,6)*q3*Power(qdot3,2))) + (-2*(1 + Power(q3,2)) - 6*Power(q1,2)*(1 + Power(q3,2)) - 6*Power(q1,4)*(1 + Power(q3,2)) - 2*Power(q1,6)*(1 + Power(q3,2)) - 6*Power(q2,2)*(1 + Power(q3,2)) - 18*Power(q1,2)*Power(q2,2)*(1 + Power(q3,2)) - 18*Power(q1,4)*Power(q2,2)*(1 + Power(q3,2)) - 6*Power(q1,6)*Power(q2,2)*(1 + Power(q3,2)) - 6*Power(q2,4)*(1 + Power(q3,2)) - 18*Power(q1,2)*Power(q2,4)*(1 + Power(q3,2)) - 18*Power(q1,4)*Power(q2,4)*(1 + Power(q3,2)) - 6*Power(q1,6)*Power(q2,4)*(1 + Power(q3,2)) - 2*Power(q2,6)*(1 + Power(q3,2)) - 6*Power(q1,2)*Power(q2,6)*(1 + Power(q3,2)) - 6*Power(q1,4)*Power(q2,6)*(1 + Power(q3,2)) - 2*Power(q1,6)*Power(q2,6)*(1 + Power(q3,2)))*(6*b1*q1*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*Power(1 + Power(q3,2),3) + 3*a1*(-1 + Power(q1,4))*Power(1 + Power(q2,2),3)*Power(1 + Power(q3,2),3) + 12*q1*Power(qdot1,2) + 36*q1*Power(q2,2)*Power(qdot1,2) + 36*q1*Power(q2,4)*Power(qdot1,2) + 12*q1*Power(q2,6)*Power(qdot1,2) + 36*q1*Power(q3,2)*Power(qdot1,2) + 108*q1*Power(q2,2)*Power(q3,2)*Power(qdot1,2) + 108*q1*Power(q2,4)*Power(q3,2)*Power(qdot1,2) + 36*q1*Power(q2,6)*Power(q3,2)*Power(qdot1,2) + 36*q1*Power(q3,4)*Power(qdot1,2) + 108*q1*Power(q2,2)*Power(q3,4)*Power(qdot1,2) + 108*q1*Power(q2,4)*Power(q3,4)*Power(qdot1,2) + 36*q1*Power(q2,6)*Power(q3,4)*Power(qdot1,2) + 12*q1*Power(q3,6)*Power(qdot1,2) + 36*q1*Power(q2,2)*Power(q3,6)*Power(qdot1,2) + 36*q1*Power(q2,4)*Power(q3,6)*Power(qdot1,2) + 12*q1*Power(q2,6)*Power(q3,6)*Power(qdot1,2) + 24*a1*a2*(1 + Power(q1,2))*q2*Power(1 + Power(q3,2),3)*Power(qdot2,2) + 24*b1*b2*(1 + Power(q1,2))*q2*Power(1 + Power(q3,2),3)*Power(qdot2,2) - 24*a1*a2*Power(q1,2)*(1 + Power(q1,2))*q2*Power(1 + Power(q3,2),3)*Power(qdot2,2) - 24*b1*b2*Power(q1,2)*(1 + Power(q1,2))*q2*Power(1 + Power(q3,2),3)*Power(qdot2,2) - 8*a1*a2*(1 + Power(q1,2))*Power(q2,3)*Power(1 + Power(q3,2),3)*Power(qdot2,2) - 8*b1*b2*(1 + Power(q1,2))*Power(q2,3)*Power(1 + Power(q3,2),3)*Power(qdot2,2) + 8*a1*a2*Power(q1,2)*(1 + Power(q1,2))*Power(q2,3)*Power(1 + Power(q3,2),3)*Power(qdot2,2) + 8*b1*b2*Power(q1,2)*(1 + Power(q1,2))*Power(q2,3)*Power(1 + Power(q3,2),3)*Power(qdot2,2) + 16*a1*a2*q1*(1 + Power(q1,2))*(-1 + 3*Power(q2,2))*Power(1 + Power(q3,2),3)*Power(qdot2,2) + 16*b1*b2*q1*(1 + Power(q1,2))*(-1 + 3*Power(q2,2))*Power(1 + Power(q3,2),3)*Power(qdot2,2) - 8*a2*b1*(1 + Power(q1,2))*(1 - 3*Power(q2,2) - 2*q1*q2*(-3 + Power(q2,2)) + Power(q1,2)*(-1 + 3*Power(q2,2)))*Power(1 + Power(q3,2),3)*Power(qdot2,2) + 8*a1*b2*(1 + Power(q1,2))*(1 - 3*Power(q2,2) - 2*q1*q2*(-3 + Power(q2,2)) + Power(q1,2)*(-1 + 3*Power(q2,2)))*Power(1 + Power(q3,2),3)*Power(qdot2,2) + 12*a1*a3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*q3*Power(qdot3,2) + 12*b1*b3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*q3*Power(qdot3,2) - 12*a1*a3*Power(q1,2)*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*q3*Power(qdot3,2) - 12*b1*b3*Power(q1,2)*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*q3*Power(qdot3,2) - 4*a1*a3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*Power(q3,3)*Power(qdot3,2) - 4*b1*b3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*Power(q3,3)*Power(qdot3,2) + 4*a1*a3*Power(q1,2)*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*Power(q3,3)*Power(qdot3,2) + 4*b1*b3*Power(q1,2)*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*Power(q3,3)*Power(qdot3,2) + 8*a1*a3*q1*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*(-1 + 3*Power(q3,2))*Power(qdot3,2) + 8*b1*b3*q1*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*(-1 + 3*Power(q3,2))*Power(qdot3,2) - 4*a3*b1*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*(1 - 3*Power(q3,2) - 2*q1*q3*(-3 + Power(q3,2)) + Power(q1,2)*(-1 + 3*Power(q3,2)))*Power(qdot3,2) + 4*a1*b3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*(1 - 3*Power(q3,2) - 2*q1*q3*(-3 + Power(q3,2)) + Power(q1,2)*(-1 + 3*Power(q3,2)))*Power(qdot3,2)))) + ((-2*(1 + Power(q3,2)) - 6*Power(q1,2)*(1 + Power(q3,2)) - 6*Power(q1,4)*(1 + Power(q3,2)) - 2*Power(q1,6)*(1 + Power(q3,2)) - 6*Power(q2,2)*(1 + Power(q3,2)) - 18*Power(q1,2)*Power(q2,2)*(1 + Power(q3,2)) - 18*Power(q1,4)*Power(q2,2)*(1 + Power(q3,2)) - 6*Power(q1,6)*Power(q2,2)*(1 + Power(q3,2)) - 6*Power(q2,4)*(1 + Power(q3,2)) - 18*Power(q1,2)*Power(q2,4)*(1 + Power(q3,2)) - 18*Power(q1,4)*Power(q2,4)*(1 + Power(q3,2)) - 6*Power(q1,6)*Power(q2,4)*(1 + Power(q3,2)) - 2*Power(q2,6)*(1 + Power(q3,2)) - 6*Power(q1,2)*Power(q2,6)*(1 + Power(q3,2)) - 6*Power(q1,4)*Power(q2,6)*(1 + Power(q3,2)) - 2*Power(q1,6)*Power(q2,6)*(1 + Power(q3,2)))*(-4*a1*a2*(1 + Power(q1,2))*Power(1 + Power(q3,2),3) - 4*b1*b2*(1 + Power(q1,2))*Power(1 + Power(q3,2),3) + 4*a1*a2*Power(q1,2)*(1 + Power(q1,2))*Power(1 + Power(q3,2),3) + 4*b1*b2*Power(q1,2)*(1 + Power(q1,2))*Power(1 + Power(q3,2),3) + 4*a1*a2*(1 + Power(q1,2))*Power(q2,4)*Power(1 + Power(q3,2),3) + 4*b1*b2*(1 + Power(q1,2))*Power(q2,4)*Power(1 + Power(q3,2),3) - 4*a1*a2*Power(q1,2)*(1 + Power(q1,2))*Power(q2,4)*Power(1 + Power(q3,2),3) - 4*b1*b2*Power(q1,2)*(1 + Power(q1,2))*Power(q2,4)*Power(1 + Power(q3,2),3) - 16*a1*a2*q1*(1 + Power(q1,2))*q2*(1 + Power(q2,2))*Power(1 + Power(q3,2),3) - 16*b1*b2*q1*(1 + Power(q1,2))*q2*(1 + Power(q2,2))*Power(1 + Power(q3,2),3) - 8*a2*b1*(1 + Power(q1,2))*(1 + Power(q2,2))*(q2 - Power(q1,2)*q2 + q1*(-1 + Power(q2,2)))*Power(1 + Power(q3,2),3) + 8*a1*b2*(1 + Power(q1,2))*(1 + Power(q2,2))*(q2 - Power(q1,2)*q2 + q1*(-1 + Power(q2,2)))*Power(1 + Power(q3,2),3)) - (-2*a1*a3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3) - 2*b1*b3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3) + 2*a1*a3*Power(q1,2)*(1 + Power(q1,2))*Power(1 + Power(q2,2),3) + 2*b1*b3*Power(q1,2)*(1 + Power(q1,2))*Power(1 + Power(q2,2),3) + 2*a1*a3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*Power(q3,4) + 2*b1*b3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*Power(q3,4) - 2*a1*a3*Power(q1,2)*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*Power(q3,4) - 2*b1*b3*Power(q1,2)*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*Power(q3,4) - 8*a1*a3*q1*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*q3*(1 + Power(q3,2)) - 8*b1*b3*q1*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*q3*(1 + Power(q3,2)) - 4*a3*b1*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*(1 + Power(q3,2))*(q3 - Power(q1,2)*q3 + q1*(-1 + Power(q3,2))) + 4*a1*b3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*(1 + Power(q3,2))*(q3 - Power(q1,2)*q3 + q1*(-1 + Power(q3,2))))*(-2*a2*a3*Power(1 + Power(q1,2),3)*(1 + Power(q3,2)) - 2*b2*b3*Power(1 + Power(q1,2),3)*(1 + Power(q3,2)) - 8*a2*a3*Power(1 + Power(q1,2),3)*q2*q3*(1 + Power(q3,2)) - 8*b2*b3*Power(1 + Power(q1,2),3)*q2*q3*(1 + Power(q3,2)) - 8*a2*a3*Power(1 + Power(q1,2),3)*Power(q2,3)*q3*(1 + Power(q3,2)) - 8*b2*b3*Power(1 + Power(q1,2),3)*Power(q2,3)*q3*(1 + Power(q3,2)) + 2*a2*a3*Power(1 + Power(q1,2),3)*Power(q3,2)*(1 + Power(q3,2)) + 2*b2*b3*Power(1 + Power(q1,2),3)*Power(q3,2)*(1 + Power(q3,2)) - 2*a2*a3*Power(1 + Power(q1,2),3)*Power(q2,4)*(-1 + Power(q3,2))*(1 + Power(q3,2)) - 2*b2*b3*Power(1 + Power(q1,2),3)*Power(q2,4)*(-1 + Power(q3,2))*(1 + Power(q3,2)) + 4*a3*b2*Power(1 + Power(q1,2),3)*(1 + Power(q2,2))*(1 + Power(q3,2))*(-q3 + Power(q2,2)*q3 - q2*(-1 + Power(q3,2))) - 4*a2*b3*Power(1 + Power(q1,2),3)*(1 + Power(q2,2))*(1 + Power(q3,2))*(-q3 + Power(q2,2)*q3 - q2*(-1 + Power(q3,2)))))*(-((-(a2*a3*Power(1 + Power(q1,2),3)*(1 + Power(q2,2))) - b2*b3*Power(1 + Power(q1,2),3)*(1 + Power(q2,2)) + a2*a3*Power(1 + Power(q1,2),3)*Power(q2,2)*(1 + Power(q2,2)) + b2*b3*Power(1 + Power(q1,2),3)*Power(q2,2)*(1 + Power(q2,2)) + a2*a3*Power(1 + Power(q1,2),3)*(1 + Power(q2,2))*Power(q3,4) + b2*b3*Power(1 + Power(q1,2),3)*(1 + Power(q2,2))*Power(q3,4) - a2*a3*Power(1 + Power(q1,2),3)*Power(q2,2)*(1 + Power(q2,2))*Power(q3,4) - b2*b3*Power(1 + Power(q1,2),3)*Power(q2,2)*(1 + Power(q2,2))*Power(q3,4) - 4*a2*a3*Power(1 + Power(q1,2),3)*q2*(1 + Power(q2,2))*q3*(1 + Power(q3,2)) - 4*b2*b3*Power(1 + Power(q1,2),3)*q2*(1 + Power(q2,2))*q3*(1 + Power(q3,2)) - 2*a3*b2*Power(1 + Power(q1,2),3)*(1 + Power(q2,2))*(1 + Power(q3,2))*(q3 - Power(q2,2)*q3 + q2*(-1 + Power(q3,2))) + 2*a2*b3*Power(1 + Power(q1,2),3)*(1 + Power(q2,2))*(1 + Power(q3,2))*(q3 - Power(q2,2)*q3 + q2*(-1 + Power(q3,2))))*(2*b3*Power(1 + Power(q1,2),3)*Power(1 + Power(q2,2),3)*q3*(1 + Power(q3,2)) + a3*Power(1 + Power(q1,2),3)*Power(1 + Power(q2,2),3)*(-1 + Power(q3,4)) - 8*a1*a3*Power(1 + Power(q2,2),3)*q3*(1 + Power(q3,2))*Power(qdot1,2) - 8*b1*b3*Power(1 + Power(q2,2),3)*q3*(1 + Power(q3,2))*Power(qdot1,2) + 24*a1*a3*Power(q1,2)*Power(1 + Power(q2,2),3)*q3*(1 + Power(q3,2))*Power(qdot1,2) + 24*b1*b3*Power(q1,2)*Power(1 + Power(q2,2),3)*q3*(1 + Power(q3,2))*Power(qdot1,2) - 12*a1*a3*q1*Power(1 + Power(q2,2),3)*(-1 + Power(q3,2))*(1 + Power(q3,2))*Power(qdot1,2) - 12*b1*b3*q1*Power(1 + Power(q2,2),3)*(-1 + Power(q3,2))*(1 + Power(q3,2))*Power(qdot1,2) + 4*a1*a3*Power(q1,3)*Power(1 + Power(q2,2),3)*(-1 + Power(q3,2))*(1 + Power(q3,2))*Power(qdot1,2) + 4*b1*b3*Power(q1,3)*Power(1 + Power(q2,2),3)*(-1 + Power(q3,2))*(1 + Power(q3,2))*Power(qdot1,2) - 4*a3*b1*Power(1 + Power(q2,2),3)*(1 + Power(q3,2))*(-1 - 6*q1*q3 + 2*Power(q1,3)*q3 + Power(q3,2) - 3*Power(q1,2)*(-1 + Power(q3,2)))*Power(qdot1,2) + 4*a1*b3*Power(1 + Power(q2,2),3)*(1 + Power(q3,2))*(-1 - 6*q1*q3 + 2*Power(q1,3)*q3 + Power(q3,2) - 3*Power(q1,2)*(-1 + Power(q3,2)))*Power(qdot1,2) - 8*a2*a3*Power(1 + Power(q1,2),3)*q3*(1 + Power(q3,2))*Power(qdot2,2) - 8*b2*b3*Power(1 + Power(q1,2),3)*q3*(1 + Power(q3,2))*Power(qdot2,2) + 24*a2*a3*Power(1 + Power(q1,2),3)*Power(q2,2)*q3*(1 + Power(q3,2))*Power(qdot2,2) + 24*b2*b3*Power(1 + Power(q1,2),3)*Power(q2,2)*q3*(1 + Power(q3,2))*Power(qdot2,2) - 12*a2*a3*Power(1 + Power(q1,2),3)*q2*(-1 + Power(q3,2))*(1 + Power(q3,2))*Power(qdot2,2) - 12*b2*b3*Power(1 + Power(q1,2),3)*q2*(-1 + Power(q3,2))*(1 + Power(q3,2))*Power(qdot2,2) + 4*a2*a3*Power(1 + Power(q1,2),3)*Power(q2,3)*(-1 + Power(q3,2))*(1 + Power(q3,2))*Power(qdot2,2) + 4*b2*b3*Power(1 + Power(q1,2),3)*Power(q2,3)*(-1 + Power(q3,2))*(1 + Power(q3,2))*Power(qdot2,2) - 4*a3*b2*Power(1 + Power(q1,2),3)*(1 + Power(q3,2))*(-1 - 6*q2*q3 + 2*Power(q2,3)*q3 + Power(q3,2) - 3*Power(q2,2)*(-1 + Power(q3,2)))*Power(qdot2,2) + 4*a2*b3*Power(1 + Power(q1,2),3)*(1 + Power(q3,2))*(-1 - 6*q2*q3 + 2*Power(q2,3)*q3 + Power(q3,2) - 3*Power(q2,2)*(-1 + Power(q3,2)))*Power(qdot2,2) + 4*q3*Power(qdot3,2) + 12*Power(q1,2)*q3*Power(qdot3,2) + 12*Power(q1,4)*q3*Power(qdot3,2) + 4*Power(q1,6)*q3*Power(qdot3,2) + 12*Power(q2,2)*q3*Power(qdot3,2) + 36*Power(q1,2)*Power(q2,2)*q3*Power(qdot3,2) + 36*Power(q1,4)*Power(q2,2)*q3*Power(qdot3,2) + 12*Power(q1,6)*Power(q2,2)*q3*Power(qdot3,2) + 12*Power(q2,4)*q3*Power(qdot3,2) + 36*Power(q1,2)*Power(q2,4)*q3*Power(qdot3,2) + 36*Power(q1,4)*Power(q2,4)*q3*Power(qdot3,2) + 12*Power(q1,6)*Power(q2,4)*q3*Power(qdot3,2) + 4*Power(q2,6)*q3*Power(qdot3,2) + 12*Power(q1,2)*Power(q2,6)*q3*Power(qdot3,2) + 12*Power(q1,4)*Power(q2,6)*q3*Power(qdot3,2) + 4*Power(q1,6)*Power(q2,6)*q3*Power(qdot3,2))) + (-2*(1 + Power(q3,2)) - 6*Power(q1,2)*(1 + Power(q3,2)) - 6*Power(q1,4)*(1 + Power(q3,2)) - 2*Power(q1,6)*(1 + Power(q3,2)) - 6*Power(q2,2)*(1 + Power(q3,2)) - 18*Power(q1,2)*Power(q2,2)*(1 + Power(q3,2)) - 18*Power(q1,4)*Power(q2,2)*(1 + Power(q3,2)) - 6*Power(q1,6)*Power(q2,2)*(1 + Power(q3,2)) - 6*Power(q2,4)*(1 + Power(q3,2)) - 18*Power(q1,2)*Power(q2,4)*(1 + Power(q3,2)) - 18*Power(q1,4)*Power(q2,4)*(1 + Power(q3,2)) - 6*Power(q1,6)*Power(q2,4)*(1 + Power(q3,2)) - 2*Power(q2,6)*(1 + Power(q3,2)) - 6*Power(q1,2)*Power(q2,6)*(1 + Power(q3,2)) - 6*Power(q1,4)*Power(q2,6)*(1 + Power(q3,2)) - 2*Power(q1,6)*Power(q2,6)*(1 + Power(q3,2)))*(2*b2*Power(1 + Power(q1,2),3)*q2*(1 + Power(q2,2))*Power(1 + Power(q3,2),3) + a2*Power(1 + Power(q1,2),3)*(-1 + Power(q2,4))*Power(1 + Power(q3,2),3) - 8*a1*a2*q2*(1 + Power(q2,2))*Power(1 + Power(q3,2),3)*Power(qdot1,2) - 8*b1*b2*q2*(1 + Power(q2,2))*Power(1 + Power(q3,2),3)*Power(qdot1,2) + 24*a1*a2*Power(q1,2)*q2*(1 + Power(q2,2))*Power(1 + Power(q3,2),3)*Power(qdot1,2) + 24*b1*b2*Power(q1,2)*q2*(1 + Power(q2,2))*Power(1 + Power(q3,2),3)*Power(qdot1,2) - 12*a1*a2*q1*(-1 + Power(q2,2))*(1 + Power(q2,2))*Power(1 + Power(q3,2),3)*Power(qdot1,2) - 12*b1*b2*q1*(-1 + Power(q2,2))*(1 + Power(q2,2))*Power(1 + Power(q3,2),3)*Power(qdot1,2) + 4*a1*a2*Power(q1,3)*(-1 + Power(q2,2))*(1 + Power(q2,2))*Power(1 + Power(q3,2),3)*Power(qdot1,2) + 4*b1*b2*Power(q1,3)*(-1 + Power(q2,2))*(1 + Power(q2,2))*Power(1 + Power(q3,2),3)*Power(qdot1,2) - 4*a2*b1*(1 + Power(q2,2))*(-1 - 6*q1*q2 + 2*Power(q1,3)*q2 + Power(q2,2) - 3*Power(q1,2)*(-1 + Power(q2,2)))*Power(1 + Power(q3,2),3)*Power(qdot1,2) + 4*a1*b2*(1 + Power(q2,2))*(-1 - 6*q1*q2 + 2*Power(q1,3)*q2 + Power(q2,2) - 3*Power(q1,2)*(-1 + Power(q2,2)))*Power(1 + Power(q3,2),3)*Power(qdot1,2) + 4*q2*Power(qdot2,2) + 12*Power(q1,2)*q2*Power(qdot2,2) + 12*Power(q1,4)*q2*Power(qdot2,2) + 4*Power(q1,6)*q2*Power(qdot2,2) + 12*q2*Power(q3,2)*Power(qdot2,2) + 36*Power(q1,2)*q2*Power(q3,2)*Power(qdot2,2) + 36*Power(q1,4)*q2*Power(q3,2)*Power(qdot2,2) + 12*Power(q1,6)*q2*Power(q3,2)*Power(qdot2,2) + 12*q2*Power(q3,4)*Power(qdot2,2) + 36*Power(q1,2)*q2*Power(q3,4)*Power(qdot2,2) + 36*Power(q1,4)*q2*Power(q3,4)*Power(qdot2,2) + 12*Power(q1,6)*q2*Power(q3,4)*Power(qdot2,2) + 4*q2*Power(q3,6)*Power(qdot2,2) + 12*Power(q1,2)*q2*Power(q3,6)*Power(qdot2,2) + 12*Power(q1,4)*q2*Power(q3,6)*Power(qdot2,2) + 4*Power(q1,6)*q2*Power(q3,6)*Power(qdot2,2) + 6*a2*a3*Power(1 + Power(q1,2),3)*(1 + Power(q2,2))*q3*Power(qdot3,2) + 6*b2*b3*Power(1 + Power(q1,2),3)*(1 + Power(q2,2))*q3*Power(qdot3,2) - 6*a2*a3*Power(1 + Power(q1,2),3)*Power(q2,2)*(1 + Power(q2,2))*q3*Power(qdot3,2) - 6*b2*b3*Power(1 + Power(q1,2),3)*Power(q2,2)*(1 + Power(q2,2))*q3*Power(qdot3,2) - 2*a2*a3*Power(1 + Power(q1,2),3)*(1 + Power(q2,2))*Power(q3,3)*Power(qdot3,2) - 2*b2*b3*Power(1 + Power(q1,2),3)*(1 + Power(q2,2))*Power(q3,3)*Power(qdot3,2) + 2*a2*a3*Power(1 + Power(q1,2),3)*Power(q2,2)*(1 + Power(q2,2))*Power(q3,3)*Power(qdot3,2) + 2*b2*b3*Power(1 + Power(q1,2),3)*Power(q2,2)*(1 + Power(q2,2))*Power(q3,3)*Power(qdot3,2) + 4*a2*a3*Power(1 + Power(q1,2),3)*q2*(1 + Power(q2,2))*(-1 + 3*Power(q3,2))*Power(qdot3,2) + 4*b2*b3*Power(1 + Power(q1,2),3)*q2*(1 + Power(q2,2))*(-1 + 3*Power(q3,2))*Power(qdot3,2) - 2*a3*b2*Power(1 + Power(q1,2),3)*(1 + Power(q2,2))*(1 - 3*Power(q3,2) - 2*q2*q3*(-3 + Power(q3,2)) + Power(q2,2)*(-1 + 3*Power(q3,2)))*Power(qdot3,2) + 2*a2*b3*Power(1 + Power(q1,2),3)*(1 + Power(q2,2))*(1 - 3*Power(q3,2) - 2*q2*q3*(-3 + Power(q3,2)) + Power(q2,2)*(-1 + 3*Power(q3,2)))*Power(qdot3,2)))))/(((-2*(1 + Power(q3,2)) - 6*Power(q1,2)*(1 + Power(q3,2)) - 6*Power(q1,4)*(1 + Power(q3,2)) - 2*Power(q1,6)*(1 + Power(q3,2)) - 6*Power(q2,2)*(1 + Power(q3,2)) - 18*Power(q1,2)*Power(q2,2)*(1 + Power(q3,2)) - 18*Power(q1,4)*Power(q2,2)*(1 + Power(q3,2)) - 6*Power(q1,6)*Power(q2,2)*(1 + Power(q3,2)) - 6*Power(q2,4)*(1 + Power(q3,2)) - 18*Power(q1,2)*Power(q2,4)*(1 + Power(q3,2)) - 18*Power(q1,4)*Power(q2,4)*(1 + Power(q3,2)) - 6*Power(q1,6)*Power(q2,4)*(1 + Power(q3,2)) - 2*Power(q2,6)*(1 + Power(q3,2)) - 6*Power(q1,2)*Power(q2,6)*(1 + Power(q3,2)) - 6*Power(q1,4)*Power(q2,6)*(1 + Power(q3,2)) - 2*Power(q1,6)*Power(q2,6)*(1 + Power(q3,2)))*(-4*a1*a2*(1 + Power(q1,2))*Power(1 + Power(q3,2),3) - 4*b1*b2*(1 + Power(q1,2))*Power(1 + Power(q3,2),3) + 4*a1*a2*Power(q1,2)*(1 + Power(q1,2))*Power(1 + Power(q3,2),3) + 4*b1*b2*Power(q1,2)*(1 + Power(q1,2))*Power(1 + Power(q3,2),3) + 4*a1*a2*(1 + Power(q1,2))*Power(q2,4)*Power(1 + Power(q3,2),3) + 4*b1*b2*(1 + Power(q1,2))*Power(q2,4)*Power(1 + Power(q3,2),3) - 4*a1*a2*Power(q1,2)*(1 + Power(q1,2))*Power(q2,4)*Power(1 + Power(q3,2),3) - 4*b1*b2*Power(q1,2)*(1 + Power(q1,2))*Power(q2,4)*Power(1 + Power(q3,2),3) - 16*a1*a2*q1*(1 + Power(q1,2))*q2*(1 + Power(q2,2))*Power(1 + Power(q3,2),3) - 16*b1*b2*q1*(1 + Power(q1,2))*q2*(1 + Power(q2,2))*Power(1 + Power(q3,2),3) - 8*a2*b1*(1 + Power(q1,2))*(1 + Power(q2,2))*(q2 - Power(q1,2)*q2 + q1*(-1 + Power(q2,2)))*Power(1 + Power(q3,2),3) + 8*a1*b2*(1 + Power(q1,2))*(1 + Power(q2,2))*(q2 - Power(q1,2)*q2 + q1*(-1 + Power(q2,2)))*Power(1 + Power(q3,2),3)) - (-2*a1*a3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3) - 2*b1*b3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3) + 2*a1*a3*Power(q1,2)*(1 + Power(q1,2))*Power(1 + Power(q2,2),3) + 2*b1*b3*Power(q1,2)*(1 + Power(q1,2))*Power(1 + Power(q2,2),3) + 2*a1*a3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*Power(q3,4) + 2*b1*b3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*Power(q3,4) - 2*a1*a3*Power(q1,2)*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*Power(q3,4) - 2*b1*b3*Power(q1,2)*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*Power(q3,4) - 8*a1*a3*q1*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*q3*(1 + Power(q3,2)) - 8*b1*b3*q1*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*q3*(1 + Power(q3,2)) - 4*a3*b1*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*(1 + Power(q3,2))*(q3 - Power(q1,2)*q3 + q1*(-1 + Power(q3,2))) + 4*a1*b3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*(1 + Power(q3,2))*(q3 - Power(q1,2)*q3 + q1*(-1 + Power(q3,2))))*(-2*a2*a3*Power(1 + Power(q1,2),3)*(1 + Power(q3,2)) - 2*b2*b3*Power(1 + Power(q1,2),3)*(1 + Power(q3,2)) - 8*a2*a3*Power(1 + Power(q1,2),3)*q2*q3*(1 + Power(q3,2)) - 8*b2*b3*Power(1 + Power(q1,2),3)*q2*q3*(1 + Power(q3,2)) - 8*a2*a3*Power(1 + Power(q1,2),3)*Power(q2,3)*q3*(1 + Power(q3,2)) - 8*b2*b3*Power(1 + Power(q1,2),3)*Power(q2,3)*q3*(1 + Power(q3,2)) + 2*a2*a3*Power(1 + Power(q1,2),3)*Power(q3,2)*(1 + Power(q3,2)) + 2*b2*b3*Power(1 + Power(q1,2),3)*Power(q3,2)*(1 + Power(q3,2)) - 2*a2*a3*Power(1 + Power(q1,2),3)*Power(q2,4)*(-1 + Power(q3,2))*(1 + Power(q3,2)) - 2*b2*b3*Power(1 + Power(q1,2),3)*Power(q2,4)*(-1 + Power(q3,2))*(1 + Power(q3,2)) + 4*a3*b2*Power(1 + Power(q1,2),3)*(1 + Power(q2,2))*(1 + Power(q3,2))*(-q3 + Power(q2,2)*q3 - q2*(-1 + Power(q3,2))) - 4*a2*b3*Power(1 + Power(q1,2),3)*(1 + Power(q2,2))*(1 + Power(q3,2))*(-q3 + Power(q2,2)*q3 - q2*(-1 + Power(q3,2)))))*(((-2*(1 + Power(q3,2)) - 6*Power(q1,2)*(1 + Power(q3,2)) - 6*Power(q1,4)*(1 + Power(q3,2)) - 2*Power(q1,6)*(1 + Power(q3,2)) - 6*Power(q2,2)*(1 + Power(q3,2)) - 18*Power(q1,2)*Power(q2,2)*(1 + Power(q3,2)) - 18*Power(q1,4)*Power(q2,2)*(1 + Power(q3,2)) - 6*Power(q1,6)*Power(q2,2)*(1 + Power(q3,2)) - 6*Power(q2,4)*(1 + Power(q3,2)) - 18*Power(q1,2)*Power(q2,4)*(1 + Power(q3,2)) - 18*Power(q1,4)*Power(q2,4)*(1 + Power(q3,2)) - 6*Power(q1,6)*Power(q2,4)*(1 + Power(q3,2)) - 2*Power(q2,6)*(1 + Power(q3,2)) - 6*Power(q1,2)*Power(q2,6)*(1 + Power(q3,2)) - 6*Power(q1,4)*Power(q2,6)*(1 + Power(q3,2)) - 2*Power(q1,6)*Power(q2,6)*(1 + Power(q3,2)))*(-4*a1*a2*(1 + Power(q1,2))*Power(1 + Power(q3,2),3) - 4*b1*b2*(1 + Power(q1,2))*Power(1 + Power(q3,2),3) + 4*a1*a2*Power(q1,2)*(1 + Power(q1,2))*Power(1 + Power(q3,2),3) + 4*b1*b2*Power(q1,2)*(1 + Power(q1,2))*Power(1 + Power(q3,2),3) + 4*a1*a2*(1 + Power(q1,2))*Power(q2,4)*Power(1 + Power(q3,2),3) + 4*b1*b2*(1 + Power(q1,2))*Power(q2,4)*Power(1 + Power(q3,2),3) - 4*a1*a2*Power(q1,2)*(1 + Power(q1,2))*Power(q2,4)*Power(1 + Power(q3,2),3) - 4*b1*b2*Power(q1,2)*(1 + Power(q1,2))*Power(q2,4)*Power(1 + Power(q3,2),3) - 16*a1*a2*q1*(1 + Power(q1,2))*q2*(1 + Power(q2,2))*Power(1 + Power(q3,2),3) - 16*b1*b2*q1*(1 + Power(q1,2))*q2*(1 + Power(q2,2))*Power(1 + Power(q3,2),3) - 8*a2*b1*(1 + Power(q1,2))*(1 + Power(q2,2))*(q2 - Power(q1,2)*q2 + q1*(-1 + Power(q2,2)))*Power(1 + Power(q3,2),3) + 8*a1*b2*(1 + Power(q1,2))*(1 + Power(q2,2))*(q2 - Power(q1,2)*q2 + q1*(-1 + Power(q2,2)))*Power(1 + Power(q3,2),3)) - (-2*a1*a3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3) - 2*b1*b3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3) + 2*a1*a3*Power(q1,2)*(1 + Power(q1,2))*Power(1 + Power(q2,2),3) + 2*b1*b3*Power(q1,2)*(1 + Power(q1,2))*Power(1 + Power(q2,2),3) + 2*a1*a3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*Power(q3,4) + 2*b1*b3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*Power(q3,4) - 2*a1*a3*Power(q1,2)*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*Power(q3,4) - 2*b1*b3*Power(q1,2)*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*Power(q3,4) - 8*a1*a3*q1*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*q3*(1 + Power(q3,2)) - 8*b1*b3*q1*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*q3*(1 + Power(q3,2)) - 4*a3*b1*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*(1 + Power(q3,2))*(q3 - Power(q1,2)*q3 + q1*(-1 + Power(q3,2))) + 4*a1*b3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*(1 + Power(q3,2))*(q3 - Power(q1,2)*q3 + q1*(-1 + Power(q3,2))))*(-2*a2*a3*Power(1 + Power(q1,2),3)*(1 + Power(q3,2)) - 2*b2*b3*Power(1 + Power(q1,2),3)*(1 + Power(q3,2)) - 8*a2*a3*Power(1 + Power(q1,2),3)*q2*q3*(1 + Power(q3,2)) - 8*b2*b3*Power(1 + Power(q1,2),3)*q2*q3*(1 + Power(q3,2)) - 8*a2*a3*Power(1 + Power(q1,2),3)*Power(q2,3)*q3*(1 + Power(q3,2)) - 8*b2*b3*Power(1 + Power(q1,2),3)*Power(q2,3)*q3*(1 + Power(q3,2)) + 2*a2*a3*Power(1 + Power(q1,2),3)*Power(q3,2)*(1 + Power(q3,2)) + 2*b2*b3*Power(1 + Power(q1,2),3)*Power(q3,2)*(1 + Power(q3,2)) - 2*a2*a3*Power(1 + Power(q1,2),3)*Power(q2,4)*(-1 + Power(q3,2))*(1 + Power(q3,2)) - 2*b2*b3*Power(1 + Power(q1,2),3)*Power(q2,4)*(-1 + Power(q3,2))*(1 + Power(q3,2)) + 4*a3*b2*Power(1 + Power(q1,2),3)*(1 + Power(q2,2))*(1 + Power(q3,2))*(-q3 + Power(q2,2)*q3 - q2*(-1 + Power(q3,2))) - 4*a2*b3*Power(1 + Power(q1,2),3)*(1 + Power(q2,2))*(1 + Power(q3,2))*(-q3 + Power(q2,2)*q3 - q2*(-1 + Power(q3,2)))))*((-2*(1 + Power(q3,2)) - 6*Power(q1,2)*(1 + Power(q3,2)) - 6*Power(q1,4)*(1 + Power(q3,2)) - 2*Power(q1,6)*(1 + Power(q3,2)) - 6*Power(q2,2)*(1 + Power(q3,2)) - 18*Power(q1,2)*Power(q2,2)*(1 + Power(q3,2)) - 18*Power(q1,4)*Power(q2,2)*(1 + Power(q3,2)) - 6*Power(q1,6)*Power(q2,2)*(1 + Power(q3,2)) - 6*Power(q2,4)*(1 + Power(q3,2)) - 18*Power(q1,2)*Power(q2,4)*(1 + Power(q3,2)) - 18*Power(q1,4)*Power(q2,4)*(1 + Power(q3,2)) - 6*Power(q1,6)*Power(q2,4)*(1 + Power(q3,2)) - 2*Power(q2,6)*(1 + Power(q3,2)) - 6*Power(q1,2)*Power(q2,6)*(1 + Power(q3,2)) - 6*Power(q1,4)*Power(q2,6)*(1 + Power(q3,2)) - 2*Power(q1,6)*Power(q2,6)*(1 + Power(q3,2)))*(-2*a1*a2*(1 + Power(q2,2))*Power(1 + Power(q3,2),3) - 2*b1*b2*(1 + Power(q2,2))*Power(1 + Power(q3,2),3) - 8*a1*a2*q1*q2*(1 + Power(q2,2))*Power(1 + Power(q3,2),3) - 8*b1*b2*q1*q2*(1 + Power(q2,2))*Power(1 + Power(q3,2),3) - 8*a1*a2*Power(q1,3)*q2*(1 + Power(q2,2))*Power(1 + Power(q3,2),3) - 8*b1*b2*Power(q1,3)*q2*(1 + Power(q2,2))*Power(1 + Power(q3,2),3) + 2*a1*a2*Power(q2,2)*(1 + Power(q2,2))*Power(1 + Power(q3,2),3) + 2*b1*b2*Power(q2,2)*(1 + Power(q2,2))*Power(1 + Power(q3,2),3) - 2*a1*a2*Power(q1,4)*(-1 + Power(q2,2))*(1 + Power(q2,2))*Power(1 + Power(q3,2),3) - 2*b1*b2*Power(q1,4)*(-1 + Power(q2,2))*(1 + Power(q2,2))*Power(1 + Power(q3,2),3) + 4*a2*b1*(1 + Power(q1,2))*(1 + Power(q2,2))*(-q2 + Power(q1,2)*q2 - q1*(-1 + Power(q2,2)))*Power(1 + Power(q3,2),3) - 4*a1*b2*(1 + Power(q1,2))*(1 + Power(q2,2))*(-q2 + Power(q1,2)*q2 - q1*(-1 + Power(q2,2)))*Power(1 + Power(q3,2),3)) - (-2*a1*a3*Power(1 + Power(q2,2),3)*(1 + Power(q3,2)) - 2*b1*b3*Power(1 + Power(q2,2),3)*(1 + Power(q3,2)) - 8*a1*a3*q1*Power(1 + Power(q2,2),3)*q3*(1 + Power(q3,2)) - 8*b1*b3*q1*Power(1 + Power(q2,2),3)*q3*(1 + Power(q3,2)) - 8*a1*a3*Power(q1,3)*Power(1 + Power(q2,2),3)*q3*(1 + Power(q3,2)) - 8*b1*b3*Power(q1,3)*Power(1 + Power(q2,2),3)*q3*(1 + Power(q3,2)) + 2*a1*a3*Power(1 + Power(q2,2),3)*Power(q3,2)*(1 + Power(q3,2)) + 2*b1*b3*Power(1 + Power(q2,2),3)*Power(q3,2)*(1 + Power(q3,2)) - 2*a1*a3*Power(q1,4)*Power(1 + Power(q2,2),3)*(-1 + Power(q3,2))*(1 + Power(q3,2)) - 2*b1*b3*Power(q1,4)*Power(1 + Power(q2,2),3)*(-1 + Power(q3,2))*(1 + Power(q3,2)) + 4*a3*b1*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*(1 + Power(q3,2))*(-q3 + Power(q1,2)*q3 - q1*(-1 + Power(q3,2))) - 4*a1*b3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*(1 + Power(q3,2))*(-q3 + Power(q1,2)*q3 - q1*(-1 + Power(q3,2))))*(-(a2*a3*Power(1 + Power(q1,2),3)*(1 + Power(q2,2))) - b2*b3*Power(1 + Power(q1,2),3)*(1 + Power(q2,2)) + a2*a3*Power(1 + Power(q1,2),3)*Power(q2,2)*(1 + Power(q2,2)) + b2*b3*Power(1 + Power(q1,2),3)*Power(q2,2)*(1 + Power(q2,2)) + a2*a3*Power(1 + Power(q1,2),3)*(1 + Power(q2,2))*Power(q3,4) + b2*b3*Power(1 + Power(q1,2),3)*(1 + Power(q2,2))*Power(q3,4) - a2*a3*Power(1 + Power(q1,2),3)*Power(q2,2)*(1 + Power(q2,2))*Power(q3,4) - b2*b3*Power(1 + Power(q1,2),3)*Power(q2,2)*(1 + Power(q2,2))*Power(q3,4) - 4*a2*a3*Power(1 + Power(q1,2),3)*q2*(1 + Power(q2,2))*q3*(1 + Power(q3,2)) - 4*b2*b3*Power(1 + Power(q1,2),3)*q2*(1 + Power(q2,2))*q3*(1 + Power(q3,2)) - 2*a3*b2*Power(1 + Power(q1,2),3)*(1 + Power(q2,2))*(1 + Power(q3,2))*(q3 - Power(q2,2)*q3 + q2*(-1 + Power(q3,2))) + 2*a2*b3*Power(1 + Power(q1,2),3)*(1 + Power(q2,2))*(1 + Power(q3,2))*(q3 - Power(q2,2)*q3 + q2*(-1 + Power(q3,2))))) - ((-6*(1 + Power(q1,2)) - 18*(1 + Power(q1,2))*Power(q2,2) - 18*(1 + Power(q1,2))*Power(q2,4) - 6*(1 + Power(q1,2))*Power(q2,6) - 18*(1 + Power(q1,2))*Power(q3,2) - 54*(1 + Power(q1,2))*Power(q2,2)*Power(q3,2) - 54*(1 + Power(q1,2))*Power(q2,4)*Power(q3,2) - 18*(1 + Power(q1,2))*Power(q2,6)*Power(q3,2) - 18*(1 + Power(q1,2))*Power(q3,4) - 54*(1 + Power(q1,2))*Power(q2,2)*Power(q3,4) - 54*(1 + Power(q1,2))*Power(q2,4)*Power(q3,4) - 18*(1 + Power(q1,2))*Power(q2,6)*Power(q3,4) - 6*(1 + Power(q1,2))*Power(q3,6) - 18*(1 + Power(q1,2))*Power(q2,2)*Power(q3,6) - 18*(1 + Power(q1,2))*Power(q2,4)*Power(q3,6) - 6*(1 + Power(q1,2))*Power(q2,6)*Power(q3,6))*(-2*(1 + Power(q3,2)) - 6*Power(q1,2)*(1 + Power(q3,2)) - 6*Power(q1,4)*(1 + Power(q3,2)) - 2*Power(q1,6)*(1 + Power(q3,2)) - 6*Power(q2,2)*(1 + Power(q3,2)) - 18*Power(q1,2)*Power(q2,2)*(1 + Power(q3,2)) - 18*Power(q1,4)*Power(q2,2)*(1 + Power(q3,2)) - 6*Power(q1,6)*Power(q2,2)*(1 + Power(q3,2)) - 6*Power(q2,4)*(1 + Power(q3,2)) - 18*Power(q1,2)*Power(q2,4)*(1 + Power(q3,2)) - 18*Power(q1,4)*Power(q2,4)*(1 + Power(q3,2)) - 6*Power(q1,6)*Power(q2,4)*(1 + Power(q3,2)) - 2*Power(q2,6)*(1 + Power(q3,2)) - 6*Power(q1,2)*Power(q2,6)*(1 + Power(q3,2)) - 6*Power(q1,4)*Power(q2,6)*(1 + Power(q3,2)) - 2*Power(q1,6)*Power(q2,6)*(1 + Power(q3,2))) - (-2*a1*a3*Power(1 + Power(q2,2),3)*(1 + Power(q3,2)) - 2*b1*b3*Power(1 + Power(q2,2),3)*(1 + Power(q3,2)) - 8*a1*a3*q1*Power(1 + Power(q2,2),3)*q3*(1 + Power(q3,2)) - 8*b1*b3*q1*Power(1 + Power(q2,2),3)*q3*(1 + Power(q3,2)) - 8*a1*a3*Power(q1,3)*Power(1 + Power(q2,2),3)*q3*(1 + Power(q3,2)) - 8*b1*b3*Power(q1,3)*Power(1 + Power(q2,2),3)*q3*(1 + Power(q3,2)) + 2*a1*a3*Power(1 + Power(q2,2),3)*Power(q3,2)*(1 + Power(q3,2)) + 2*b1*b3*Power(1 + Power(q2,2),3)*Power(q3,2)*(1 + Power(q3,2)) - 2*a1*a3*Power(q1,4)*Power(1 + Power(q2,2),3)*(-1 + Power(q3,2))*(1 + Power(q3,2)) - 2*b1*b3*Power(q1,4)*Power(1 + Power(q2,2),3)*(-1 + Power(q3,2))*(1 + Power(q3,2)) + 4*a3*b1*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*(1 + Power(q3,2))*(-q3 + Power(q1,2)*q3 - q1*(-1 + Power(q3,2))) - 4*a1*b3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*(1 + Power(q3,2))*(-q3 + Power(q1,2)*q3 - q1*(-1 + Power(q3,2))))*(-2*a1*a3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3) - 2*b1*b3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3) + 2*a1*a3*Power(q1,2)*(1 + Power(q1,2))*Power(1 + Power(q2,2),3) + 2*b1*b3*Power(q1,2)*(1 + Power(q1,2))*Power(1 + Power(q2,2),3) + 2*a1*a3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*Power(q3,4) + 2*b1*b3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*Power(q3,4) - 2*a1*a3*Power(q1,2)*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*Power(q3,4) - 2*b1*b3*Power(q1,2)*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*Power(q3,4) - 8*a1*a3*q1*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*q3*(1 + Power(q3,2)) - 8*b1*b3*q1*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*q3*(1 + Power(q3,2)) - 4*a3*b1*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*(1 + Power(q3,2))*(q3 - Power(q1,2)*q3 + q1*(-1 + Power(q3,2))) + 4*a1*b3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*(1 + Power(q3,2))*(q3 - Power(q1,2)*q3 + q1*(-1 + Power(q3,2)))))*((-2*(1 + Power(q2,2)) - 6*Power(q1,2)*(1 + Power(q2,2)) - 6*Power(q1,4)*(1 + Power(q2,2)) - 2*Power(q1,6)*(1 + Power(q2,2)) - 6*(1 + Power(q2,2))*Power(q3,2) - 18*Power(q1,2)*(1 + Power(q2,2))*Power(q3,2) - 18*Power(q1,4)*(1 + Power(q2,2))*Power(q3,2) - 6*Power(q1,6)*(1 + Power(q2,2))*Power(q3,2) - 6*(1 + Power(q2,2))*Power(q3,4) - 18*Power(q1,2)*(1 + Power(q2,2))*Power(q3,4) - 18*Power(q1,4)*(1 + Power(q2,2))*Power(q3,4) - 6*Power(q1,6)*(1 + Power(q2,2))*Power(q3,4) - 2*(1 + Power(q2,2))*Power(q3,6) - 6*Power(q1,2)*(1 + Power(q2,2))*Power(q3,6) - 6*Power(q1,4)*(1 + Power(q2,2))*Power(q3,6) - 2*Power(q1,6)*(1 + Power(q2,2))*Power(q3,6))*(-2*(1 + Power(q3,2)) - 6*Power(q1,2)*(1 + Power(q3,2)) - 6*Power(q1,4)*(1 + Power(q3,2)) - 2*Power(q1,6)*(1 + Power(q3,2)) - 6*Power(q2,2)*(1 + Power(q3,2)) - 18*Power(q1,2)*Power(q2,2)*(1 + Power(q3,2)) - 18*Power(q1,4)*Power(q2,2)*(1 + Power(q3,2)) - 6*Power(q1,6)*Power(q2,2)*(1 + Power(q3,2)) - 6*Power(q2,4)*(1 + Power(q3,2)) - 18*Power(q1,2)*Power(q2,4)*(1 + Power(q3,2)) - 18*Power(q1,4)*Power(q2,4)*(1 + Power(q3,2)) - 6*Power(q1,6)*Power(q2,4)*(1 + Power(q3,2)) - 2*Power(q2,6)*(1 + Power(q3,2)) - 6*Power(q1,2)*Power(q2,6)*(1 + Power(q3,2)) - 6*Power(q1,4)*Power(q2,6)*(1 + Power(q3,2)) - 2*Power(q1,6)*Power(q2,6)*(1 + Power(q3,2))) - (-2*a2*a3*Power(1 + Power(q1,2),3)*(1 + Power(q3,2)) - 2*b2*b3*Power(1 + Power(q1,2),3)*(1 + Power(q3,2)) - 8*a2*a3*Power(1 + Power(q1,2),3)*q2*q3*(1 + Power(q3,2)) - 8*b2*b3*Power(1 + Power(q1,2),3)*q2*q3*(1 + Power(q3,2)) - 8*a2*a3*Power(1 + Power(q1,2),3)*Power(q2,3)*q3*(1 + Power(q3,2)) - 8*b2*b3*Power(1 + Power(q1,2),3)*Power(q2,3)*q3*(1 + Power(q3,2)) + 2*a2*a3*Power(1 + Power(q1,2),3)*Power(q3,2)*(1 + Power(q3,2)) + 2*b2*b3*Power(1 + Power(q1,2),3)*Power(q3,2)*(1 + Power(q3,2)) - 2*a2*a3*Power(1 + Power(q1,2),3)*Power(q2,4)*(-1 + Power(q3,2))*(1 + Power(q3,2)) - 2*b2*b3*Power(1 + Power(q1,2),3)*Power(q2,4)*(-1 + Power(q3,2))*(1 + Power(q3,2)) + 4*a3*b2*Power(1 + Power(q1,2),3)*(1 + Power(q2,2))*(1 + Power(q3,2))*(-q3 + Power(q2,2)*q3 - q2*(-1 + Power(q3,2))) - 4*a2*b3*Power(1 + Power(q1,2),3)*(1 + Power(q2,2))*(1 + Power(q3,2))*(-q3 + Power(q2,2)*q3 - q2*(-1 + Power(q3,2))))*(-(a2*a3*Power(1 + Power(q1,2),3)*(1 + Power(q2,2))) - b2*b3*Power(1 + Power(q1,2),3)*(1 + Power(q2,2)) + a2*a3*Power(1 + Power(q1,2),3)*Power(q2,2)*(1 + Power(q2,2)) + b2*b3*Power(1 + Power(q1,2),3)*Power(q2,2)*(1 + Power(q2,2)) + a2*a3*Power(1 + Power(q1,2),3)*(1 + Power(q2,2))*Power(q3,4) + b2*b3*Power(1 + Power(q1,2),3)*(1 + Power(q2,2))*Power(q3,4) - a2*a3*Power(1 + Power(q1,2),3)*Power(q2,2)*(1 + Power(q2,2))*Power(q3,4) - b2*b3*Power(1 + Power(q1,2),3)*Power(q2,2)*(1 + Power(q2,2))*Power(q3,4) - 4*a2*a3*Power(1 + Power(q1,2),3)*q2*(1 + Power(q2,2))*q3*(1 + Power(q3,2)) - 4*b2*b3*Power(1 + Power(q1,2),3)*q2*(1 + Power(q2,2))*q3*(1 + Power(q3,2)) - 2*a3*b2*Power(1 + Power(q1,2),3)*(1 + Power(q2,2))*(1 + Power(q3,2))*(q3 - Power(q2,2)*q3 + q2*(-1 + Power(q3,2))) + 2*a2*b3*Power(1 + Power(q1,2),3)*(1 + Power(q2,2))*(1 + Power(q3,2))*(q3 - Power(q2,2)*q3 + q2*(-1 + Power(q3,2))))))),-((2*b3*Power(1 + Power(q1,2),3)*Power(1 + Power(q2,2),3)*q3*(1 + Power(q3,2)) + a3*Power(1 + Power(q1,2),3)*Power(1 + Power(q2,2),3)*(-1 + Power(q3,4)) - 8*a1*a3*Power(1 + Power(q2,2),3)*q3*(1 + Power(q3,2))*Power(qdot1,2) - 8*b1*b3*Power(1 + Power(q2,2),3)*q3*(1 + Power(q3,2))*Power(qdot1,2) + 24*a1*a3*Power(q1,2)*Power(1 + Power(q2,2),3)*q3*(1 + Power(q3,2))*Power(qdot1,2) + 24*b1*b3*Power(q1,2)*Power(1 + Power(q2,2),3)*q3*(1 + Power(q3,2))*Power(qdot1,2) - 12*a1*a3*q1*Power(1 + Power(q2,2),3)*(-1 + Power(q3,2))*(1 + Power(q3,2))*Power(qdot1,2) - 12*b1*b3*q1*Power(1 + Power(q2,2),3)*(-1 + Power(q3,2))*(1 + Power(q3,2))*Power(qdot1,2) + 4*a1*a3*Power(q1,3)*Power(1 + Power(q2,2),3)*(-1 + Power(q3,2))*(1 + Power(q3,2))*Power(qdot1,2) + 4*b1*b3*Power(q1,3)*Power(1 + Power(q2,2),3)*(-1 + Power(q3,2))*(1 + Power(q3,2))*Power(qdot1,2) - 4*a3*b1*Power(1 + Power(q2,2),3)*(1 + Power(q3,2))*(-1 - 6*q1*q3 + 2*Power(q1,3)*q3 + Power(q3,2) - 3*Power(q1,2)*(-1 + Power(q3,2)))*Power(qdot1,2) + 4*a1*b3*Power(1 + Power(q2,2),3)*(1 + Power(q3,2))*(-1 - 6*q1*q3 + 2*Power(q1,3)*q3 + Power(q3,2) - 3*Power(q1,2)*(-1 + Power(q3,2)))*Power(qdot1,2) - 8*a2*a3*Power(1 + Power(q1,2),3)*q3*(1 + Power(q3,2))*Power(qdot2,2) - 8*b2*b3*Power(1 + Power(q1,2),3)*q3*(1 + Power(q3,2))*Power(qdot2,2) + 24*a2*a3*Power(1 + Power(q1,2),3)*Power(q2,2)*q3*(1 + Power(q3,2))*Power(qdot2,2) + 24*b2*b3*Power(1 + Power(q1,2),3)*Power(q2,2)*q3*(1 + Power(q3,2))*Power(qdot2,2) - 12*a2*a3*Power(1 + Power(q1,2),3)*q2*(-1 + Power(q3,2))*(1 + Power(q3,2))*Power(qdot2,2) - 12*b2*b3*Power(1 + Power(q1,2),3)*q2*(-1 + Power(q3,2))*(1 + Power(q3,2))*Power(qdot2,2) + 4*a2*a3*Power(1 + Power(q1,2),3)*Power(q2,3)*(-1 + Power(q3,2))*(1 + Power(q3,2))*Power(qdot2,2) + 4*b2*b3*Power(1 + Power(q1,2),3)*Power(q2,3)*(-1 + Power(q3,2))*(1 + Power(q3,2))*Power(qdot2,2) - 4*a3*b2*Power(1 + Power(q1,2),3)*(1 + Power(q3,2))*(-1 - 6*q2*q3 + 2*Power(q2,3)*q3 + Power(q3,2) - 3*Power(q2,2)*(-1 + Power(q3,2)))*Power(qdot2,2) + 4*a2*b3*Power(1 + Power(q1,2),3)*(1 + Power(q3,2))*(-1 - 6*q2*q3 + 2*Power(q2,3)*q3 + Power(q3,2) - 3*Power(q2,2)*(-1 + Power(q3,2)))*Power(qdot2,2) + 4*q3*Power(qdot3,2) + 12*Power(q1,2)*q3*Power(qdot3,2) + 12*Power(q1,4)*q3*Power(qdot3,2) + 4*Power(q1,6)*q3*Power(qdot3,2) + 12*Power(q2,2)*q3*Power(qdot3,2) + 36*Power(q1,2)*Power(q2,2)*q3*Power(qdot3,2) + 36*Power(q1,4)*Power(q2,2)*q3*Power(qdot3,2) + 12*Power(q1,6)*Power(q2,2)*q3*Power(qdot3,2) + 12*Power(q2,4)*q3*Power(qdot3,2) + 36*Power(q1,2)*Power(q2,4)*q3*Power(qdot3,2) + 36*Power(q1,4)*Power(q2,4)*q3*Power(qdot3,2) + 12*Power(q1,6)*Power(q2,4)*q3*Power(qdot3,2) + 4*Power(q2,6)*q3*Power(qdot3,2) + 12*Power(q1,2)*Power(q2,6)*q3*Power(qdot3,2) + 12*Power(q1,4)*Power(q2,6)*q3*Power(qdot3,2) + 4*Power(q1,6)*Power(q2,6)*q3*Power(qdot3,2))/(-2*(1 + Power(q3,2)) - 6*Power(q1,2)*(1 + Power(q3,2)) - 6*Power(q1,4)*(1 + Power(q3,2)) - 2*Power(q1,6)*(1 + Power(q3,2)) - 6*Power(q2,2)*(1 + Power(q3,2)) - 18*Power(q1,2)*Power(q2,2)*(1 + Power(q3,2)) - 18*Power(q1,4)*Power(q2,2)*(1 + Power(q3,2)) - 6*Power(q1,6)*Power(q2,2)*(1 + Power(q3,2)) - 6*Power(q2,4)*(1 + Power(q3,2)) - 18*Power(q1,2)*Power(q2,4)*(1 + Power(q3,2)) - 18*Power(q1,4)*Power(q2,4)*(1 + Power(q3,2)) - 6*Power(q1,6)*Power(q2,4)*(1 + Power(q3,2)) - 2*Power(q2,6)*(1 + Power(q3,2)) - 6*Power(q1,2)*Power(q2,6)*(1 + Power(q3,2)) - 6*Power(q1,4)*Power(q2,6)*(1 + Power(q3,2)) - 2*Power(q1,6)*Power(q2,6)*(1 + Power(q3,2)))) + ((-2*a2*a3*Power(1 + Power(q1,2),3)*(1 + Power(q3,2)) - 2*b2*b3*Power(1 + Power(q1,2),3)*(1 + Power(q3,2)) - 8*a2*a3*Power(1 + Power(q1,2),3)*q2*q3*(1 + Power(q3,2)) - 8*b2*b3*Power(1 + Power(q1,2),3)*q2*q3*(1 + Power(q3,2)) - 8*a2*a3*Power(1 + Power(q1,2),3)*Power(q2,3)*q3*(1 + Power(q3,2)) - 8*b2*b3*Power(1 + Power(q1,2),3)*Power(q2,3)*q3*(1 + Power(q3,2)) + 2*a2*a3*Power(1 + Power(q1,2),3)*Power(q3,2)*(1 + Power(q3,2)) + 2*b2*b3*Power(1 + Power(q1,2),3)*Power(q3,2)*(1 + Power(q3,2)) - 2*a2*a3*Power(1 + Power(q1,2),3)*Power(q2,4)*(-1 + Power(q3,2))*(1 + Power(q3,2)) - 2*b2*b3*Power(1 + Power(q1,2),3)*Power(q2,4)*(-1 + Power(q3,2))*(1 + Power(q3,2)) + 4*a3*b2*Power(1 + Power(q1,2),3)*(1 + Power(q2,2))*(1 + Power(q3,2))*(-q3 + Power(q2,2)*q3 - q2*(-1 + Power(q3,2))) - 4*a2*b3*Power(1 + Power(q1,2),3)*(1 + Power(q2,2))*(1 + Power(q3,2))*(-q3 + Power(q2,2)*q3 - q2*(-1 + Power(q3,2))))*(-((-2*a1*a3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3) - 2*b1*b3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3) + 2*a1*a3*Power(q1,2)*(1 + Power(q1,2))*Power(1 + Power(q2,2),3) + 2*b1*b3*Power(q1,2)*(1 + Power(q1,2))*Power(1 + Power(q2,2),3) + 2*a1*a3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*Power(q3,4) + 2*b1*b3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*Power(q3,4) - 2*a1*a3*Power(q1,2)*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*Power(q3,4) - 2*b1*b3*Power(q1,2)*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*Power(q3,4) - 8*a1*a3*q1*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*q3*(1 + Power(q3,2)) - 8*b1*b3*q1*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*q3*(1 + Power(q3,2)) - 4*a3*b1*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*(1 + Power(q3,2))*(q3 - Power(q1,2)*q3 + q1*(-1 + Power(q3,2))) + 4*a1*b3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*(1 + Power(q3,2))*(q3 - Power(q1,2)*q3 + q1*(-1 + Power(q3,2))))*(2*b3*Power(1 + Power(q1,2),3)*Power(1 + Power(q2,2),3)*q3*(1 + Power(q3,2)) + a3*Power(1 + Power(q1,2),3)*Power(1 + Power(q2,2),3)*(-1 + Power(q3,4)) - 8*a1*a3*Power(1 + Power(q2,2),3)*q3*(1 + Power(q3,2))*Power(qdot1,2) - 8*b1*b3*Power(1 + Power(q2,2),3)*q3*(1 + Power(q3,2))*Power(qdot1,2) + 24*a1*a3*Power(q1,2)*Power(1 + Power(q2,2),3)*q3*(1 + Power(q3,2))*Power(qdot1,2) + 24*b1*b3*Power(q1,2)*Power(1 + Power(q2,2),3)*q3*(1 + Power(q3,2))*Power(qdot1,2) - 12*a1*a3*q1*Power(1 + Power(q2,2),3)*(-1 + Power(q3,2))*(1 + Power(q3,2))*Power(qdot1,2) - 12*b1*b3*q1*Power(1 + Power(q2,2),3)*(-1 + Power(q3,2))*(1 + Power(q3,2))*Power(qdot1,2) + 4*a1*a3*Power(q1,3)*Power(1 + Power(q2,2),3)*(-1 + Power(q3,2))*(1 + Power(q3,2))*Power(qdot1,2) + 4*b1*b3*Power(q1,3)*Power(1 + Power(q2,2),3)*(-1 + Power(q3,2))*(1 + Power(q3,2))*Power(qdot1,2) - 4*a3*b1*Power(1 + Power(q2,2),3)*(1 + Power(q3,2))*(-1 - 6*q1*q3 + 2*Power(q1,3)*q3 + Power(q3,2) - 3*Power(q1,2)*(-1 + Power(q3,2)))*Power(qdot1,2) + 4*a1*b3*Power(1 + Power(q2,2),3)*(1 + Power(q3,2))*(-1 - 6*q1*q3 + 2*Power(q1,3)*q3 + Power(q3,2) - 3*Power(q1,2)*(-1 + Power(q3,2)))*Power(qdot1,2) - 8*a2*a3*Power(1 + Power(q1,2),3)*q3*(1 + Power(q3,2))*Power(qdot2,2) - 8*b2*b3*Power(1 + Power(q1,2),3)*q3*(1 + Power(q3,2))*Power(qdot2,2) + 24*a2*a3*Power(1 + Power(q1,2),3)*Power(q2,2)*q3*(1 + Power(q3,2))*Power(qdot2,2) + 24*b2*b3*Power(1 + Power(q1,2),3)*Power(q2,2)*q3*(1 + Power(q3,2))*Power(qdot2,2) - 12*a2*a3*Power(1 + Power(q1,2),3)*q2*(-1 + Power(q3,2))*(1 + Power(q3,2))*Power(qdot2,2) - 12*b2*b3*Power(1 + Power(q1,2),3)*q2*(-1 + Power(q3,2))*(1 + Power(q3,2))*Power(qdot2,2) + 4*a2*a3*Power(1 + Power(q1,2),3)*Power(q2,3)*(-1 + Power(q3,2))*(1 + Power(q3,2))*Power(qdot2,2) + 4*b2*b3*Power(1 + Power(q1,2),3)*Power(q2,3)*(-1 + Power(q3,2))*(1 + Power(q3,2))*Power(qdot2,2) - 4*a3*b2*Power(1 + Power(q1,2),3)*(1 + Power(q3,2))*(-1 - 6*q2*q3 + 2*Power(q2,3)*q3 + Power(q3,2) - 3*Power(q2,2)*(-1 + Power(q3,2)))*Power(qdot2,2) + 4*a2*b3*Power(1 + Power(q1,2),3)*(1 + Power(q3,2))*(-1 - 6*q2*q3 + 2*Power(q2,3)*q3 + Power(q3,2) - 3*Power(q2,2)*(-1 + Power(q3,2)))*Power(qdot2,2) + 4*q3*Power(qdot3,2) + 12*Power(q1,2)*q3*Power(qdot3,2) + 12*Power(q1,4)*q3*Power(qdot3,2) + 4*Power(q1,6)*q3*Power(qdot3,2) + 12*Power(q2,2)*q3*Power(qdot3,2) + 36*Power(q1,2)*Power(q2,2)*q3*Power(qdot3,2) + 36*Power(q1,4)*Power(q2,2)*q3*Power(qdot3,2) + 12*Power(q1,6)*Power(q2,2)*q3*Power(qdot3,2) + 12*Power(q2,4)*q3*Power(qdot3,2) + 36*Power(q1,2)*Power(q2,4)*q3*Power(qdot3,2) + 36*Power(q1,4)*Power(q2,4)*q3*Power(qdot3,2) + 12*Power(q1,6)*Power(q2,4)*q3*Power(qdot3,2) + 4*Power(q2,6)*q3*Power(qdot3,2) + 12*Power(q1,2)*Power(q2,6)*q3*Power(qdot3,2) + 12*Power(q1,4)*Power(q2,6)*q3*Power(qdot3,2) + 4*Power(q1,6)*Power(q2,6)*q3*Power(qdot3,2))) + (-2*(1 + Power(q3,2)) - 6*Power(q1,2)*(1 + Power(q3,2)) - 6*Power(q1,4)*(1 + Power(q3,2)) - 2*Power(q1,6)*(1 + Power(q3,2)) - 6*Power(q2,2)*(1 + Power(q3,2)) - 18*Power(q1,2)*Power(q2,2)*(1 + Power(q3,2)) - 18*Power(q1,4)*Power(q2,2)*(1 + Power(q3,2)) - 6*Power(q1,6)*Power(q2,2)*(1 + Power(q3,2)) - 6*Power(q2,4)*(1 + Power(q3,2)) - 18*Power(q1,2)*Power(q2,4)*(1 + Power(q3,2)) - 18*Power(q1,4)*Power(q2,4)*(1 + Power(q3,2)) - 6*Power(q1,6)*Power(q2,4)*(1 + Power(q3,2)) - 2*Power(q2,6)*(1 + Power(q3,2)) - 6*Power(q1,2)*Power(q2,6)*(1 + Power(q3,2)) - 6*Power(q1,4)*Power(q2,6)*(1 + Power(q3,2)) - 2*Power(q1,6)*Power(q2,6)*(1 + Power(q3,2)))*(6*b1*q1*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*Power(1 + Power(q3,2),3) + 3*a1*(-1 + Power(q1,4))*Power(1 + Power(q2,2),3)*Power(1 + Power(q3,2),3) + 12*q1*Power(qdot1,2) + 36*q1*Power(q2,2)*Power(qdot1,2) + 36*q1*Power(q2,4)*Power(qdot1,2) + 12*q1*Power(q2,6)*Power(qdot1,2) + 36*q1*Power(q3,2)*Power(qdot1,2) + 108*q1*Power(q2,2)*Power(q3,2)*Power(qdot1,2) + 108*q1*Power(q2,4)*Power(q3,2)*Power(qdot1,2) + 36*q1*Power(q2,6)*Power(q3,2)*Power(qdot1,2) + 36*q1*Power(q3,4)*Power(qdot1,2) + 108*q1*Power(q2,2)*Power(q3,4)*Power(qdot1,2) + 108*q1*Power(q2,4)*Power(q3,4)*Power(qdot1,2) + 36*q1*Power(q2,6)*Power(q3,4)*Power(qdot1,2) + 12*q1*Power(q3,6)*Power(qdot1,2) + 36*q1*Power(q2,2)*Power(q3,6)*Power(qdot1,2) + 36*q1*Power(q2,4)*Power(q3,6)*Power(qdot1,2) + 12*q1*Power(q2,6)*Power(q3,6)*Power(qdot1,2) + 24*a1*a2*(1 + Power(q1,2))*q2*Power(1 + Power(q3,2),3)*Power(qdot2,2) + 24*b1*b2*(1 + Power(q1,2))*q2*Power(1 + Power(q3,2),3)*Power(qdot2,2) - 24*a1*a2*Power(q1,2)*(1 + Power(q1,2))*q2*Power(1 + Power(q3,2),3)*Power(qdot2,2) - 24*b1*b2*Power(q1,2)*(1 + Power(q1,2))*q2*Power(1 + Power(q3,2),3)*Power(qdot2,2) - 8*a1*a2*(1 + Power(q1,2))*Power(q2,3)*Power(1 + Power(q3,2),3)*Power(qdot2,2) - 8*b1*b2*(1 + Power(q1,2))*Power(q2,3)*Power(1 + Power(q3,2),3)*Power(qdot2,2) + 8*a1*a2*Power(q1,2)*(1 + Power(q1,2))*Power(q2,3)*Power(1 + Power(q3,2),3)*Power(qdot2,2) + 8*b1*b2*Power(q1,2)*(1 + Power(q1,2))*Power(q2,3)*Power(1 + Power(q3,2),3)*Power(qdot2,2) + 16*a1*a2*q1*(1 + Power(q1,2))*(-1 + 3*Power(q2,2))*Power(1 + Power(q3,2),3)*Power(qdot2,2) + 16*b1*b2*q1*(1 + Power(q1,2))*(-1 + 3*Power(q2,2))*Power(1 + Power(q3,2),3)*Power(qdot2,2) - 8*a2*b1*(1 + Power(q1,2))*(1 - 3*Power(q2,2) - 2*q1*q2*(-3 + Power(q2,2)) + Power(q1,2)*(-1 + 3*Power(q2,2)))*Power(1 + Power(q3,2),3)*Power(qdot2,2) + 8*a1*b2*(1 + Power(q1,2))*(1 - 3*Power(q2,2) - 2*q1*q2*(-3 + Power(q2,2)) + Power(q1,2)*(-1 + 3*Power(q2,2)))*Power(1 + Power(q3,2),3)*Power(qdot2,2) + 12*a1*a3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*q3*Power(qdot3,2) + 12*b1*b3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*q3*Power(qdot3,2) - 12*a1*a3*Power(q1,2)*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*q3*Power(qdot3,2) - 12*b1*b3*Power(q1,2)*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*q3*Power(qdot3,2) - 4*a1*a3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*Power(q3,3)*Power(qdot3,2) - 4*b1*b3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*Power(q3,3)*Power(qdot3,2) + 4*a1*a3*Power(q1,2)*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*Power(q3,3)*Power(qdot3,2) + 4*b1*b3*Power(q1,2)*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*Power(q3,3)*Power(qdot3,2) + 8*a1*a3*q1*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*(-1 + 3*Power(q3,2))*Power(qdot3,2) + 8*b1*b3*q1*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*(-1 + 3*Power(q3,2))*Power(qdot3,2) - 4*a3*b1*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*(1 - 3*Power(q3,2) - 2*q1*q3*(-3 + Power(q3,2)) + Power(q1,2)*(-1 + 3*Power(q3,2)))*Power(qdot3,2) + 4*a1*b3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*(1 - 3*Power(q3,2) - 2*q1*q3*(-3 + Power(q3,2)) + Power(q1,2)*(-1 + 3*Power(q3,2)))*Power(qdot3,2))))/((-2*(1 + Power(q3,2)) - 6*Power(q1,2)*(1 + Power(q3,2)) - 6*Power(q1,4)*(1 + Power(q3,2)) - 2*Power(q1,6)*(1 + Power(q3,2)) - 6*Power(q2,2)*(1 + Power(q3,2)) - 18*Power(q1,2)*Power(q2,2)*(1 + Power(q3,2)) - 18*Power(q1,4)*Power(q2,2)*(1 + Power(q3,2)) - 6*Power(q1,6)*Power(q2,2)*(1 + Power(q3,2)) - 6*Power(q2,4)*(1 + Power(q3,2)) - 18*Power(q1,2)*Power(q2,4)*(1 + Power(q3,2)) - 18*Power(q1,4)*Power(q2,4)*(1 + Power(q3,2)) - 6*Power(q1,6)*Power(q2,4)*(1 + Power(q3,2)) - 2*Power(q2,6)*(1 + Power(q3,2)) - 6*Power(q1,2)*Power(q2,6)*(1 + Power(q3,2)) - 6*Power(q1,4)*Power(q2,6)*(1 + Power(q3,2)) - 2*Power(q1,6)*Power(q2,6)*(1 + Power(q3,2)))*((-2*(1 + Power(q3,2)) - 6*Power(q1,2)*(1 + Power(q3,2)) - 6*Power(q1,4)*(1 + Power(q3,2)) - 2*Power(q1,6)*(1 + Power(q3,2)) - 6*Power(q2,2)*(1 + Power(q3,2)) - 18*Power(q1,2)*Power(q2,2)*(1 + Power(q3,2)) - 18*Power(q1,4)*Power(q2,2)*(1 + Power(q3,2)) - 6*Power(q1,6)*Power(q2,2)*(1 + Power(q3,2)) - 6*Power(q2,4)*(1 + Power(q3,2)) - 18*Power(q1,2)*Power(q2,4)*(1 + Power(q3,2)) - 18*Power(q1,4)*Power(q2,4)*(1 + Power(q3,2)) - 6*Power(q1,6)*Power(q2,4)*(1 + Power(q3,2)) - 2*Power(q2,6)*(1 + Power(q3,2)) - 6*Power(q1,2)*Power(q2,6)*(1 + Power(q3,2)) - 6*Power(q1,4)*Power(q2,6)*(1 + Power(q3,2)) - 2*Power(q1,6)*Power(q2,6)*(1 + Power(q3,2)))*(-4*a1*a2*(1 + Power(q1,2))*Power(1 + Power(q3,2),3) - 4*b1*b2*(1 + Power(q1,2))*Power(1 + Power(q3,2),3) + 4*a1*a2*Power(q1,2)*(1 + Power(q1,2))*Power(1 + Power(q3,2),3) + 4*b1*b2*Power(q1,2)*(1 + Power(q1,2))*Power(1 + Power(q3,2),3) + 4*a1*a2*(1 + Power(q1,2))*Power(q2,4)*Power(1 + Power(q3,2),3) + 4*b1*b2*(1 + Power(q1,2))*Power(q2,4)*Power(1 + Power(q3,2),3) - 4*a1*a2*Power(q1,2)*(1 + Power(q1,2))*Power(q2,4)*Power(1 + Power(q3,2),3) - 4*b1*b2*Power(q1,2)*(1 + Power(q1,2))*Power(q2,4)*Power(1 + Power(q3,2),3) - 16*a1*a2*q1*(1 + Power(q1,2))*q2*(1 + Power(q2,2))*Power(1 + Power(q3,2),3) - 16*b1*b2*q1*(1 + Power(q1,2))*q2*(1 + Power(q2,2))*Power(1 + Power(q3,2),3) - 8*a2*b1*(1 + Power(q1,2))*(1 + Power(q2,2))*(q2 - Power(q1,2)*q2 + q1*(-1 + Power(q2,2)))*Power(1 + Power(q3,2),3) + 8*a1*b2*(1 + Power(q1,2))*(1 + Power(q2,2))*(q2 - Power(q1,2)*q2 + q1*(-1 + Power(q2,2)))*Power(1 + Power(q3,2),3)) - (-2*a1*a3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3) - 2*b1*b3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3) + 2*a1*a3*Power(q1,2)*(1 + Power(q1,2))*Power(1 + Power(q2,2),3) + 2*b1*b3*Power(q1,2)*(1 + Power(q1,2))*Power(1 + Power(q2,2),3) + 2*a1*a3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*Power(q3,4) + 2*b1*b3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*Power(q3,4) - 2*a1*a3*Power(q1,2)*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*Power(q3,4) - 2*b1*b3*Power(q1,2)*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*Power(q3,4) - 8*a1*a3*q1*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*q3*(1 + Power(q3,2)) - 8*b1*b3*q1*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*q3*(1 + Power(q3,2)) - 4*a3*b1*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*(1 + Power(q3,2))*(q3 - Power(q1,2)*q3 + q1*(-1 + Power(q3,2))) + 4*a1*b3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*(1 + Power(q3,2))*(q3 - Power(q1,2)*q3 + q1*(-1 + Power(q3,2))))*(-2*a2*a3*Power(1 + Power(q1,2),3)*(1 + Power(q3,2)) - 2*b2*b3*Power(1 + Power(q1,2),3)*(1 + Power(q3,2)) - 8*a2*a3*Power(1 + Power(q1,2),3)*q2*q3*(1 + Power(q3,2)) - 8*b2*b3*Power(1 + Power(q1,2),3)*q2*q3*(1 + Power(q3,2)) - 8*a2*a3*Power(1 + Power(q1,2),3)*Power(q2,3)*q3*(1 + Power(q3,2)) - 8*b2*b3*Power(1 + Power(q1,2),3)*Power(q2,3)*q3*(1 + Power(q3,2)) + 2*a2*a3*Power(1 + Power(q1,2),3)*Power(q3,2)*(1 + Power(q3,2)) + 2*b2*b3*Power(1 + Power(q1,2),3)*Power(q3,2)*(1 + Power(q3,2)) - 2*a2*a3*Power(1 + Power(q1,2),3)*Power(q2,4)*(-1 + Power(q3,2))*(1 + Power(q3,2)) - 2*b2*b3*Power(1 + Power(q1,2),3)*Power(q2,4)*(-1 + Power(q3,2))*(1 + Power(q3,2)) + 4*a3*b2*Power(1 + Power(q1,2),3)*(1 + Power(q2,2))*(1 + Power(q3,2))*(-q3 + Power(q2,2)*q3 - q2*(-1 + Power(q3,2))) - 4*a2*b3*Power(1 + Power(q1,2),3)*(1 + Power(q2,2))*(1 + Power(q3,2))*(-q3 + Power(q2,2)*q3 - q2*(-1 + Power(q3,2)))))) + (((-2*a1*a3*Power(1 + Power(q2,2),3)*(1 + Power(q3,2)) - 2*b1*b3*Power(1 + Power(q2,2),3)*(1 + Power(q3,2)) - 8*a1*a3*q1*Power(1 + Power(q2,2),3)*q3*(1 + Power(q3,2)) - 8*b1*b3*q1*Power(1 + Power(q2,2),3)*q3*(1 + Power(q3,2)) - 8*a1*a3*Power(q1,3)*Power(1 + Power(q2,2),3)*q3*(1 + Power(q3,2)) - 8*b1*b3*Power(q1,3)*Power(1 + Power(q2,2),3)*q3*(1 + Power(q3,2)) + 2*a1*a3*Power(1 + Power(q2,2),3)*Power(q3,2)*(1 + Power(q3,2)) + 2*b1*b3*Power(1 + Power(q2,2),3)*Power(q3,2)*(1 + Power(q3,2)) - 2*a1*a3*Power(q1,4)*Power(1 + Power(q2,2),3)*(-1 + Power(q3,2))*(1 + Power(q3,2)) - 2*b1*b3*Power(q1,4)*Power(1 + Power(q2,2),3)*(-1 + Power(q3,2))*(1 + Power(q3,2)) + 4*a3*b1*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*(1 + Power(q3,2))*(-q3 + Power(q1,2)*q3 - q1*(-1 + Power(q3,2))) - 4*a1*b3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*(1 + Power(q3,2))*(-q3 + Power(q1,2)*q3 - q1*(-1 + Power(q3,2))))/(-2*(1 + Power(q3,2)) - 6*Power(q1,2)*(1 + Power(q3,2)) - 6*Power(q1,4)*(1 + Power(q3,2)) - 2*Power(q1,6)*(1 + Power(q3,2)) - 6*Power(q2,2)*(1 + Power(q3,2)) - 18*Power(q1,2)*Power(q2,2)*(1 + Power(q3,2)) - 18*Power(q1,4)*Power(q2,2)*(1 + Power(q3,2)) - 6*Power(q1,6)*Power(q2,2)*(1 + Power(q3,2)) - 6*Power(q2,4)*(1 + Power(q3,2)) - 18*Power(q1,2)*Power(q2,4)*(1 + Power(q3,2)) - 18*Power(q1,4)*Power(q2,4)*(1 + Power(q3,2)) - 6*Power(q1,6)*Power(q2,4)*(1 + Power(q3,2)) - 2*Power(q2,6)*(1 + Power(q3,2)) - 6*Power(q1,2)*Power(q2,6)*(1 + Power(q3,2)) - 6*Power(q1,4)*Power(q2,6)*(1 + Power(q3,2)) - 2*Power(q1,6)*Power(q2,6)*(1 + Power(q3,2))) - ((-2*a2*a3*Power(1 + Power(q1,2),3)*(1 + Power(q3,2)) - 2*b2*b3*Power(1 + Power(q1,2),3)*(1 + Power(q3,2)) - 8*a2*a3*Power(1 + Power(q1,2),3)*q2*q3*(1 + Power(q3,2)) - 8*b2*b3*Power(1 + Power(q1,2),3)*q2*q3*(1 + Power(q3,2)) - 8*a2*a3*Power(1 + Power(q1,2),3)*Power(q2,3)*q3*(1 + Power(q3,2)) - 8*b2*b3*Power(1 + Power(q1,2),3)*Power(q2,3)*q3*(1 + Power(q3,2)) + 2*a2*a3*Power(1 + Power(q1,2),3)*Power(q3,2)*(1 + Power(q3,2)) + 2*b2*b3*Power(1 + Power(q1,2),3)*Power(q3,2)*(1 + Power(q3,2)) - 2*a2*a3*Power(1 + Power(q1,2),3)*Power(q2,4)*(-1 + Power(q3,2))*(1 + Power(q3,2)) - 2*b2*b3*Power(1 + Power(q1,2),3)*Power(q2,4)*(-1 + Power(q3,2))*(1 + Power(q3,2)) + 4*a3*b2*Power(1 + Power(q1,2),3)*(1 + Power(q2,2))*(1 + Power(q3,2))*(-q3 + Power(q2,2)*q3 - q2*(-1 + Power(q3,2))) - 4*a2*b3*Power(1 + Power(q1,2),3)*(1 + Power(q2,2))*(1 + Power(q3,2))*(-q3 + Power(q2,2)*q3 - q2*(-1 + Power(q3,2))))*((-6*(1 + Power(q1,2)) - 18*(1 + Power(q1,2))*Power(q2,2) - 18*(1 + Power(q1,2))*Power(q2,4) - 6*(1 + Power(q1,2))*Power(q2,6) - 18*(1 + Power(q1,2))*Power(q3,2) - 54*(1 + Power(q1,2))*Power(q2,2)*Power(q3,2) - 54*(1 + Power(q1,2))*Power(q2,4)*Power(q3,2) - 18*(1 + Power(q1,2))*Power(q2,6)*Power(q3,2) - 18*(1 + Power(q1,2))*Power(q3,4) - 54*(1 + Power(q1,2))*Power(q2,2)*Power(q3,4) - 54*(1 + Power(q1,2))*Power(q2,4)*Power(q3,4) - 18*(1 + Power(q1,2))*Power(q2,6)*Power(q3,4) - 6*(1 + Power(q1,2))*Power(q3,6) - 18*(1 + Power(q1,2))*Power(q2,2)*Power(q3,6) - 18*(1 + Power(q1,2))*Power(q2,4)*Power(q3,6) - 6*(1 + Power(q1,2))*Power(q2,6)*Power(q3,6))*(-2*(1 + Power(q3,2)) - 6*Power(q1,2)*(1 + Power(q3,2)) - 6*Power(q1,4)*(1 + Power(q3,2)) - 2*Power(q1,6)*(1 + Power(q3,2)) - 6*Power(q2,2)*(1 + Power(q3,2)) - 18*Power(q1,2)*Power(q2,2)*(1 + Power(q3,2)) - 18*Power(q1,4)*Power(q2,2)*(1 + Power(q3,2)) - 6*Power(q1,6)*Power(q2,2)*(1 + Power(q3,2)) - 6*Power(q2,4)*(1 + Power(q3,2)) - 18*Power(q1,2)*Power(q2,4)*(1 + Power(q3,2)) - 18*Power(q1,4)*Power(q2,4)*(1 + Power(q3,2)) - 6*Power(q1,6)*Power(q2,4)*(1 + Power(q3,2)) - 2*Power(q2,6)*(1 + Power(q3,2)) - 6*Power(q1,2)*Power(q2,6)*(1 + Power(q3,2)) - 6*Power(q1,4)*Power(q2,6)*(1 + Power(q3,2)) - 2*Power(q1,6)*Power(q2,6)*(1 + Power(q3,2))) - (-2*a1*a3*Power(1 + Power(q2,2),3)*(1 + Power(q3,2)) - 2*b1*b3*Power(1 + Power(q2,2),3)*(1 + Power(q3,2)) - 8*a1*a3*q1*Power(1 + Power(q2,2),3)*q3*(1 + Power(q3,2)) - 8*b1*b3*q1*Power(1 + Power(q2,2),3)*q3*(1 + Power(q3,2)) - 8*a1*a3*Power(q1,3)*Power(1 + Power(q2,2),3)*q3*(1 + Power(q3,2)) - 8*b1*b3*Power(q1,3)*Power(1 + Power(q2,2),3)*q3*(1 + Power(q3,2)) + 2*a1*a3*Power(1 + Power(q2,2),3)*Power(q3,2)*(1 + Power(q3,2)) + 2*b1*b3*Power(1 + Power(q2,2),3)*Power(q3,2)*(1 + Power(q3,2)) - 2*a1*a3*Power(q1,4)*Power(1 + Power(q2,2),3)*(-1 + Power(q3,2))*(1 + Power(q3,2)) - 2*b1*b3*Power(q1,4)*Power(1 + Power(q2,2),3)*(-1 + Power(q3,2))*(1 + Power(q3,2)) + 4*a3*b1*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*(1 + Power(q3,2))*(-q3 + Power(q1,2)*q3 - q1*(-1 + Power(q3,2))) - 4*a1*b3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*(1 + Power(q3,2))*(-q3 + Power(q1,2)*q3 - q1*(-1 + Power(q3,2))))*(-2*a1*a3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3) - 2*b1*b3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3) + 2*a1*a3*Power(q1,2)*(1 + Power(q1,2))*Power(1 + Power(q2,2),3) + 2*b1*b3*Power(q1,2)*(1 + Power(q1,2))*Power(1 + Power(q2,2),3) + 2*a1*a3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*Power(q3,4) + 2*b1*b3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*Power(q3,4) - 2*a1*a3*Power(q1,2)*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*Power(q3,4) - 2*b1*b3*Power(q1,2)*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*Power(q3,4) - 8*a1*a3*q1*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*q3*(1 + Power(q3,2)) - 8*b1*b3*q1*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*q3*(1 + Power(q3,2)) - 4*a3*b1*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*(1 + Power(q3,2))*(q3 - Power(q1,2)*q3 + q1*(-1 + Power(q3,2))) + 4*a1*b3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*(1 + Power(q3,2))*(q3 - Power(q1,2)*q3 + q1*(-1 + Power(q3,2))))))/((-2*(1 + Power(q3,2)) - 6*Power(q1,2)*(1 + Power(q3,2)) - 6*Power(q1,4)*(1 + Power(q3,2)) - 2*Power(q1,6)*(1 + Power(q3,2)) - 6*Power(q2,2)*(1 + Power(q3,2)) - 18*Power(q1,2)*Power(q2,2)*(1 + Power(q3,2)) - 18*Power(q1,4)*Power(q2,2)*(1 + Power(q3,2)) - 6*Power(q1,6)*Power(q2,2)*(1 + Power(q3,2)) - 6*Power(q2,4)*(1 + Power(q3,2)) - 18*Power(q1,2)*Power(q2,4)*(1 + Power(q3,2)) - 18*Power(q1,4)*Power(q2,4)*(1 + Power(q3,2)) - 6*Power(q1,6)*Power(q2,4)*(1 + Power(q3,2)) - 2*Power(q2,6)*(1 + Power(q3,2)) - 6*Power(q1,2)*Power(q2,6)*(1 + Power(q3,2)) - 6*Power(q1,4)*Power(q2,6)*(1 + Power(q3,2)) - 2*Power(q1,6)*Power(q2,6)*(1 + Power(q3,2)))*((-2*(1 + Power(q3,2)) - 6*Power(q1,2)*(1 + Power(q3,2)) - 6*Power(q1,4)*(1 + Power(q3,2)) - 2*Power(q1,6)*(1 + Power(q3,2)) - 6*Power(q2,2)*(1 + Power(q3,2)) - 18*Power(q1,2)*Power(q2,2)*(1 + Power(q3,2)) - 18*Power(q1,4)*Power(q2,2)*(1 + Power(q3,2)) - 6*Power(q1,6)*Power(q2,2)*(1 + Power(q3,2)) - 6*Power(q2,4)*(1 + Power(q3,2)) - 18*Power(q1,2)*Power(q2,4)*(1 + Power(q3,2)) - 18*Power(q1,4)*Power(q2,4)*(1 + Power(q3,2)) - 6*Power(q1,6)*Power(q2,4)*(1 + Power(q3,2)) - 2*Power(q2,6)*(1 + Power(q3,2)) - 6*Power(q1,2)*Power(q2,6)*(1 + Power(q3,2)) - 6*Power(q1,4)*Power(q2,6)*(1 + Power(q3,2)) - 2*Power(q1,6)*Power(q2,6)*(1 + Power(q3,2)))*(-4*a1*a2*(1 + Power(q1,2))*Power(1 + Power(q3,2),3) - 4*b1*b2*(1 + Power(q1,2))*Power(1 + Power(q3,2),3) + 4*a1*a2*Power(q1,2)*(1 + Power(q1,2))*Power(1 + Power(q3,2),3) + 4*b1*b2*Power(q1,2)*(1 + Power(q1,2))*Power(1 + Power(q3,2),3) + 4*a1*a2*(1 + Power(q1,2))*Power(q2,4)*Power(1 + Power(q3,2),3) + 4*b1*b2*(1 + Power(q1,2))*Power(q2,4)*Power(1 + Power(q3,2),3) - 4*a1*a2*Power(q1,2)*(1 + Power(q1,2))*Power(q2,4)*Power(1 + Power(q3,2),3) - 4*b1*b2*Power(q1,2)*(1 + Power(q1,2))*Power(q2,4)*Power(1 + Power(q3,2),3) - 16*a1*a2*q1*(1 + Power(q1,2))*q2*(1 + Power(q2,2))*Power(1 + Power(q3,2),3) - 16*b1*b2*q1*(1 + Power(q1,2))*q2*(1 + Power(q2,2))*Power(1 + Power(q3,2),3) - 8*a2*b1*(1 + Power(q1,2))*(1 + Power(q2,2))*(q2 - Power(q1,2)*q2 + q1*(-1 + Power(q2,2)))*Power(1 + Power(q3,2),3) + 8*a1*b2*(1 + Power(q1,2))*(1 + Power(q2,2))*(q2 - Power(q1,2)*q2 + q1*(-1 + Power(q2,2)))*Power(1 + Power(q3,2),3)) - (-2*a1*a3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3) - 2*b1*b3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3) + 2*a1*a3*Power(q1,2)*(1 + Power(q1,2))*Power(1 + Power(q2,2),3) + 2*b1*b3*Power(q1,2)*(1 + Power(q1,2))*Power(1 + Power(q2,2),3) + 2*a1*a3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*Power(q3,4) + 2*b1*b3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*Power(q3,4) - 2*a1*a3*Power(q1,2)*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*Power(q3,4) - 2*b1*b3*Power(q1,2)*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*Power(q3,4) - 8*a1*a3*q1*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*q3*(1 + Power(q3,2)) - 8*b1*b3*q1*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*q3*(1 + Power(q3,2)) - 4*a3*b1*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*(1 + Power(q3,2))*(q3 - Power(q1,2)*q3 + q1*(-1 + Power(q3,2))) + 4*a1*b3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*(1 + Power(q3,2))*(q3 - Power(q1,2)*q3 + q1*(-1 + Power(q3,2))))*(-2*a2*a3*Power(1 + Power(q1,2),3)*(1 + Power(q3,2)) - 2*b2*b3*Power(1 + Power(q1,2),3)*(1 + Power(q3,2)) - 8*a2*a3*Power(1 + Power(q1,2),3)*q2*q3*(1 + Power(q3,2)) - 8*b2*b3*Power(1 + Power(q1,2),3)*q2*q3*(1 + Power(q3,2)) - 8*a2*a3*Power(1 + Power(q1,2),3)*Power(q2,3)*q3*(1 + Power(q3,2)) - 8*b2*b3*Power(1 + Power(q1,2),3)*Power(q2,3)*q3*(1 + Power(q3,2)) + 2*a2*a3*Power(1 + Power(q1,2),3)*Power(q3,2)*(1 + Power(q3,2)) + 2*b2*b3*Power(1 + Power(q1,2),3)*Power(q3,2)*(1 + Power(q3,2)) - 2*a2*a3*Power(1 + Power(q1,2),3)*Power(q2,4)*(-1 + Power(q3,2))*(1 + Power(q3,2)) - 2*b2*b3*Power(1 + Power(q1,2),3)*Power(q2,4)*(-1 + Power(q3,2))*(1 + Power(q3,2)) + 4*a3*b2*Power(1 + Power(q1,2),3)*(1 + Power(q2,2))*(1 + Power(q3,2))*(-q3 + Power(q2,2)*q3 - q2*(-1 + Power(q3,2))) - 4*a2*b3*Power(1 + Power(q1,2),3)*(1 + Power(q2,2))*(1 + Power(q3,2))*(-q3 + Power(q2,2)*q3 - q2*(-1 + Power(q3,2)))))))*(-(((-2*(1 + Power(q2,2)) - 6*Power(q1,2)*(1 + Power(q2,2)) - 6*Power(q1,4)*(1 + Power(q2,2)) - 2*Power(q1,6)*(1 + Power(q2,2)) - 6*(1 + Power(q2,2))*Power(q3,2) - 18*Power(q1,2)*(1 + Power(q2,2))*Power(q3,2) - 18*Power(q1,4)*(1 + Power(q2,2))*Power(q3,2) - 6*Power(q1,6)*(1 + Power(q2,2))*Power(q3,2) - 6*(1 + Power(q2,2))*Power(q3,4) - 18*Power(q1,2)*(1 + Power(q2,2))*Power(q3,4) - 18*Power(q1,4)*(1 + Power(q2,2))*Power(q3,4) - 6*Power(q1,6)*(1 + Power(q2,2))*Power(q3,4) - 2*(1 + Power(q2,2))*Power(q3,6) - 6*Power(q1,2)*(1 + Power(q2,2))*Power(q3,6) - 6*Power(q1,4)*(1 + Power(q2,2))*Power(q3,6) - 2*Power(q1,6)*(1 + Power(q2,2))*Power(q3,6))*(-2*(1 + Power(q3,2)) - 6*Power(q1,2)*(1 + Power(q3,2)) - 6*Power(q1,4)*(1 + Power(q3,2)) - 2*Power(q1,6)*(1 + Power(q3,2)) - 6*Power(q2,2)*(1 + Power(q3,2)) - 18*Power(q1,2)*Power(q2,2)*(1 + Power(q3,2)) - 18*Power(q1,4)*Power(q2,2)*(1 + Power(q3,2)) - 6*Power(q1,6)*Power(q2,2)*(1 + Power(q3,2)) - 6*Power(q2,4)*(1 + Power(q3,2)) - 18*Power(q1,2)*Power(q2,4)*(1 + Power(q3,2)) - 18*Power(q1,4)*Power(q2,4)*(1 + Power(q3,2)) - 6*Power(q1,6)*Power(q2,4)*(1 + Power(q3,2)) - 2*Power(q2,6)*(1 + Power(q3,2)) - 6*Power(q1,2)*Power(q2,6)*(1 + Power(q3,2)) - 6*Power(q1,4)*Power(q2,6)*(1 + Power(q3,2)) - 2*Power(q1,6)*Power(q2,6)*(1 + Power(q3,2))) - (-2*a2*a3*Power(1 + Power(q1,2),3)*(1 + Power(q3,2)) - 2*b2*b3*Power(1 + Power(q1,2),3)*(1 + Power(q3,2)) - 8*a2*a3*Power(1 + Power(q1,2),3)*q2*q3*(1 + Power(q3,2)) - 8*b2*b3*Power(1 + Power(q1,2),3)*q2*q3*(1 + Power(q3,2)) - 8*a2*a3*Power(1 + Power(q1,2),3)*Power(q2,3)*q3*(1 + Power(q3,2)) - 8*b2*b3*Power(1 + Power(q1,2),3)*Power(q2,3)*q3*(1 + Power(q3,2)) + 2*a2*a3*Power(1 + Power(q1,2),3)*Power(q3,2)*(1 + Power(q3,2)) + 2*b2*b3*Power(1 + Power(q1,2),3)*Power(q3,2)*(1 + Power(q3,2)) - 2*a2*a3*Power(1 + Power(q1,2),3)*Power(q2,4)*(-1 + Power(q3,2))*(1 + Power(q3,2)) - 2*b2*b3*Power(1 + Power(q1,2),3)*Power(q2,4)*(-1 + Power(q3,2))*(1 + Power(q3,2)) + 4*a3*b2*Power(1 + Power(q1,2),3)*(1 + Power(q2,2))*(1 + Power(q3,2))*(-q3 + Power(q2,2)*q3 - q2*(-1 + Power(q3,2))) - 4*a2*b3*Power(1 + Power(q1,2),3)*(1 + Power(q2,2))*(1 + Power(q3,2))*(-q3 + Power(q2,2)*q3 - q2*(-1 + Power(q3,2))))*(-(a2*a3*Power(1 + Power(q1,2),3)*(1 + Power(q2,2))) - b2*b3*Power(1 + Power(q1,2),3)*(1 + Power(q2,2)) + a2*a3*Power(1 + Power(q1,2),3)*Power(q2,2)*(1 + Power(q2,2)) + b2*b3*Power(1 + Power(q1,2),3)*Power(q2,2)*(1 + Power(q2,2)) + a2*a3*Power(1 + Power(q1,2),3)*(1 + Power(q2,2))*Power(q3,4) + b2*b3*Power(1 + Power(q1,2),3)*(1 + Power(q2,2))*Power(q3,4) - a2*a3*Power(1 + Power(q1,2),3)*Power(q2,2)*(1 + Power(q2,2))*Power(q3,4) - b2*b3*Power(1 + Power(q1,2),3)*Power(q2,2)*(1 + Power(q2,2))*Power(q3,4) - 4*a2*a3*Power(1 + Power(q1,2),3)*q2*(1 + Power(q2,2))*q3*(1 + Power(q3,2)) - 4*b2*b3*Power(1 + Power(q1,2),3)*q2*(1 + Power(q2,2))*q3*(1 + Power(q3,2)) - 2*a3*b2*Power(1 + Power(q1,2),3)*(1 + Power(q2,2))*(1 + Power(q3,2))*(q3 - Power(q2,2)*q3 + q2*(-1 + Power(q3,2))) + 2*a2*b3*Power(1 + Power(q1,2),3)*(1 + Power(q2,2))*(1 + Power(q3,2))*(q3 - Power(q2,2)*q3 + q2*(-1 + Power(q3,2)))))*(-((-2*a1*a3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3) - 2*b1*b3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3) + 2*a1*a3*Power(q1,2)*(1 + Power(q1,2))*Power(1 + Power(q2,2),3) + 2*b1*b3*Power(q1,2)*(1 + Power(q1,2))*Power(1 + Power(q2,2),3) + 2*a1*a3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*Power(q3,4) + 2*b1*b3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*Power(q3,4) - 2*a1*a3*Power(q1,2)*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*Power(q3,4) - 2*b1*b3*Power(q1,2)*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*Power(q3,4) - 8*a1*a3*q1*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*q3*(1 + Power(q3,2)) - 8*b1*b3*q1*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*q3*(1 + Power(q3,2)) - 4*a3*b1*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*(1 + Power(q3,2))*(q3 - Power(q1,2)*q3 + q1*(-1 + Power(q3,2))) + 4*a1*b3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*(1 + Power(q3,2))*(q3 - Power(q1,2)*q3 + q1*(-1 + Power(q3,2))))*(2*b3*Power(1 + Power(q1,2),3)*Power(1 + Power(q2,2),3)*q3*(1 + Power(q3,2)) + a3*Power(1 + Power(q1,2),3)*Power(1 + Power(q2,2),3)*(-1 + Power(q3,4)) - 8*a1*a3*Power(1 + Power(q2,2),3)*q3*(1 + Power(q3,2))*Power(qdot1,2) - 8*b1*b3*Power(1 + Power(q2,2),3)*q3*(1 + Power(q3,2))*Power(qdot1,2) + 24*a1*a3*Power(q1,2)*Power(1 + Power(q2,2),3)*q3*(1 + Power(q3,2))*Power(qdot1,2) + 24*b1*b3*Power(q1,2)*Power(1 + Power(q2,2),3)*q3*(1 + Power(q3,2))*Power(qdot1,2) - 12*a1*a3*q1*Power(1 + Power(q2,2),3)*(-1 + Power(q3,2))*(1 + Power(q3,2))*Power(qdot1,2) - 12*b1*b3*q1*Power(1 + Power(q2,2),3)*(-1 + Power(q3,2))*(1 + Power(q3,2))*Power(qdot1,2) + 4*a1*a3*Power(q1,3)*Power(1 + Power(q2,2),3)*(-1 + Power(q3,2))*(1 + Power(q3,2))*Power(qdot1,2) + 4*b1*b3*Power(q1,3)*Power(1 + Power(q2,2),3)*(-1 + Power(q3,2))*(1 + Power(q3,2))*Power(qdot1,2) - 4*a3*b1*Power(1 + Power(q2,2),3)*(1 + Power(q3,2))*(-1 - 6*q1*q3 + 2*Power(q1,3)*q3 + Power(q3,2) - 3*Power(q1,2)*(-1 + Power(q3,2)))*Power(qdot1,2) + 4*a1*b3*Power(1 + Power(q2,2),3)*(1 + Power(q3,2))*(-1 - 6*q1*q3 + 2*Power(q1,3)*q3 + Power(q3,2) - 3*Power(q1,2)*(-1 + Power(q3,2)))*Power(qdot1,2) - 8*a2*a3*Power(1 + Power(q1,2),3)*q3*(1 + Power(q3,2))*Power(qdot2,2) - 8*b2*b3*Power(1 + Power(q1,2),3)*q3*(1 + Power(q3,2))*Power(qdot2,2) + 24*a2*a3*Power(1 + Power(q1,2),3)*Power(q2,2)*q3*(1 + Power(q3,2))*Power(qdot2,2) + 24*b2*b3*Power(1 + Power(q1,2),3)*Power(q2,2)*q3*(1 + Power(q3,2))*Power(qdot2,2) - 12*a2*a3*Power(1 + Power(q1,2),3)*q2*(-1 + Power(q3,2))*(1 + Power(q3,2))*Power(qdot2,2) - 12*b2*b3*Power(1 + Power(q1,2),3)*q2*(-1 + Power(q3,2))*(1 + Power(q3,2))*Power(qdot2,2) + 4*a2*a3*Power(1 + Power(q1,2),3)*Power(q2,3)*(-1 + Power(q3,2))*(1 + Power(q3,2))*Power(qdot2,2) + 4*b2*b3*Power(1 + Power(q1,2),3)*Power(q2,3)*(-1 + Power(q3,2))*(1 + Power(q3,2))*Power(qdot2,2) - 4*a3*b2*Power(1 + Power(q1,2),3)*(1 + Power(q3,2))*(-1 - 6*q2*q3 + 2*Power(q2,3)*q3 + Power(q3,2) - 3*Power(q2,2)*(-1 + Power(q3,2)))*Power(qdot2,2) + 4*a2*b3*Power(1 + Power(q1,2),3)*(1 + Power(q3,2))*(-1 - 6*q2*q3 + 2*Power(q2,3)*q3 + Power(q3,2) - 3*Power(q2,2)*(-1 + Power(q3,2)))*Power(qdot2,2) + 4*q3*Power(qdot3,2) + 12*Power(q1,2)*q3*Power(qdot3,2) + 12*Power(q1,4)*q3*Power(qdot3,2) + 4*Power(q1,6)*q3*Power(qdot3,2) + 12*Power(q2,2)*q3*Power(qdot3,2) + 36*Power(q1,2)*Power(q2,2)*q3*Power(qdot3,2) + 36*Power(q1,4)*Power(q2,2)*q3*Power(qdot3,2) + 12*Power(q1,6)*Power(q2,2)*q3*Power(qdot3,2) + 12*Power(q2,4)*q3*Power(qdot3,2) + 36*Power(q1,2)*Power(q2,4)*q3*Power(qdot3,2) + 36*Power(q1,4)*Power(q2,4)*q3*Power(qdot3,2) + 12*Power(q1,6)*Power(q2,4)*q3*Power(qdot3,2) + 4*Power(q2,6)*q3*Power(qdot3,2) + 12*Power(q1,2)*Power(q2,6)*q3*Power(qdot3,2) + 12*Power(q1,4)*Power(q2,6)*q3*Power(qdot3,2) + 4*Power(q1,6)*Power(q2,6)*q3*Power(qdot3,2))) + (-2*(1 + Power(q3,2)) - 6*Power(q1,2)*(1 + Power(q3,2)) - 6*Power(q1,4)*(1 + Power(q3,2)) - 2*Power(q1,6)*(1 + Power(q3,2)) - 6*Power(q2,2)*(1 + Power(q3,2)) - 18*Power(q1,2)*Power(q2,2)*(1 + Power(q3,2)) - 18*Power(q1,4)*Power(q2,2)*(1 + Power(q3,2)) - 6*Power(q1,6)*Power(q2,2)*(1 + Power(q3,2)) - 6*Power(q2,4)*(1 + Power(q3,2)) - 18*Power(q1,2)*Power(q2,4)*(1 + Power(q3,2)) - 18*Power(q1,4)*Power(q2,4)*(1 + Power(q3,2)) - 6*Power(q1,6)*Power(q2,4)*(1 + Power(q3,2)) - 2*Power(q2,6)*(1 + Power(q3,2)) - 6*Power(q1,2)*Power(q2,6)*(1 + Power(q3,2)) - 6*Power(q1,4)*Power(q2,6)*(1 + Power(q3,2)) - 2*Power(q1,6)*Power(q2,6)*(1 + Power(q3,2)))*(6*b1*q1*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*Power(1 + Power(q3,2),3) + 3*a1*(-1 + Power(q1,4))*Power(1 + Power(q2,2),3)*Power(1 + Power(q3,2),3) + 12*q1*Power(qdot1,2) + 36*q1*Power(q2,2)*Power(qdot1,2) + 36*q1*Power(q2,4)*Power(qdot1,2) + 12*q1*Power(q2,6)*Power(qdot1,2) + 36*q1*Power(q3,2)*Power(qdot1,2) + 108*q1*Power(q2,2)*Power(q3,2)*Power(qdot1,2) + 108*q1*Power(q2,4)*Power(q3,2)*Power(qdot1,2) + 36*q1*Power(q2,6)*Power(q3,2)*Power(qdot1,2) + 36*q1*Power(q3,4)*Power(qdot1,2) + 108*q1*Power(q2,2)*Power(q3,4)*Power(qdot1,2) + 108*q1*Power(q2,4)*Power(q3,4)*Power(qdot1,2) + 36*q1*Power(q2,6)*Power(q3,4)*Power(qdot1,2) + 12*q1*Power(q3,6)*Power(qdot1,2) + 36*q1*Power(q2,2)*Power(q3,6)*Power(qdot1,2) + 36*q1*Power(q2,4)*Power(q3,6)*Power(qdot1,2) + 12*q1*Power(q2,6)*Power(q3,6)*Power(qdot1,2) + 24*a1*a2*(1 + Power(q1,2))*q2*Power(1 + Power(q3,2),3)*Power(qdot2,2) + 24*b1*b2*(1 + Power(q1,2))*q2*Power(1 + Power(q3,2),3)*Power(qdot2,2) - 24*a1*a2*Power(q1,2)*(1 + Power(q1,2))*q2*Power(1 + Power(q3,2),3)*Power(qdot2,2) - 24*b1*b2*Power(q1,2)*(1 + Power(q1,2))*q2*Power(1 + Power(q3,2),3)*Power(qdot2,2) - 8*a1*a2*(1 + Power(q1,2))*Power(q2,3)*Power(1 + Power(q3,2),3)*Power(qdot2,2) - 8*b1*b2*(1 + Power(q1,2))*Power(q2,3)*Power(1 + Power(q3,2),3)*Power(qdot2,2) + 8*a1*a2*Power(q1,2)*(1 + Power(q1,2))*Power(q2,3)*Power(1 + Power(q3,2),3)*Power(qdot2,2) + 8*b1*b2*Power(q1,2)*(1 + Power(q1,2))*Power(q2,3)*Power(1 + Power(q3,2),3)*Power(qdot2,2) + 16*a1*a2*q1*(1 + Power(q1,2))*(-1 + 3*Power(q2,2))*Power(1 + Power(q3,2),3)*Power(qdot2,2) + 16*b1*b2*q1*(1 + Power(q1,2))*(-1 + 3*Power(q2,2))*Power(1 + Power(q3,2),3)*Power(qdot2,2) - 8*a2*b1*(1 + Power(q1,2))*(1 - 3*Power(q2,2) - 2*q1*q2*(-3 + Power(q2,2)) + Power(q1,2)*(-1 + 3*Power(q2,2)))*Power(1 + Power(q3,2),3)*Power(qdot2,2) + 8*a1*b2*(1 + Power(q1,2))*(1 - 3*Power(q2,2) - 2*q1*q2*(-3 + Power(q2,2)) + Power(q1,2)*(-1 + 3*Power(q2,2)))*Power(1 + Power(q3,2),3)*Power(qdot2,2) + 12*a1*a3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*q3*Power(qdot3,2) + 12*b1*b3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*q3*Power(qdot3,2) - 12*a1*a3*Power(q1,2)*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*q3*Power(qdot3,2) - 12*b1*b3*Power(q1,2)*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*q3*Power(qdot3,2) - 4*a1*a3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*Power(q3,3)*Power(qdot3,2) - 4*b1*b3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*Power(q3,3)*Power(qdot3,2) + 4*a1*a3*Power(q1,2)*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*Power(q3,3)*Power(qdot3,2) + 4*b1*b3*Power(q1,2)*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*Power(q3,3)*Power(qdot3,2) + 8*a1*a3*q1*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*(-1 + 3*Power(q3,2))*Power(qdot3,2) + 8*b1*b3*q1*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*(-1 + 3*Power(q3,2))*Power(qdot3,2) - 4*a3*b1*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*(1 - 3*Power(q3,2) - 2*q1*q3*(-3 + Power(q3,2)) + Power(q1,2)*(-1 + 3*Power(q3,2)))*Power(qdot3,2) + 4*a1*b3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*(1 - 3*Power(q3,2) - 2*q1*q3*(-3 + Power(q3,2)) + Power(q1,2)*(-1 + 3*Power(q3,2)))*Power(qdot3,2)))) + ((-2*(1 + Power(q3,2)) - 6*Power(q1,2)*(1 + Power(q3,2)) - 6*Power(q1,4)*(1 + Power(q3,2)) - 2*Power(q1,6)*(1 + Power(q3,2)) - 6*Power(q2,2)*(1 + Power(q3,2)) - 18*Power(q1,2)*Power(q2,2)*(1 + Power(q3,2)) - 18*Power(q1,4)*Power(q2,2)*(1 + Power(q3,2)) - 6*Power(q1,6)*Power(q2,2)*(1 + Power(q3,2)) - 6*Power(q2,4)*(1 + Power(q3,2)) - 18*Power(q1,2)*Power(q2,4)*(1 + Power(q3,2)) - 18*Power(q1,4)*Power(q2,4)*(1 + Power(q3,2)) - 6*Power(q1,6)*Power(q2,4)*(1 + Power(q3,2)) - 2*Power(q2,6)*(1 + Power(q3,2)) - 6*Power(q1,2)*Power(q2,6)*(1 + Power(q3,2)) - 6*Power(q1,4)*Power(q2,6)*(1 + Power(q3,2)) - 2*Power(q1,6)*Power(q2,6)*(1 + Power(q3,2)))*(-4*a1*a2*(1 + Power(q1,2))*Power(1 + Power(q3,2),3) - 4*b1*b2*(1 + Power(q1,2))*Power(1 + Power(q3,2),3) + 4*a1*a2*Power(q1,2)*(1 + Power(q1,2))*Power(1 + Power(q3,2),3) + 4*b1*b2*Power(q1,2)*(1 + Power(q1,2))*Power(1 + Power(q3,2),3) + 4*a1*a2*(1 + Power(q1,2))*Power(q2,4)*Power(1 + Power(q3,2),3) + 4*b1*b2*(1 + Power(q1,2))*Power(q2,4)*Power(1 + Power(q3,2),3) - 4*a1*a2*Power(q1,2)*(1 + Power(q1,2))*Power(q2,4)*Power(1 + Power(q3,2),3) - 4*b1*b2*Power(q1,2)*(1 + Power(q1,2))*Power(q2,4)*Power(1 + Power(q3,2),3) - 16*a1*a2*q1*(1 + Power(q1,2))*q2*(1 + Power(q2,2))*Power(1 + Power(q3,2),3) - 16*b1*b2*q1*(1 + Power(q1,2))*q2*(1 + Power(q2,2))*Power(1 + Power(q3,2),3) - 8*a2*b1*(1 + Power(q1,2))*(1 + Power(q2,2))*(q2 - Power(q1,2)*q2 + q1*(-1 + Power(q2,2)))*Power(1 + Power(q3,2),3) + 8*a1*b2*(1 + Power(q1,2))*(1 + Power(q2,2))*(q2 - Power(q1,2)*q2 + q1*(-1 + Power(q2,2)))*Power(1 + Power(q3,2),3)) - (-2*a1*a3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3) - 2*b1*b3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3) + 2*a1*a3*Power(q1,2)*(1 + Power(q1,2))*Power(1 + Power(q2,2),3) + 2*b1*b3*Power(q1,2)*(1 + Power(q1,2))*Power(1 + Power(q2,2),3) + 2*a1*a3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*Power(q3,4) + 2*b1*b3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*Power(q3,4) - 2*a1*a3*Power(q1,2)*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*Power(q3,4) - 2*b1*b3*Power(q1,2)*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*Power(q3,4) - 8*a1*a3*q1*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*q3*(1 + Power(q3,2)) - 8*b1*b3*q1*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*q3*(1 + Power(q3,2)) - 4*a3*b1*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*(1 + Power(q3,2))*(q3 - Power(q1,2)*q3 + q1*(-1 + Power(q3,2))) + 4*a1*b3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*(1 + Power(q3,2))*(q3 - Power(q1,2)*q3 + q1*(-1 + Power(q3,2))))*(-2*a2*a3*Power(1 + Power(q1,2),3)*(1 + Power(q3,2)) - 2*b2*b3*Power(1 + Power(q1,2),3)*(1 + Power(q3,2)) - 8*a2*a3*Power(1 + Power(q1,2),3)*q2*q3*(1 + Power(q3,2)) - 8*b2*b3*Power(1 + Power(q1,2),3)*q2*q3*(1 + Power(q3,2)) - 8*a2*a3*Power(1 + Power(q1,2),3)*Power(q2,3)*q3*(1 + Power(q3,2)) - 8*b2*b3*Power(1 + Power(q1,2),3)*Power(q2,3)*q3*(1 + Power(q3,2)) + 2*a2*a3*Power(1 + Power(q1,2),3)*Power(q3,2)*(1 + Power(q3,2)) + 2*b2*b3*Power(1 + Power(q1,2),3)*Power(q3,2)*(1 + Power(q3,2)) - 2*a2*a3*Power(1 + Power(q1,2),3)*Power(q2,4)*(-1 + Power(q3,2))*(1 + Power(q3,2)) - 2*b2*b3*Power(1 + Power(q1,2),3)*Power(q2,4)*(-1 + Power(q3,2))*(1 + Power(q3,2)) + 4*a3*b2*Power(1 + Power(q1,2),3)*(1 + Power(q2,2))*(1 + Power(q3,2))*(-q3 + Power(q2,2)*q3 - q2*(-1 + Power(q3,2))) - 4*a2*b3*Power(1 + Power(q1,2),3)*(1 + Power(q2,2))*(1 + Power(q3,2))*(-q3 + Power(q2,2)*q3 - q2*(-1 + Power(q3,2)))))*(-((-(a2*a3*Power(1 + Power(q1,2),3)*(1 + Power(q2,2))) - b2*b3*Power(1 + Power(q1,2),3)*(1 + Power(q2,2)) + a2*a3*Power(1 + Power(q1,2),3)*Power(q2,2)*(1 + Power(q2,2)) + b2*b3*Power(1 + Power(q1,2),3)*Power(q2,2)*(1 + Power(q2,2)) + a2*a3*Power(1 + Power(q1,2),3)*(1 + Power(q2,2))*Power(q3,4) + b2*b3*Power(1 + Power(q1,2),3)*(1 + Power(q2,2))*Power(q3,4) - a2*a3*Power(1 + Power(q1,2),3)*Power(q2,2)*(1 + Power(q2,2))*Power(q3,4) - b2*b3*Power(1 + Power(q1,2),3)*Power(q2,2)*(1 + Power(q2,2))*Power(q3,4) - 4*a2*a3*Power(1 + Power(q1,2),3)*q2*(1 + Power(q2,2))*q3*(1 + Power(q3,2)) - 4*b2*b3*Power(1 + Power(q1,2),3)*q2*(1 + Power(q2,2))*q3*(1 + Power(q3,2)) - 2*a3*b2*Power(1 + Power(q1,2),3)*(1 + Power(q2,2))*(1 + Power(q3,2))*(q3 - Power(q2,2)*q3 + q2*(-1 + Power(q3,2))) + 2*a2*b3*Power(1 + Power(q1,2),3)*(1 + Power(q2,2))*(1 + Power(q3,2))*(q3 - Power(q2,2)*q3 + q2*(-1 + Power(q3,2))))*(2*b3*Power(1 + Power(q1,2),3)*Power(1 + Power(q2,2),3)*q3*(1 + Power(q3,2)) + a3*Power(1 + Power(q1,2),3)*Power(1 + Power(q2,2),3)*(-1 + Power(q3,4)) - 8*a1*a3*Power(1 + Power(q2,2),3)*q3*(1 + Power(q3,2))*Power(qdot1,2) - 8*b1*b3*Power(1 + Power(q2,2),3)*q3*(1 + Power(q3,2))*Power(qdot1,2) + 24*a1*a3*Power(q1,2)*Power(1 + Power(q2,2),3)*q3*(1 + Power(q3,2))*Power(qdot1,2) + 24*b1*b3*Power(q1,2)*Power(1 + Power(q2,2),3)*q3*(1 + Power(q3,2))*Power(qdot1,2) - 12*a1*a3*q1*Power(1 + Power(q2,2),3)*(-1 + Power(q3,2))*(1 + Power(q3,2))*Power(qdot1,2) - 12*b1*b3*q1*Power(1 + Power(q2,2),3)*(-1 + Power(q3,2))*(1 + Power(q3,2))*Power(qdot1,2) + 4*a1*a3*Power(q1,3)*Power(1 + Power(q2,2),3)*(-1 + Power(q3,2))*(1 + Power(q3,2))*Power(qdot1,2) + 4*b1*b3*Power(q1,3)*Power(1 + Power(q2,2),3)*(-1 + Power(q3,2))*(1 + Power(q3,2))*Power(qdot1,2) - 4*a3*b1*Power(1 + Power(q2,2),3)*(1 + Power(q3,2))*(-1 - 6*q1*q3 + 2*Power(q1,3)*q3 + Power(q3,2) - 3*Power(q1,2)*(-1 + Power(q3,2)))*Power(qdot1,2) + 4*a1*b3*Power(1 + Power(q2,2),3)*(1 + Power(q3,2))*(-1 - 6*q1*q3 + 2*Power(q1,3)*q3 + Power(q3,2) - 3*Power(q1,2)*(-1 + Power(q3,2)))*Power(qdot1,2) - 8*a2*a3*Power(1 + Power(q1,2),3)*q3*(1 + Power(q3,2))*Power(qdot2,2) - 8*b2*b3*Power(1 + Power(q1,2),3)*q3*(1 + Power(q3,2))*Power(qdot2,2) + 24*a2*a3*Power(1 + Power(q1,2),3)*Power(q2,2)*q3*(1 + Power(q3,2))*Power(qdot2,2) + 24*b2*b3*Power(1 + Power(q1,2),3)*Power(q2,2)*q3*(1 + Power(q3,2))*Power(qdot2,2) - 12*a2*a3*Power(1 + Power(q1,2),3)*q2*(-1 + Power(q3,2))*(1 + Power(q3,2))*Power(qdot2,2) - 12*b2*b3*Power(1 + Power(q1,2),3)*q2*(-1 + Power(q3,2))*(1 + Power(q3,2))*Power(qdot2,2) + 4*a2*a3*Power(1 + Power(q1,2),3)*Power(q2,3)*(-1 + Power(q3,2))*(1 + Power(q3,2))*Power(qdot2,2) + 4*b2*b3*Power(1 + Power(q1,2),3)*Power(q2,3)*(-1 + Power(q3,2))*(1 + Power(q3,2))*Power(qdot2,2) - 4*a3*b2*Power(1 + Power(q1,2),3)*(1 + Power(q3,2))*(-1 - 6*q2*q3 + 2*Power(q2,3)*q3 + Power(q3,2) - 3*Power(q2,2)*(-1 + Power(q3,2)))*Power(qdot2,2) + 4*a2*b3*Power(1 + Power(q1,2),3)*(1 + Power(q3,2))*(-1 - 6*q2*q3 + 2*Power(q2,3)*q3 + Power(q3,2) - 3*Power(q2,2)*(-1 + Power(q3,2)))*Power(qdot2,2) + 4*q3*Power(qdot3,2) + 12*Power(q1,2)*q3*Power(qdot3,2) + 12*Power(q1,4)*q3*Power(qdot3,2) + 4*Power(q1,6)*q3*Power(qdot3,2) + 12*Power(q2,2)*q3*Power(qdot3,2) + 36*Power(q1,2)*Power(q2,2)*q3*Power(qdot3,2) + 36*Power(q1,4)*Power(q2,2)*q3*Power(qdot3,2) + 12*Power(q1,6)*Power(q2,2)*q3*Power(qdot3,2) + 12*Power(q2,4)*q3*Power(qdot3,2) + 36*Power(q1,2)*Power(q2,4)*q3*Power(qdot3,2) + 36*Power(q1,4)*Power(q2,4)*q3*Power(qdot3,2) + 12*Power(q1,6)*Power(q2,4)*q3*Power(qdot3,2) + 4*Power(q2,6)*q3*Power(qdot3,2) + 12*Power(q1,2)*Power(q2,6)*q3*Power(qdot3,2) + 12*Power(q1,4)*Power(q2,6)*q3*Power(qdot3,2) + 4*Power(q1,6)*Power(q2,6)*q3*Power(qdot3,2))) + (-2*(1 + Power(q3,2)) - 6*Power(q1,2)*(1 + Power(q3,2)) - 6*Power(q1,4)*(1 + Power(q3,2)) - 2*Power(q1,6)*(1 + Power(q3,2)) - 6*Power(q2,2)*(1 + Power(q3,2)) - 18*Power(q1,2)*Power(q2,2)*(1 + Power(q3,2)) - 18*Power(q1,4)*Power(q2,2)*(1 + Power(q3,2)) - 6*Power(q1,6)*Power(q2,2)*(1 + Power(q3,2)) - 6*Power(q2,4)*(1 + Power(q3,2)) - 18*Power(q1,2)*Power(q2,4)*(1 + Power(q3,2)) - 18*Power(q1,4)*Power(q2,4)*(1 + Power(q3,2)) - 6*Power(q1,6)*Power(q2,4)*(1 + Power(q3,2)) - 2*Power(q2,6)*(1 + Power(q3,2)) - 6*Power(q1,2)*Power(q2,6)*(1 + Power(q3,2)) - 6*Power(q1,4)*Power(q2,6)*(1 + Power(q3,2)) - 2*Power(q1,6)*Power(q2,6)*(1 + Power(q3,2)))*(2*b2*Power(1 + Power(q1,2),3)*q2*(1 + Power(q2,2))*Power(1 + Power(q3,2),3) + a2*Power(1 + Power(q1,2),3)*(-1 + Power(q2,4))*Power(1 + Power(q3,2),3) - 8*a1*a2*q2*(1 + Power(q2,2))*Power(1 + Power(q3,2),3)*Power(qdot1,2) - 8*b1*b2*q2*(1 + Power(q2,2))*Power(1 + Power(q3,2),3)*Power(qdot1,2) + 24*a1*a2*Power(q1,2)*q2*(1 + Power(q2,2))*Power(1 + Power(q3,2),3)*Power(qdot1,2) + 24*b1*b2*Power(q1,2)*q2*(1 + Power(q2,2))*Power(1 + Power(q3,2),3)*Power(qdot1,2) - 12*a1*a2*q1*(-1 + Power(q2,2))*(1 + Power(q2,2))*Power(1 + Power(q3,2),3)*Power(qdot1,2) - 12*b1*b2*q1*(-1 + Power(q2,2))*(1 + Power(q2,2))*Power(1 + Power(q3,2),3)*Power(qdot1,2) + 4*a1*a2*Power(q1,3)*(-1 + Power(q2,2))*(1 + Power(q2,2))*Power(1 + Power(q3,2),3)*Power(qdot1,2) + 4*b1*b2*Power(q1,3)*(-1 + Power(q2,2))*(1 + Power(q2,2))*Power(1 + Power(q3,2),3)*Power(qdot1,2) - 4*a2*b1*(1 + Power(q2,2))*(-1 - 6*q1*q2 + 2*Power(q1,3)*q2 + Power(q2,2) - 3*Power(q1,2)*(-1 + Power(q2,2)))*Power(1 + Power(q3,2),3)*Power(qdot1,2) + 4*a1*b2*(1 + Power(q2,2))*(-1 - 6*q1*q2 + 2*Power(q1,3)*q2 + Power(q2,2) - 3*Power(q1,2)*(-1 + Power(q2,2)))*Power(1 + Power(q3,2),3)*Power(qdot1,2) + 4*q2*Power(qdot2,2) + 12*Power(q1,2)*q2*Power(qdot2,2) + 12*Power(q1,4)*q2*Power(qdot2,2) + 4*Power(q1,6)*q2*Power(qdot2,2) + 12*q2*Power(q3,2)*Power(qdot2,2) + 36*Power(q1,2)*q2*Power(q3,2)*Power(qdot2,2) + 36*Power(q1,4)*q2*Power(q3,2)*Power(qdot2,2) + 12*Power(q1,6)*q2*Power(q3,2)*Power(qdot2,2) + 12*q2*Power(q3,4)*Power(qdot2,2) + 36*Power(q1,2)*q2*Power(q3,4)*Power(qdot2,2) + 36*Power(q1,4)*q2*Power(q3,4)*Power(qdot2,2) + 12*Power(q1,6)*q2*Power(q3,4)*Power(qdot2,2) + 4*q2*Power(q3,6)*Power(qdot2,2) + 12*Power(q1,2)*q2*Power(q3,6)*Power(qdot2,2) + 12*Power(q1,4)*q2*Power(q3,6)*Power(qdot2,2) + 4*Power(q1,6)*q2*Power(q3,6)*Power(qdot2,2) + 6*a2*a3*Power(1 + Power(q1,2),3)*(1 + Power(q2,2))*q3*Power(qdot3,2) + 6*b2*b3*Power(1 + Power(q1,2),3)*(1 + Power(q2,2))*q3*Power(qdot3,2) - 6*a2*a3*Power(1 + Power(q1,2),3)*Power(q2,2)*(1 + Power(q2,2))*q3*Power(qdot3,2) - 6*b2*b3*Power(1 + Power(q1,2),3)*Power(q2,2)*(1 + Power(q2,2))*q3*Power(qdot3,2) - 2*a2*a3*Power(1 + Power(q1,2),3)*(1 + Power(q2,2))*Power(q3,3)*Power(qdot3,2) - 2*b2*b3*Power(1 + Power(q1,2),3)*(1 + Power(q2,2))*Power(q3,3)*Power(qdot3,2) + 2*a2*a3*Power(1 + Power(q1,2),3)*Power(q2,2)*(1 + Power(q2,2))*Power(q3,3)*Power(qdot3,2) + 2*b2*b3*Power(1 + Power(q1,2),3)*Power(q2,2)*(1 + Power(q2,2))*Power(q3,3)*Power(qdot3,2) + 4*a2*a3*Power(1 + Power(q1,2),3)*q2*(1 + Power(q2,2))*(-1 + 3*Power(q3,2))*Power(qdot3,2) + 4*b2*b3*Power(1 + Power(q1,2),3)*q2*(1 + Power(q2,2))*(-1 + 3*Power(q3,2))*Power(qdot3,2) - 2*a3*b2*Power(1 + Power(q1,2),3)*(1 + Power(q2,2))*(1 - 3*Power(q3,2) - 2*q2*q3*(-3 + Power(q3,2)) + Power(q2,2)*(-1 + 3*Power(q3,2)))*Power(qdot3,2) + 2*a2*b3*Power(1 + Power(q1,2),3)*(1 + Power(q2,2))*(1 - 3*Power(q3,2) - 2*q2*q3*(-3 + Power(q3,2)) + Power(q2,2)*(-1 + 3*Power(q3,2)))*Power(qdot3,2)))))/(((-2*(1 + Power(q3,2)) - 6*Power(q1,2)*(1 + Power(q3,2)) - 6*Power(q1,4)*(1 + Power(q3,2)) - 2*Power(q1,6)*(1 + Power(q3,2)) - 6*Power(q2,2)*(1 + Power(q3,2)) - 18*Power(q1,2)*Power(q2,2)*(1 + Power(q3,2)) - 18*Power(q1,4)*Power(q2,2)*(1 + Power(q3,2)) - 6*Power(q1,6)*Power(q2,2)*(1 + Power(q3,2)) - 6*Power(q2,4)*(1 + Power(q3,2)) - 18*Power(q1,2)*Power(q2,4)*(1 + Power(q3,2)) - 18*Power(q1,4)*Power(q2,4)*(1 + Power(q3,2)) - 6*Power(q1,6)*Power(q2,4)*(1 + Power(q3,2)) - 2*Power(q2,6)*(1 + Power(q3,2)) - 6*Power(q1,2)*Power(q2,6)*(1 + Power(q3,2)) - 6*Power(q1,4)*Power(q2,6)*(1 + Power(q3,2)) - 2*Power(q1,6)*Power(q2,6)*(1 + Power(q3,2)))*(-4*a1*a2*(1 + Power(q1,2))*Power(1 + Power(q3,2),3) - 4*b1*b2*(1 + Power(q1,2))*Power(1 + Power(q3,2),3) + 4*a1*a2*Power(q1,2)*(1 + Power(q1,2))*Power(1 + Power(q3,2),3) + 4*b1*b2*Power(q1,2)*(1 + Power(q1,2))*Power(1 + Power(q3,2),3) + 4*a1*a2*(1 + Power(q1,2))*Power(q2,4)*Power(1 + Power(q3,2),3) + 4*b1*b2*(1 + Power(q1,2))*Power(q2,4)*Power(1 + Power(q3,2),3) - 4*a1*a2*Power(q1,2)*(1 + Power(q1,2))*Power(q2,4)*Power(1 + Power(q3,2),3) - 4*b1*b2*Power(q1,2)*(1 + Power(q1,2))*Power(q2,4)*Power(1 + Power(q3,2),3) - 16*a1*a2*q1*(1 + Power(q1,2))*q2*(1 + Power(q2,2))*Power(1 + Power(q3,2),3) - 16*b1*b2*q1*(1 + Power(q1,2))*q2*(1 + Power(q2,2))*Power(1 + Power(q3,2),3) - 8*a2*b1*(1 + Power(q1,2))*(1 + Power(q2,2))*(q2 - Power(q1,2)*q2 + q1*(-1 + Power(q2,2)))*Power(1 + Power(q3,2),3) + 8*a1*b2*(1 + Power(q1,2))*(1 + Power(q2,2))*(q2 - Power(q1,2)*q2 + q1*(-1 + Power(q2,2)))*Power(1 + Power(q3,2),3)) - (-2*a1*a3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3) - 2*b1*b3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3) + 2*a1*a3*Power(q1,2)*(1 + Power(q1,2))*Power(1 + Power(q2,2),3) + 2*b1*b3*Power(q1,2)*(1 + Power(q1,2))*Power(1 + Power(q2,2),3) + 2*a1*a3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*Power(q3,4) + 2*b1*b3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*Power(q3,4) - 2*a1*a3*Power(q1,2)*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*Power(q3,4) - 2*b1*b3*Power(q1,2)*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*Power(q3,4) - 8*a1*a3*q1*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*q3*(1 + Power(q3,2)) - 8*b1*b3*q1*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*q3*(1 + Power(q3,2)) - 4*a3*b1*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*(1 + Power(q3,2))*(q3 - Power(q1,2)*q3 + q1*(-1 + Power(q3,2))) + 4*a1*b3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*(1 + Power(q3,2))*(q3 - Power(q1,2)*q3 + q1*(-1 + Power(q3,2))))*(-2*a2*a3*Power(1 + Power(q1,2),3)*(1 + Power(q3,2)) - 2*b2*b3*Power(1 + Power(q1,2),3)*(1 + Power(q3,2)) - 8*a2*a3*Power(1 + Power(q1,2),3)*q2*q3*(1 + Power(q3,2)) - 8*b2*b3*Power(1 + Power(q1,2),3)*q2*q3*(1 + Power(q3,2)) - 8*a2*a3*Power(1 + Power(q1,2),3)*Power(q2,3)*q3*(1 + Power(q3,2)) - 8*b2*b3*Power(1 + Power(q1,2),3)*Power(q2,3)*q3*(1 + Power(q3,2)) + 2*a2*a3*Power(1 + Power(q1,2),3)*Power(q3,2)*(1 + Power(q3,2)) + 2*b2*b3*Power(1 + Power(q1,2),3)*Power(q3,2)*(1 + Power(q3,2)) - 2*a2*a3*Power(1 + Power(q1,2),3)*Power(q2,4)*(-1 + Power(q3,2))*(1 + Power(q3,2)) - 2*b2*b3*Power(1 + Power(q1,2),3)*Power(q2,4)*(-1 + Power(q3,2))*(1 + Power(q3,2)) + 4*a3*b2*Power(1 + Power(q1,2),3)*(1 + Power(q2,2))*(1 + Power(q3,2))*(-q3 + Power(q2,2)*q3 - q2*(-1 + Power(q3,2))) - 4*a2*b3*Power(1 + Power(q1,2),3)*(1 + Power(q2,2))*(1 + Power(q3,2))*(-q3 + Power(q2,2)*q3 - q2*(-1 + Power(q3,2)))))*((-2*(1 + Power(q3,2)) - 6*Power(q1,2)*(1 + Power(q3,2)) - 6*Power(q1,4)*(1 + Power(q3,2)) - 2*Power(q1,6)*(1 + Power(q3,2)) - 6*Power(q2,2)*(1 + Power(q3,2)) - 18*Power(q1,2)*Power(q2,2)*(1 + Power(q3,2)) - 18*Power(q1,4)*Power(q2,2)*(1 + Power(q3,2)) - 6*Power(q1,6)*Power(q2,2)*(1 + Power(q3,2)) - 6*Power(q2,4)*(1 + Power(q3,2)) - 18*Power(q1,2)*Power(q2,4)*(1 + Power(q3,2)) - 18*Power(q1,4)*Power(q2,4)*(1 + Power(q3,2)) - 6*Power(q1,6)*Power(q2,4)*(1 + Power(q3,2)) - 2*Power(q2,6)*(1 + Power(q3,2)) - 6*Power(q1,2)*Power(q2,6)*(1 + Power(q3,2)) - 6*Power(q1,4)*Power(q2,6)*(1 + Power(q3,2)) - 2*Power(q1,6)*Power(q2,6)*(1 + Power(q3,2)))*(-2*a1*a2*(1 + Power(q2,2))*Power(1 + Power(q3,2),3) - 2*b1*b2*(1 + Power(q2,2))*Power(1 + Power(q3,2),3) - 8*a1*a2*q1*q2*(1 + Power(q2,2))*Power(1 + Power(q3,2),3) - 8*b1*b2*q1*q2*(1 + Power(q2,2))*Power(1 + Power(q3,2),3) - 8*a1*a2*Power(q1,3)*q2*(1 + Power(q2,2))*Power(1 + Power(q3,2),3) - 8*b1*b2*Power(q1,3)*q2*(1 + Power(q2,2))*Power(1 + Power(q3,2),3) + 2*a1*a2*Power(q2,2)*(1 + Power(q2,2))*Power(1 + Power(q3,2),3) + 2*b1*b2*Power(q2,2)*(1 + Power(q2,2))*Power(1 + Power(q3,2),3) - 2*a1*a2*Power(q1,4)*(-1 + Power(q2,2))*(1 + Power(q2,2))*Power(1 + Power(q3,2),3) - 2*b1*b2*Power(q1,4)*(-1 + Power(q2,2))*(1 + Power(q2,2))*Power(1 + Power(q3,2),3) + 4*a2*b1*(1 + Power(q1,2))*(1 + Power(q2,2))*(-q2 + Power(q1,2)*q2 - q1*(-1 + Power(q2,2)))*Power(1 + Power(q3,2),3) - 4*a1*b2*(1 + Power(q1,2))*(1 + Power(q2,2))*(-q2 + Power(q1,2)*q2 - q1*(-1 + Power(q2,2)))*Power(1 + Power(q3,2),3)) - (-2*a1*a3*Power(1 + Power(q2,2),3)*(1 + Power(q3,2)) - 2*b1*b3*Power(1 + Power(q2,2),3)*(1 + Power(q3,2)) - 8*a1*a3*q1*Power(1 + Power(q2,2),3)*q3*(1 + Power(q3,2)) - 8*b1*b3*q1*Power(1 + Power(q2,2),3)*q3*(1 + Power(q3,2)) - 8*a1*a3*Power(q1,3)*Power(1 + Power(q2,2),3)*q3*(1 + Power(q3,2)) - 8*b1*b3*Power(q1,3)*Power(1 + Power(q2,2),3)*q3*(1 + Power(q3,2)) + 2*a1*a3*Power(1 + Power(q2,2),3)*Power(q3,2)*(1 + Power(q3,2)) + 2*b1*b3*Power(1 + Power(q2,2),3)*Power(q3,2)*(1 + Power(q3,2)) - 2*a1*a3*Power(q1,4)*Power(1 + Power(q2,2),3)*(-1 + Power(q3,2))*(1 + Power(q3,2)) - 2*b1*b3*Power(q1,4)*Power(1 + Power(q2,2),3)*(-1 + Power(q3,2))*(1 + Power(q3,2)) + 4*a3*b1*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*(1 + Power(q3,2))*(-q3 + Power(q1,2)*q3 - q1*(-1 + Power(q3,2))) - 4*a1*b3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*(1 + Power(q3,2))*(-q3 + Power(q1,2)*q3 - q1*(-1 + Power(q3,2))))*(-(a2*a3*Power(1 + Power(q1,2),3)*(1 + Power(q2,2))) - b2*b3*Power(1 + Power(q1,2),3)*(1 + Power(q2,2)) + a2*a3*Power(1 + Power(q1,2),3)*Power(q2,2)*(1 + Power(q2,2)) + b2*b3*Power(1 + Power(q1,2),3)*Power(q2,2)*(1 + Power(q2,2)) + a2*a3*Power(1 + Power(q1,2),3)*(1 + Power(q2,2))*Power(q3,4) + b2*b3*Power(1 + Power(q1,2),3)*(1 + Power(q2,2))*Power(q3,4) - a2*a3*Power(1 + Power(q1,2),3)*Power(q2,2)*(1 + Power(q2,2))*Power(q3,4) - b2*b3*Power(1 + Power(q1,2),3)*Power(q2,2)*(1 + Power(q2,2))*Power(q3,4) - 4*a2*a3*Power(1 + Power(q1,2),3)*q2*(1 + Power(q2,2))*q3*(1 + Power(q3,2)) - 4*b2*b3*Power(1 + Power(q1,2),3)*q2*(1 + Power(q2,2))*q3*(1 + Power(q3,2)) - 2*a3*b2*Power(1 + Power(q1,2),3)*(1 + Power(q2,2))*(1 + Power(q3,2))*(q3 - Power(q2,2)*q3 + q2*(-1 + Power(q3,2))) + 2*a2*b3*Power(1 + Power(q1,2),3)*(1 + Power(q2,2))*(1 + Power(q3,2))*(q3 - Power(q2,2)*q3 + q2*(-1 + Power(q3,2))))) - ((-6*(1 + Power(q1,2)) - 18*(1 + Power(q1,2))*Power(q2,2) - 18*(1 + Power(q1,2))*Power(q2,4) - 6*(1 + Power(q1,2))*Power(q2,6) - 18*(1 + Power(q1,2))*Power(q3,2) - 54*(1 + Power(q1,2))*Power(q2,2)*Power(q3,2) - 54*(1 + Power(q1,2))*Power(q2,4)*Power(q3,2) - 18*(1 + Power(q1,2))*Power(q2,6)*Power(q3,2) - 18*(1 + Power(q1,2))*Power(q3,4) - 54*(1 + Power(q1,2))*Power(q2,2)*Power(q3,4) - 54*(1 + Power(q1,2))*Power(q2,4)*Power(q3,4) - 18*(1 + Power(q1,2))*Power(q2,6)*Power(q3,4) - 6*(1 + Power(q1,2))*Power(q3,6) - 18*(1 + Power(q1,2))*Power(q2,2)*Power(q3,6) - 18*(1 + Power(q1,2))*Power(q2,4)*Power(q3,6) - 6*(1 + Power(q1,2))*Power(q2,6)*Power(q3,6))*(-2*(1 + Power(q3,2)) - 6*Power(q1,2)*(1 + Power(q3,2)) - 6*Power(q1,4)*(1 + Power(q3,2)) - 2*Power(q1,6)*(1 + Power(q3,2)) - 6*Power(q2,2)*(1 + Power(q3,2)) - 18*Power(q1,2)*Power(q2,2)*(1 + Power(q3,2)) - 18*Power(q1,4)*Power(q2,2)*(1 + Power(q3,2)) - 6*Power(q1,6)*Power(q2,2)*(1 + Power(q3,2)) - 6*Power(q2,4)*(1 + Power(q3,2)) - 18*Power(q1,2)*Power(q2,4)*(1 + Power(q3,2)) - 18*Power(q1,4)*Power(q2,4)*(1 + Power(q3,2)) - 6*Power(q1,6)*Power(q2,4)*(1 + Power(q3,2)) - 2*Power(q2,6)*(1 + Power(q3,2)) - 6*Power(q1,2)*Power(q2,6)*(1 + Power(q3,2)) - 6*Power(q1,4)*Power(q2,6)*(1 + Power(q3,2)) - 2*Power(q1,6)*Power(q2,6)*(1 + Power(q3,2))) - (-2*a1*a3*Power(1 + Power(q2,2),3)*(1 + Power(q3,2)) - 2*b1*b3*Power(1 + Power(q2,2),3)*(1 + Power(q3,2)) - 8*a1*a3*q1*Power(1 + Power(q2,2),3)*q3*(1 + Power(q3,2)) - 8*b1*b3*q1*Power(1 + Power(q2,2),3)*q3*(1 + Power(q3,2)) - 8*a1*a3*Power(q1,3)*Power(1 + Power(q2,2),3)*q3*(1 + Power(q3,2)) - 8*b1*b3*Power(q1,3)*Power(1 + Power(q2,2),3)*q3*(1 + Power(q3,2)) + 2*a1*a3*Power(1 + Power(q2,2),3)*Power(q3,2)*(1 + Power(q3,2)) + 2*b1*b3*Power(1 + Power(q2,2),3)*Power(q3,2)*(1 + Power(q3,2)) - 2*a1*a3*Power(q1,4)*Power(1 + Power(q2,2),3)*(-1 + Power(q3,2))*(1 + Power(q3,2)) - 2*b1*b3*Power(q1,4)*Power(1 + Power(q2,2),3)*(-1 + Power(q3,2))*(1 + Power(q3,2)) + 4*a3*b1*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*(1 + Power(q3,2))*(-q3 + Power(q1,2)*q3 - q1*(-1 + Power(q3,2))) - 4*a1*b3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*(1 + Power(q3,2))*(-q3 + Power(q1,2)*q3 - q1*(-1 + Power(q3,2))))*(-2*a1*a3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3) - 2*b1*b3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3) + 2*a1*a3*Power(q1,2)*(1 + Power(q1,2))*Power(1 + Power(q2,2),3) + 2*b1*b3*Power(q1,2)*(1 + Power(q1,2))*Power(1 + Power(q2,2),3) + 2*a1*a3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*Power(q3,4) + 2*b1*b3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*Power(q3,4) - 2*a1*a3*Power(q1,2)*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*Power(q3,4) - 2*b1*b3*Power(q1,2)*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*Power(q3,4) - 8*a1*a3*q1*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*q3*(1 + Power(q3,2)) - 8*b1*b3*q1*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*q3*(1 + Power(q3,2)) - 4*a3*b1*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*(1 + Power(q3,2))*(q3 - Power(q1,2)*q3 + q1*(-1 + Power(q3,2))) + 4*a1*b3*(1 + Power(q1,2))*Power(1 + Power(q2,2),3)*(1 + Power(q3,2))*(q3 - Power(q1,2)*q3 + q1*(-1 + Power(q3,2)))))*((-2*(1 + Power(q2,2)) - 6*Power(q1,2)*(1 + Power(q2,2)) - 6*Power(q1,4)*(1 + Power(q2,2)) - 2*Power(q1,6)*(1 + Power(q2,2)) - 6*(1 + Power(q2,2))*Power(q3,2) - 18*Power(q1,2)*(1 + Power(q2,2))*Power(q3,2) - 18*Power(q1,4)*(1 + Power(q2,2))*Power(q3,2) - 6*Power(q1,6)*(1 + Power(q2,2))*Power(q3,2) - 6*(1 + Power(q2,2))*Power(q3,4) - 18*Power(q1,2)*(1 + Power(q2,2))*Power(q3,4) - 18*Power(q1,4)*(1 + Power(q2,2))*Power(q3,4) - 6*Power(q1,6)*(1 + Power(q2,2))*Power(q3,4) - 2*(1 + Power(q2,2))*Power(q3,6) - 6*Power(q1,2)*(1 + Power(q2,2))*Power(q3,6) - 6*Power(q1,4)*(1 + Power(q2,2))*Power(q3,6) - 2*Power(q1,6)*(1 + Power(q2,2))*Power(q3,6))*(-2*(1 + Power(q3,2)) - 6*Power(q1,2)*(1 + Power(q3,2)) - 6*Power(q1,4)*(1 + Power(q3,2)) - 2*Power(q1,6)*(1 + Power(q3,2)) - 6*Power(q2,2)*(1 + Power(q3,2)) - 18*Power(q1,2)*Power(q2,2)*(1 + Power(q3,2)) - 18*Power(q1,4)*Power(q2,2)*(1 + Power(q3,2)) - 6*Power(q1,6)*Power(q2,2)*(1 + Power(q3,2)) - 6*Power(q2,4)*(1 + Power(q3,2)) - 18*Power(q1,2)*Power(q2,4)*(1 + Power(q3,2)) - 18*Power(q1,4)*Power(q2,4)*(1 + Power(q3,2)) - 6*Power(q1,6)*Power(q2,4)*(1 + Power(q3,2)) - 2*Power(q2,6)*(1 + Power(q3,2)) - 6*Power(q1,2)*Power(q2,6)*(1 + Power(q3,2)) - 6*Power(q1,4)*Power(q2,6)*(1 + Power(q3,2)) - 2*Power(q1,6)*Power(q2,6)*(1 + Power(q3,2))) - (-2*a2*a3*Power(1 + Power(q1,2),3)*(1 + Power(q3,2)) - 2*b2*b3*Power(1 + Power(q1,2),3)*(1 + Power(q3,2)) - 8*a2*a3*Power(1 + Power(q1,2),3)*q2*q3*(1 + Power(q3,2)) - 8*b2*b3*Power(1 + Power(q1,2),3)*q2*q3*(1 + Power(q3,2)) - 8*a2*a3*Power(1 + Power(q1,2),3)*Power(q2,3)*q3*(1 + Power(q3,2)) - 8*b2*b3*Power(1 + Power(q1,2),3)*Power(q2,3)*q3*(1 + Power(q3,2)) + 2*a2*a3*Power(1 + Power(q1,2),3)*Power(q3,2)*(1 + Power(q3,2)) + 2*b2*b3*Power(1 + Power(q1,2),3)*Power(q3,2)*(1 + Power(q3,2)) - 2*a2*a3*Power(1 + Power(q1,2),3)*Power(q2,4)*(-1 + Power(q3,2))*(1 + Power(q3,2)) - 2*b2*b3*Power(1 + Power(q1,2),3)*Power(q2,4)*(-1 + Power(q3,2))*(1 + Power(q3,2)) + 4*a3*b2*Power(1 + Power(q1,2),3)*(1 + Power(q2,2))*(1 + Power(q3,2))*(-q3 + Power(q2,2)*q3 - q2*(-1 + Power(q3,2))) - 4*a2*b3*Power(1 + Power(q1,2),3)*(1 + Power(q2,2))*(1 + Power(q3,2))*(-q3 + Power(q2,2)*q3 - q2*(-1 + Power(q3,2))))*(-(a2*a3*Power(1 + Power(q1,2),3)*(1 + Power(q2,2))) - b2*b3*Power(1 + Power(q1,2),3)*(1 + Power(q2,2)) + a2*a3*Power(1 + Power(q1,2),3)*Power(q2,2)*(1 + Power(q2,2)) + b2*b3*Power(1 + Power(q1,2),3)*Power(q2,2)*(1 + Power(q2,2)) + a2*a3*Power(1 + Power(q1,2),3)*(1 + Power(q2,2))*Power(q3,4) + b2*b3*Power(1 + Power(q1,2),3)*(1 + Power(q2,2))*Power(q3,4) - a2*a3*Power(1 + Power(q1,2),3)*Power(q2,2)*(1 + Power(q2,2))*Power(q3,4) - b2*b3*Power(1 + Power(q1,2),3)*Power(q2,2)*(1 + Power(q2,2))*Power(q3,4) - 4*a2*a3*Power(1 + Power(q1,2),3)*q2*(1 + Power(q2,2))*q3*(1 + Power(q3,2)) - 4*b2*b3*Power(1 + Power(q1,2),3)*q2*(1 + Power(q2,2))*q3*(1 + Power(q3,2)) - 2*a3*b2*Power(1 + Power(q1,2),3)*(1 + Power(q2,2))*(1 + Power(q3,2))*(q3 - Power(q2,2)*q3 + q2*(-1 + Power(q3,2))) + 2*a2*b3*Power(1 + Power(q1,2),3)*(1 + Power(q2,2))*(1 + Power(q3,2))*(q3 - Power(q2,2)*q3 + q2*(-1 + Power(q3,2)))))))
}

var canvas  = document.getElementById("triple-pendulum");
var context = canvas.getContext("2d");

function draw(...balls) {
  let x = context,
      s = (canvas.width + canvas.height)/2/(2*balls.length),
      r = .1;

  x.save();
  x.clearRect(0, 0, canvas.width, canvas.height);
  x.translate(canvas.width/2, canvas.height/2);
  x.fillRect(0,0,r,r);
  x.scale(s,-s);
  
  x.beginPath();
  x.lineWidth = 2/s;
  x.moveTo(0,0);
  for (let ball of balls)
    x.lineTo(...ball);
  x.stroke();
  
  x.fillRect(-r,-r,2*r,2*r);

  for (let ball of balls) {
    x.beginPath();
    x.arc(...ball,r,0,2*355/113);
    x.fill();
  }

  x.restore();
}

{

  const N = 3;
  let config = [1,0,1,0,1,0],
	   x = [0,0,0,0,0,0],
	   m = M(...config)(...x.slice(0,N));

  function differences(arr) {
    return arr.slice(1).map(
      (value, index) => [value[0]-arr[index][0], value[1]-arr[index][1]]
    );
  }

  function recenter() {
    for (let i = 0; i<N; i++) {
      if (Math.abs(x[i]) > 10) {
	m = M(...config)(...x.slice(0,N));
	let d = differences([[0,0],...m]);
	x[i+N] = x[i+N]/(1+x[i]**2);
	x[i] = 0;
	config.splice(2*i,2,...d[i]);
	m = M(...config)(...x.slice(0,N));
      }
    }
  }

  draw(...m);
  (
  function animate(then) {
     let now = Date.now()/1000,
       dt = now - then,
       dx = rk4(dt, x, ddot(...config));
     for (let i of x.keys()) {
       x[i]+=dx[i];
     }
     m = M(...config)(...x.slice(0,N));
     draw(...m);
     if (x.slice(0,3).some($ => Math.abs($) > 10)) {
       recenter();
     }
     window.requestAnimationFrame(() => animate(now));
   })(Date.now()/1000);

}
    </script>
  </body>

</html>
